{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar acyclic_1 = __importDefault(require(\"./acyclic\"));\nvar normalize_1 = __importDefault(require(\"./normalize\"));\nvar rank_1 = __importDefault(require(\"./rank\"));\nvar util_1 = require(\"./util\");\nvar parent_dummy_chains_1 = __importDefault(require(\"./parent-dummy-chains\"));\nvar nesting_graph_1 = __importDefault(require(\"./nesting-graph\"));\nvar add_border_segments_1 = __importDefault(require(\"./add-border-segments\"));\nvar coordinate_system_1 = __importDefault(require(\"./coordinate-system\"));\nvar order_1 = __importDefault(require(\"./order\"));\nvar position_1 = __importDefault(require(\"./position\"));\nvar init_data_order_1 = __importDefault(require(\"./order/init-data-order\"));\nvar graph_1 = require(\"../graph\");\nvar layout = function (g, opts) {\n  var time = opts && opts.debugTiming ? util_1.time : util_1.notime;\n  time(\"layout\", function () {\n    // 如果在原图基础上修改，继承原图的order结果\n    if (opts && !opts.keepNodeOrder && opts.prevGraph) {\n      time(\"  inheritOrder\", function () {\n        inheritOrder(g, opts.prevGraph);\n      });\n    }\n    var layoutGraph = time(\"  buildLayoutGraph\", function () {\n      return buildLayoutGraph(g);\n    });\n    // 控制是否为边的label留位置（这会影响是否在边中间添加dummy node）\n    if (!(opts && opts.edgeLabelSpace === false)) {\n      time(\"  makeSpaceForEdgeLabels\", function () {\n        makeSpaceForEdgeLabels(layoutGraph);\n      });\n    }\n    // TODO: 暂时处理层级设置不正确时的异常报错，提示设置正确的层级\n    try {\n      time(\"  runLayout\", function () {\n        runLayout(layoutGraph, time, opts);\n      });\n    } catch (e) {\n      if (e.message === \"Not possible to find intersection inside of the rectangle\") {\n        console.error(\"The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\\n\", e);\n        return;\n      }\n      throw e;\n    }\n    time(\"  updateInputGraph\", function () {\n      updateInputGraph(g, layoutGraph);\n    });\n  });\n};\nvar runLayout = function (g, time, opts) {\n  time(\"    removeSelfEdges\", function () {\n    removeSelfEdges(g);\n  });\n  time(\"    acyclic\", function () {\n    acyclic_1.default.run(g);\n  });\n  time(\"    nestingGraph.run\", function () {\n    nesting_graph_1.default.run(g);\n  });\n  time(\"    rank\", function () {\n    (0, rank_1.default)((0, util_1.asNonCompoundGraph)(g));\n  });\n  time(\"    injectEdgeLabelProxies\", function () {\n    injectEdgeLabelProxies(g);\n  });\n  time(\"    removeEmptyRanks\", function () {\n    (0, util_1.removeEmptyRanks)(g);\n  });\n  time(\"    nestingGraph.cleanup\", function () {\n    nesting_graph_1.default.cleanup(g);\n  });\n  time(\"    normalizeRanks\", function () {\n    (0, util_1.normalizeRanks)(g);\n  });\n  time(\"    assignRankMinMax\", function () {\n    assignRankMinMax(g);\n  });\n  time(\"    removeEdgeLabelProxies\", function () {\n    removeEdgeLabelProxies(g);\n  });\n  time(\"    normalize.run\", function () {\n    normalize_1.default.run(g);\n  });\n  time(\"    parentDummyChains\", function () {\n    (0, parent_dummy_chains_1.default)(g);\n  });\n  time(\"    addBorderSegments\", function () {\n    (0, add_border_segments_1.default)(g);\n  });\n  if (opts && opts.keepNodeOrder) {\n    time(\"    initDataOrder\", function () {\n      (0, init_data_order_1.default)(g, opts.nodeOrder);\n    });\n  }\n  time(\"    order\", function () {\n    (0, order_1.default)(g, opts === null || opts === void 0 ? void 0 : opts.keepNodeOrder);\n  });\n  time(\"    insertSelfEdges\", function () {\n    insertSelfEdges(g);\n  });\n  time(\"    adjustCoordinateSystem\", function () {\n    coordinate_system_1.default.adjust(g);\n  });\n  time(\"    position\", function () {\n    (0, position_1.default)(g);\n  });\n  time(\"    positionSelfEdges\", function () {\n    positionSelfEdges(g);\n  });\n  time(\"    removeBorderNodes\", function () {\n    removeBorderNodes(g);\n  });\n  time(\"    normalize.undo\", function () {\n    normalize_1.default.undo(g);\n  });\n  time(\"    fixupEdgeLabelCoords\", function () {\n    fixupEdgeLabelCoords(g);\n  });\n  time(\"    undoCoordinateSystem\", function () {\n    coordinate_system_1.default.undo(g);\n  });\n  time(\"    translateGraph\", function () {\n    translateGraph(g);\n  });\n  time(\"    assignNodeIntersects\", function () {\n    assignNodeIntersects(g);\n  });\n  time(\"    reversePoints\", function () {\n    reversePointsForReversedEdges(g);\n  });\n  time(\"    acyclic.undo\", function () {\n    acyclic_1.default.undo(g);\n  });\n};\n/**\n * 继承上一个布局中的order，防止翻转\n * TODO: 暂时没有考虑涉及层级变动的布局，只保证原来布局层级和相对顺序不变\n */\nvar inheritOrder = function (currG, prevG) {\n  currG.nodes().forEach(function (n) {\n    var node = currG.node(n);\n    var prevNode = prevG.node(n);\n    if (prevNode !== undefined) {\n      node.fixorder = prevNode._order;\n      delete prevNode._order;\n    } else {\n      delete node.fixorder;\n    }\n  });\n};\n/*\n * Copies final layout information from the layout graph back to the input\n * graph. This process only copies whitelisted attributes from the layout graph\n * to the input graph, so it serves as a good place to determine what\n * attributes can influence layout.\n */\nvar updateInputGraph = function (inputGraph, layoutGraph) {\n  inputGraph.nodes().forEach(function (v) {\n    var _a;\n    var inputLabel = inputGraph.node(v);\n    if (inputLabel) {\n      var layoutLabel = layoutGraph.node(v);\n      inputLabel.x = layoutLabel.x;\n      inputLabel.y = layoutLabel.y;\n      inputLabel._order = layoutLabel.order;\n      inputLabel._rank = layoutLabel.rank;\n      if ((_a = layoutGraph.children(v)) === null || _a === void 0 ? void 0 : _a.length) {\n        inputLabel.width = layoutLabel.width;\n        inputLabel.height = layoutLabel.height;\n      }\n    }\n  });\n  inputGraph.edges().forEach(function (e) {\n    var inputLabel = inputGraph.edge(e);\n    var layoutLabel = layoutGraph.edge(e);\n    inputLabel.points = layoutLabel ? layoutLabel.points : [];\n    if (layoutLabel && layoutLabel.hasOwnProperty(\"x\")) {\n      inputLabel.x = layoutLabel.x;\n      inputLabel.y = layoutLabel.y;\n    }\n  });\n  inputGraph.graph().width = layoutGraph.graph().width;\n  inputGraph.graph().height = layoutGraph.graph().height;\n};\nvar graphNumAttrs = [\"nodesep\", \"edgesep\", \"ranksep\", \"marginx\", \"marginy\"];\nvar graphDefaults = {\n  ranksep: 50,\n  edgesep: 20,\n  nodesep: 50,\n  rankdir: \"tb\"\n};\nvar graphAttrs = [\"acyclicer\", \"ranker\", \"rankdir\", \"align\"];\nvar nodeNumAttrs = [\"width\", \"height\", \"layer\", \"fixorder\"]; // 需要传入layer, fixOrder作为参数参考\nvar nodeDefaults = {\n  width: 0,\n  height: 0\n};\nvar edgeNumAttrs = [\"minlen\", \"weight\", \"width\", \"height\", \"labeloffset\"];\nvar edgeDefaults = {\n  minlen: 1,\n  weight: 1,\n  width: 0,\n  height: 0,\n  labeloffset: 10,\n  labelpos: \"r\"\n};\nvar edgeAttrs = [\"labelpos\"];\n/*\n * Constructs a new graph from the input graph, which can be used for layout.\n * This process copies only whitelisted attributes from the input graph to the\n * layout graph. Thus this function serves as a good place to determine what\n * attributes can influence layout.\n */\nvar buildLayoutGraph = function (inputGraph) {\n  var g = new graph_1.Graph({\n    multigraph: true,\n    compound: true\n  });\n  var graph = canonicalize(inputGraph.graph());\n  var pickedProperties = {};\n  graphAttrs === null || graphAttrs === void 0 ? void 0 : graphAttrs.forEach(function (key) {\n    if (graph[key] !== undefined) pickedProperties[key] = graph[key];\n  });\n  g.setGraph(Object.assign({}, graphDefaults, selectNumberAttrs(graph, graphNumAttrs), pickedProperties));\n  inputGraph.nodes().forEach(function (v) {\n    var node = canonicalize(inputGraph.node(v));\n    var defaultNode = __assign(__assign({}, nodeDefaults), node);\n    var defaultAttrs = selectNumberAttrs(defaultNode, nodeNumAttrs);\n    g.setNode(v, defaultAttrs);\n    g.setParent(v, inputGraph.parent(v));\n  });\n  inputGraph.edges().forEach(function (e) {\n    var edge = canonicalize(inputGraph.edge(e));\n    var pickedProperties = {};\n    edgeAttrs === null || edgeAttrs === void 0 ? void 0 : edgeAttrs.forEach(function (key) {\n      if (edge[key] !== undefined) pickedProperties[key] = edge[key];\n    });\n    g.setEdgeObj(e, Object.assign({}, edgeDefaults, selectNumberAttrs(edge, edgeNumAttrs), pickedProperties));\n  });\n  return g;\n};\n/*\n * This idea comes from the Gansner paper: to account for edge labels in our\n * layout we split each rank in half by doubling minlen and halving ranksep.\n * Then we can place labels at these mid-points between nodes.\n *\n * We also add some minimal padding to the width to push the label for the edge\n * away from the edge itself a bit.\n */\nvar makeSpaceForEdgeLabels = function (g) {\n  var graph = g.graph();\n  if (!graph.ranksep) graph.ranksep = 0;\n  graph.ranksep /= 2;\n  g.nodes().forEach(function (n) {\n    var node = g.node(n);\n    if (!isNaN(node.layer)) {\n      if (!node.layer) node.layer = 0;\n    }\n  });\n  g.edges().forEach(function (e) {\n    var _a;\n    var edge = g.edge(e);\n    edge.minlen *= 2;\n    if (((_a = edge.labelpos) === null || _a === void 0 ? void 0 : _a.toLowerCase()) !== \"c\") {\n      if (graph.rankdir === \"TB\" || graph.rankdir === \"BT\") {\n        edge.width += edge.labeloffset;\n      } else {\n        edge.height += edge.labeloffset;\n      }\n    }\n  });\n};\n/*\n * Creates temporary dummy nodes that capture the rank in which each edge's\n * label is going to, if it has one of non-zero width and height. We do this\n * so that we can safely remove empty ranks while preserving balance for the\n * label's position.\n */\nvar injectEdgeLabelProxies = function (g) {\n  g.edges().forEach(function (e) {\n    var edge = g.edge(e);\n    if (edge.width && edge.height) {\n      var v = g.node(e.v);\n      var w = g.node(e.w);\n      var label = {\n        e: e,\n        rank: (w.rank - v.rank) / 2 + v.rank\n      };\n      (0, util_1.addDummyNode)(g, \"edge-proxy\", label, \"_ep\");\n    }\n  });\n};\nvar assignRankMinMax = function (g) {\n  var maxRank = 0;\n  g.nodes().forEach(function (v) {\n    var _a, _b;\n    var node = g.node(v);\n    if (node.borderTop) {\n      node.minRank = (_a = g.node(node.borderTop)) === null || _a === void 0 ? void 0 : _a.rank;\n      node.maxRank = (_b = g.node(node.borderBottom)) === null || _b === void 0 ? void 0 : _b.rank;\n      maxRank = Math.max(maxRank, node.maxRank || -Infinity);\n    }\n  });\n  g.graph().maxRank = maxRank;\n};\nvar removeEdgeLabelProxies = function (g) {\n  g.nodes().forEach(function (v) {\n    var node = g.node(v);\n    if (node.dummy === \"edge-proxy\") {\n      g.edge(node.e).labelRank = node.rank;\n      g.removeNode(v);\n    }\n  });\n};\nvar translateGraph = function (g) {\n  var minX;\n  var maxX = 0;\n  var minY;\n  var maxY = 0;\n  var graphLabel = g.graph();\n  var marginX = graphLabel.marginx || 0;\n  var marginY = graphLabel.marginy || 0;\n  var getExtremes = function (attrs) {\n    if (!attrs) return;\n    var x = attrs.x;\n    var y = attrs.y;\n    var w = attrs.width;\n    var h = attrs.height;\n    if (!isNaN(x) && !isNaN(w)) {\n      if (minX === undefined) {\n        minX = x - w / 2;\n      }\n      minX = Math.min(minX, x - w / 2);\n      maxX = Math.max(maxX, x + w / 2);\n    }\n    if (!isNaN(y) && !isNaN(h)) {\n      if (minY === undefined) {\n        minY = y - h / 2;\n      }\n      minY = Math.min(minY, y - h / 2);\n      maxY = Math.max(maxY, y + h / 2);\n    }\n  };\n  g.nodes().forEach(function (v) {\n    getExtremes(g.node(v));\n  });\n  g.edges().forEach(function (e) {\n    var edge = g.edge(e);\n    if (edge === null || edge === void 0 ? void 0 : edge.hasOwnProperty(\"x\")) {\n      getExtremes(edge);\n    }\n  });\n  minX -= marginX;\n  minY -= marginY;\n  g.nodes().forEach(function (v) {\n    var node = g.node(v);\n    if (node) {\n      node.x -= minX;\n      node.y -= minY;\n    }\n  });\n  g.edges().forEach(function (e) {\n    var _a;\n    var edge = g.edge(e);\n    (_a = edge.points) === null || _a === void 0 ? void 0 : _a.forEach(function (p) {\n      p.x -= minX;\n      p.y -= minY;\n    });\n    if (edge.hasOwnProperty(\"x\")) {\n      edge.x -= minX;\n    }\n    if (edge.hasOwnProperty(\"y\")) {\n      edge.y -= minY;\n    }\n  });\n  graphLabel.width = maxX - minX + marginX;\n  graphLabel.height = maxY - minY + marginY;\n};\nvar assignNodeIntersects = function (g) {\n  g.edges().forEach(function (e) {\n    var edge = g.edge(e);\n    var nodeV = g.node(e.v);\n    var nodeW = g.node(e.w);\n    var p1;\n    var p2;\n    if (!edge.points) {\n      edge.points = [];\n      p1 = nodeW;\n      p2 = nodeV;\n    } else {\n      p1 = edge.points[0];\n      p2 = edge.points[edge.points.length - 1];\n    }\n    edge.points.unshift((0, util_1.intersectRect)(nodeV, p1));\n    edge.points.push((0, util_1.intersectRect)(nodeW, p2));\n  });\n};\nvar fixupEdgeLabelCoords = function (g) {\n  g.edges().forEach(function (e) {\n    var edge = g.edge(e);\n    if (edge === null || edge === void 0 ? void 0 : edge.hasOwnProperty(\"x\")) {\n      if (edge.labelpos === \"l\" || edge.labelpos === \"r\") {\n        edge.width -= edge.labeloffset;\n      }\n      switch (edge.labelpos) {\n        case \"l\":\n          edge.x -= edge.width / 2 + edge.labeloffset;\n          break;\n        case \"r\":\n          edge.x += edge.width / 2 + edge.labeloffset;\n          break;\n      }\n    }\n  });\n};\nvar reversePointsForReversedEdges = function (g) {\n  g.edges().forEach(function (e) {\n    var _a;\n    var edge = g.edge(e);\n    if (edge.reversed) {\n      (_a = edge.points) === null || _a === void 0 ? void 0 : _a.reverse();\n    }\n  });\n};\nvar removeBorderNodes = function (g) {\n  g.nodes().forEach(function (v) {\n    var _a, _b, _c;\n    if ((_a = g.children(v)) === null || _a === void 0 ? void 0 : _a.length) {\n      var node = g.node(v);\n      var t = g.node(node.borderTop);\n      var b = g.node(node.borderBottom);\n      var l = g.node(node.borderLeft[((_b = node.borderLeft) === null || _b === void 0 ? void 0 : _b.length) - 1]);\n      var r = g.node(node.borderRight[((_c = node.borderRight) === null || _c === void 0 ? void 0 : _c.length) - 1]);\n      node.width = Math.abs((r === null || r === void 0 ? void 0 : r.x) - (l === null || l === void 0 ? void 0 : l.x)) || 10;\n      node.height = Math.abs((b === null || b === void 0 ? void 0 : b.y) - (t === null || t === void 0 ? void 0 : t.y)) || 10;\n      node.x = ((l === null || l === void 0 ? void 0 : l.x) || 0) + node.width / 2;\n      node.y = ((t === null || t === void 0 ? void 0 : t.y) || 0) + node.height / 2;\n    }\n  });\n  g.nodes().forEach(function (v) {\n    var _a;\n    if (((_a = g.node(v)) === null || _a === void 0 ? void 0 : _a.dummy) === \"border\") {\n      g.removeNode(v);\n    }\n  });\n};\nvar removeSelfEdges = function (g) {\n  g.edges().forEach(function (e) {\n    if (e.v === e.w) {\n      var node = g.node(e.v);\n      if (!node.selfEdges) {\n        node.selfEdges = [];\n      }\n      node.selfEdges.push({\n        e: e,\n        label: g.edge(e)\n      });\n      g.removeEdgeObj(e);\n    }\n  });\n};\nvar insertSelfEdges = function (g) {\n  var layers = (0, util_1.buildLayerMatrix)(g);\n  layers === null || layers === void 0 ? void 0 : layers.forEach(function (layer) {\n    var orderShift = 0;\n    layer === null || layer === void 0 ? void 0 : layer.forEach(function (v, i) {\n      var _a;\n      var node = g.node(v);\n      node.order = i + orderShift;\n      (_a = node.selfEdges) === null || _a === void 0 ? void 0 : _a.forEach(function (selfEdge) {\n        (0, util_1.addDummyNode)(g, \"selfedge\", {\n          width: selfEdge.label.width,\n          height: selfEdge.label.height,\n          rank: node.rank,\n          order: i + ++orderShift,\n          e: selfEdge.e,\n          label: selfEdge.label\n        }, \"_se\");\n      });\n      delete node.selfEdges;\n    });\n  });\n};\nvar positionSelfEdges = function (g) {\n  g.nodes().forEach(function (v) {\n    var node = g.node(v);\n    if (node.dummy === \"selfedge\") {\n      var selfNode = g.node(node.e.v);\n      var x = selfNode.x + selfNode.width / 2;\n      var y = selfNode.y;\n      var dx = node.x - x;\n      var dy = selfNode.height / 2;\n      g.setEdgeObj(node.e, node.label);\n      g.removeNode(v);\n      node.label.points = [{\n        x: x + 2 * dx / 3,\n        y: y - dy\n      }, {\n        x: x + 5 * dx / 6,\n        y: y - dy\n      }, {\n        y: y,\n        x: x + dx\n      }, {\n        x: x + 5 * dx / 6,\n        y: y + dy\n      }, {\n        x: x + 2 * dx / 3,\n        y: y + dy\n      }];\n      node.label.x = node.x;\n      node.label.y = node.y;\n    }\n  });\n};\nvar selectNumberAttrs = function (obj, attrs) {\n  var pickedProperties = {};\n  attrs === null || attrs === void 0 ? void 0 : attrs.forEach(function (key) {\n    if (obj[key] === undefined) return;\n    pickedProperties[key] = +obj[key];\n  });\n  return pickedProperties;\n};\nvar canonicalize = function (attrs) {\n  if (attrs === void 0) {\n    attrs = {};\n  }\n  var newAttrs = {};\n  Object.keys(attrs).forEach(function (k) {\n    newAttrs[k.toLowerCase()] = attrs[k];\n  });\n  return newAttrs;\n};\nexports.default = layout;","map":{"version":3,"mappings":"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","names":["layout","g","opts","time","debugTiming","util_1","keepNodeOrder","prevGraph","inheritOrder","layoutGraph","buildLayoutGraph","edgeLabelSpace","makeSpaceForEdgeLabels","runLayout","e","message","console","error","updateInputGraph","removeSelfEdges","acyclic_1","run","nesting_graph_1","injectEdgeLabelProxies","cleanup","assignRankMinMax","removeEdgeLabelProxies","normalize_1","nodeOrder","insertSelfEdges","coordinate_system_1","adjust","positionSelfEdges","removeBorderNodes","undo","fixupEdgeLabelCoords","translateGraph","assignNodeIntersects","reversePointsForReversedEdges","currG","prevG","nodes","forEach","n","node","prevNode","undefined","fixorder","_order","inputGraph","v","inputLabel","layoutLabel","x","y","order","_rank","rank","children","length","width","height","edges","edge","points","hasOwnProperty","graph","graphNumAttrs","graphDefaults","ranksep","edgesep","nodesep","rankdir","graphAttrs","nodeNumAttrs","nodeDefaults","edgeNumAttrs","edgeDefaults","minlen","weight","labeloffset","labelpos","edgeAttrs","graph_1","multigraph","compound","canonicalize","pickedProperties","key","setGraph","Object","assign","selectNumberAttrs","defaultNode","__assign","defaultAttrs","setNode","setParent","parent","setEdgeObj","isNaN","layer","toLowerCase","w","label","maxRank","borderTop","minRank","borderBottom","Math","max","Infinity","dummy","labelRank","removeNode","minX","maxX","minY","maxY","graphLabel","marginX","marginx","marginY","marginy","getExtremes","attrs","h","min","p","nodeV","nodeW","p1","p2","unshift","push","reversed","reverse","t","b","l","borderLeft","r","borderRight","abs","selfEdges","removeEdgeObj","layers","orderShift","i","selfEdge","selfNode","dx","dy","obj","newAttrs","keys","k","exports"],"sourceRoot":"","sources":["../../../../src/layout/dagre/src/layout.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}