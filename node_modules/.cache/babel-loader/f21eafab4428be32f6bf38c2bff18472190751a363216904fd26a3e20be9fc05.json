{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-8d3fa864\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"m-t-40 flex-between\"\n};\nconst _hoisted_2 = {\n  class: \"flex-column-start\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  style: {\n    \"font-size\": \"12px\",\n    \"color\": \"#666\",\n    \"font-weight\": \"500\",\n    \"margin-top\": \"6px\"\n  }\n}, \"金额单位：万元\", -1));\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \" 数据设置 \", -1));\nconst _hoisted_5 = {\n  style: {\n    \"height\": \"180px\",\n    \"overflow\": \"scroll\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"display\": \"flex\",\n    \"align-items\": \"center\",\n    \"justify-content\": \"center\",\n    \"width\": \"100%\",\n    \"height\": \"40px\",\n    \"box-shadow\": \"0px -5px 6px -5px rgba(0, 0, 0, 0.2)\"\n  }\n};\nimport { ref } from 'vue';\nimport { dealData } from '@/utils/util.js';\nimport Different from '@/components/different.vue';\nexport default {\n  __name: 'noCollapseTable',\n  props: {\n    title: {\n      type: String,\n      default: ''\n    },\n    columns: {\n      type: Array,\n      default: () => []\n    },\n    setColumnsData: {\n      type: Array,\n      default: () => []\n    },\n    // 表头\n    data: {\n      type: Array,\n      default: () => []\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(__props) {\n    const props = __props;\n    const modalVisible = ref(false);\n    const setColumnsList = ref([]);\n    const defaultCheckList = ref([]);\n    const dataSource = ref(props.data);\n    const popupVisible = ref(false);\n    // 单行高亮处理\n    const activeRowClass = record => {\n      if (record.raw.isGreenLight) {\n        return 'activeRowGreen';\n      } else if (record.raw.isRate) {\n        return 'activeRowPurple';\n      } else {\n        return '';\n      }\n    };\n    // 打开环比差\n    const handleDifference = () => {\n      modalVisible.value = true;\n    };\n    // 关闭\n    const handleClose = () => {\n      modalVisible.value = false;\n    };\n    //数据配置回显\n    const dealsetColumns = arr => {\n      Array.isArray(arr) && arr.forEach(item => {\n        setColumnsList.value.push({\n          id: item.key,\n          analysis: item.analysis\n        });\n        if (item.children && item.children.length) {\n          dealsetColumns(item.children);\n        }\n      });\n    };\n    // 点击数据设置\n    const handleSetting = () => {\n      setColumnsList.value = [];\n      defaultCheckList.value = [];\n      dealsetColumns(props.setColumnsData);\n      dataSource.value.forEach(item => {\n        setColumnsList.value.forEach(ele => {\n          if (item.key === ele.id) {\n            defaultCheckList.value.push(item.key);\n          }\n        });\n      });\n    };\n    // 更改数据设置\n    const changeSet = val => {\n      defaultCheckList.value = val;\n    };\n    // 数据迁移\n    const dealSet = (arr, setArr) => {\n      Array.isArray(arr) && arr.forEach(item => {\n        if (defaultCheckList.value.indexOf(item.key) !== -1) {\n          if (item.children) {\n            let itemObj = JSON.parse(JSON.stringify(item));\n            delete itemObj.children;\n            setArr.push(itemObj);\n          } else {\n            setArr.push(item);\n          }\n        }\n        if (item.children && item.children.length) {\n          dealSet(item.children, setArr);\n        }\n      });\n      return setArr;\n    };\n    // 数据设置确定\n    const handleOk = () => {\n      let setArr = [];\n      dataSource.value = props.data;\n      setArr = dealSet(props.setColumnsData, setArr);\n      dataSource.value = setArr.concat(dataSource.value);\n      popupVisible.value = false;\n    };\n    // 取消\n    const handleCancle = () => {\n      popupVisible.value = false;\n    };\n    return (_ctx, _cache) => {\n      const _component_icon_layers = _resolveComponent(\"icon-layers\");\n      const _component_a_button = _resolveComponent(\"a-button\");\n      const _component_icon_settings = _resolveComponent(\"icon-settings\");\n      const _component_a_checkbox = _resolveComponent(\"a-checkbox\");\n      const _component_a_checkbox_group = _resolveComponent(\"a-checkbox-group\");\n      const _component_a_trigger = _resolveComponent(\"a-trigger\");\n      const _component_a_table = _resolveComponent(\"a-table\");\n      return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_a_button, {\n        type: \"text\",\n        style: {\n          \"color\": \"#333\"\n        }\n      }, {\n        icon: _withCtx(() => [_createVNode(_component_icon_layers)]),\n        default: _withCtx(() => [_createElementVNode(\"h3\", null, _toDisplayString(props.title), 1)]),\n        _: 1\n      }), _hoisted_3]), _createElementVNode(\"div\", null, [_createVNode(_component_a_button, {\n        type: \"text\",\n        style: {\n          \"color\": \"#5370FF\",\n          \"font-weight\": \"500\"\n        },\n        onClick: handleDifference\n      }, {\n        default: _withCtx(() => [_createTextVNode(\" 环比差 \")]),\n        _: 1\n      }), _createVNode(_component_a_trigger, {\n        trigger: \"click\",\n        \"popup-visible\": popupVisible.value,\n        \"onUpdate:popup-visible\": _cache[1] || (_cache[1] = $event => popupVisible.value = $event),\n        \"update-at-scroll\": \"\",\n        \"popup-translate\": [-50, 20],\n        style: {\n          \"width\": \"160px\",\n          \"background-color\": \"white\",\n          \"box-shadow\": \"0px 1px 4px rgba(0, 0, 0, 0.2)\"\n        }\n      }, {\n        content: _withCtx(() => [_createElementVNode(\"div\", null, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_a_checkbox_group, {\n          modelValue: defaultCheckList.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => defaultCheckList.value = $event),\n          onChange: changeSet\n        }, {\n          default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(setColumnsList.value, item => {\n            return _openBlock(), _createBlock(_component_a_checkbox, {\n              key: item.id,\n              value: item.id,\n              class: \"m-t-10\"\n            }, {\n              default: _withCtx(() => [_createTextVNode(_toDisplayString(item.analysis), 1)]),\n              _: 2\n            }, 1032, [\"value\"]);\n          }), 128))]),\n          _: 1\n        }, 8, [\"modelValue\"])])]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_a_button, {\n          style: {\n            \"width\": \"50px\",\n            \"height\": \"25px\"\n          },\n          onClick: handleCancle\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"取消\")]),\n          _: 1\n        }), _createVNode(_component_a_button, {\n          style: {\n            \"width\": \"50px\",\n            \"height\": \"25px\",\n            \"margin-left\": \"10px\"\n          },\n          type: \"primary\",\n          onClick: handleOk\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"确认\")]),\n          _: 1\n        })])]),\n        default: _withCtx(() => [_createVNode(_component_icon_settings, {\n          style: {\n            \"color\": \"#5370FF\",\n            \"margin-left\": \"20px\",\n            \"font-size\": \"14px\",\n            \"font-weight\": \"500\"\n          },\n          onClick: handleSetting\n        })]),\n        _: 1\n      }, 8, [\"popup-visible\"])])]), _createVNode(_component_a_table, {\n        class: \"m-t-20 arcoTable_columnsWidthAuto\",\n        columns: props.columns.length && props.columns || [],\n        data: dataSource.value.length > 0 ? dataSource.value : props.data,\n        loading: props.loading,\n        pagination: false,\n        \"row-class\": activeRowClass,\n        \"show-empty-tree\": \"\",\n        bordered: {\n          wrapper: true,\n          cell: true\n        }\n      }, null, 8, [\"columns\", \"data\", \"loading\"]), _createVNode(Different, {\n        modalVisible: modalVisible.value,\n        data: dataSource.value.length > 0 ? dataSource.value : props.data,\n        columns: props.columns,\n        onHandleClose: handleClose\n      }, null, 8, [\"modalVisible\", \"data\", \"columns\"])]);\n    };\n  }\n};","map":{"version":3,"mappings":"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","names":["ref","dealData","Different","modalVisible","setColumnsList","defaultCheckList","dataSource","props","data","popupVisible","activeRowClass","record","raw","isGreenLight","isRate","handleDifference","value","handleClose","dealsetColumns","arr","Array","isArray","forEach","item","push","id","key","analysis","children","length","handleSetting","setColumnsData","ele","changeSet","val","dealSet","setArr","indexOf","itemObj","JSON","parse","stringify","handleOk","concat","handleCancle"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-oms-frontend/src/components/noCollapseTable.vue"],"sourcesContent":["<template>\n  <div>\n      <!-- 不折叠表格部分 -->\n      <!-- 环比差按钮及数据设置 -->\n      <div class=\"m-t-40 flex-between\">\n          <div class=\"flex-column-start\">\n              <a-button type=\"text\" style=\"color:#333\">\n                  <template #icon>\n                      <icon-layers />\n                  </template>\n                  <h3>{{ props.title }}</h3>\n              </a-button>\n              <span style=\"font-size: 12px;color:#666;font-weight: 500;margin-top:6px\">金额单位：万元</span>\n          </div>\n          <div>\n              <a-button type=\"text\" style=\"color:#5370FF;font-weight:500\" @click=\"handleDifference\">\n                  环比差\n              </a-button>\n              <!-- 数据设置 -->\n              <a-trigger trigger=\"click\" v-model:popup-visible=\"popupVisible\"   update-at-scroll  :popup-translate=\"[-50, 20]\" style=\"width: 160px;background-color: white;box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\">\n                <icon-settings style=\"color:#5370FF;margin-left:20px;font-size: 14px;font-weight:500\" @click=\"handleSetting\"/>\n                <template #content>\n                    <div>\n                        <div class=\"title\"> \n                            数据设置\n                        </div>\n                        <div  style=\"height:180px;overflow: scroll;\">\n                            <a-checkbox-group v-model=\"defaultCheckList\" @change=\"changeSet\">\n                                <a-checkbox  v-for=\"item of setColumnsList\" :key=\"item.id\" :value=\"item.id\" class=\"m-t-10\">\n                                    {{ item.analysis }}\n                                </a-checkbox>\n                            </a-checkbox-group>\n                        </div>\n                    </div>\n                    <div style=\"display:flex;align-items: center;justify-content: center;width:100%;height:40px;box-shadow: 0px -5px 6px -5px rgba(0, 0, 0, 0.2);\">\n                        <a-button style=\"width: 50px;height:25px;\" @click=\"handleCancle\">取消</a-button>\n                        <a-button style=\"width: 50px;height:25px;margin-left:10px;\" type=\"primary\" @click=\"handleOk\">确认</a-button>\n                    </div>\n                </template>\n             </a-trigger>\n          </div>\n      </div>\n      <!-- 表格部分 -->\n      <a-table \n      class=\"m-t-20 arcoTable_columnsWidthAuto\" \n      :columns=\"(props.columns.length && props.columns) || []\"  \n      :data=\"dataSource.length>0?dataSource:props.data\"  \n      :loading=\"props.loading\"\n      :pagination=\"false\" \n      :row-class=\"activeRowClass\"\n      show-empty-tree \n      :bordered=\"{wrapper: true, cell: true}\" \n      />\n      <!-- 环比差弹窗 -->\n      <Different :modalVisible=\"modalVisible\" :data=\"dataSource.length>0?dataSource:props.data\"  :columns=\"props.columns\" @handleClose=\"handleClose\"/>\n  </div>\n</template>\n\n<script setup>\nimport { ref} from 'vue';\nimport {dealData} from '@/utils/util.js';\nimport Different from  '@/components/different.vue';\nconst props = defineProps({\n    title:{\n        type:String,\n        default:''\n    },\n    columns: {\n        type: Array,\n        default: () => [],\n    },\n    setColumnsData:{\n        type: Array,\n        default: () => [],\n    },\n    // 表头\n    data: {\n        type: Array,\n        default: () => [],\n    },\n    loading:{\n        type:Boolean,\n        default:false\n    },\n});\nconst modalVisible = ref(false);\nconst setColumnsList = ref([]);\nconst defaultCheckList = ref([]);\nconst dataSource  = ref(props.data);\nconst popupVisible = ref(false);\n// 单行高亮处理\nconst activeRowClass = (record) => {\n    if(record.raw.isGreenLight){\n        return 'activeRowGreen'\n    }else if(record.raw.isRate){\n        return 'activeRowPurple'\n    }else{\n        return ''\n    }\n};\n// 打开环比差\nconst handleDifference = () => {\n    modalVisible.value = true;\n};\n// 关闭\nconst handleClose = () => {\n    modalVisible.value = false;\n};\n//数据配置回显\nconst dealsetColumns =(arr)=>{\n    Array.isArray(arr) && arr.forEach(item=>{\n        setColumnsList.value.push({\n            id:item.key,\n            analysis: item.analysis\n        })\n        if(item.children && item.children.length){\n            dealsetColumns(item.children)\n        }\n    })\n}\n// 点击数据设置\nconst handleSetting = ()=>{\n    setColumnsList.value = []\n    defaultCheckList.value = []\n    dealsetColumns(props.setColumnsData);\n    dataSource.value.forEach(item=>{\n        setColumnsList.value.forEach(ele=>{\n            if(item.key === ele.id){\n                defaultCheckList.value.push(item.key)\n            }\n        })\n    })\n}\n// 更改数据设置\nconst changeSet =(val)=>{\n    defaultCheckList.value = val;\n}\n// 数据迁移\nconst dealSet=(arr,setArr)=>{\n    Array.isArray(arr) && arr.forEach(item=>{\n        if(defaultCheckList.value.indexOf(item.key)!==-1){\n                if(item.children){\n                    let itemObj = JSON.parse(JSON.stringify(item));\n                    delete itemObj.children\n                    setArr.push(itemObj);\n                }else{\n                    setArr.push(item);\n                }\n        }\n        if(item.children && item.children.length){\n            dealSet(item.children,setArr)\n        }\n    })\n    return setArr\n};\n// 数据设置确定\nconst handleOk =()=>{ \n    let  setArr =[]\n    dataSource.value = props.data;\n    setArr = dealSet(props.setColumnsData,setArr);\n    dataSource.value = setArr.concat(dataSource.value);\n    popupVisible.value = false\n};\n// 取消\nconst handleCancle= ()=>{\n    popupVisible.value = false\n};\n</script>\n\n<style lang=\"scss\" scoped>\n:deep(.activeRowGreen > .arco-table-td) {\n    background-color: rgb(234, 248, 243) !important;\n}\n:deep(.activeRowPurple > .arco-table-td) {\n    background-color: rgb(240, 237, 248) !important;\n}\n:global(.arco-dropdown-group-title){\n    background-color: white;\n    position: fixed;\n    margin-top:-40px !important;\n    z-index:9999;\n    font-size:12px;\n    color:rgba(0, 0, 0, 0.647058823529412);\n}\n.title{\n    font-size:12px;\n    color:rgba(0, 0, 0, 0.647058823529412);\n    box-shadow: 0.2px 1px 1px rgba(0, 0, 0, 0.2);\n    padding: 10px;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}