{"ast":null,"code":"import TableContainer from \"@/components/tableContainer.vue\";\nimport { empInfo, exportExcel } from '../../api/empInfo.js';\nimport { onBeforeMount, reactive, ref } from \"vue\";\nimport { Message } from \"@arco-design/web-vue\";\nimport moment from 'moment';\nexport default {\n  __name: 'empInfo',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const monthVal = ref(new Date());\n    const handleMothPicker = (value, date) => {\n      monthVal.value = date;\n      getData();\n    };\n    const dataContent = reactive({\n      loading: false,\n      columns: [{\n        title: '员工编号',\n        dataIndex: 'empCode',\n        key: 'empCode',\n        width: 110\n      }, {\n        title: '员工姓名',\n        dataIndex: 'empName',\n        key: 'empName',\n        width: 110\n      }, {\n        title: '成本中心',\n        dataIndex: 'costCenterName',\n        key: 'costCenterName',\n        width: 110\n      }, {\n        title: '所属实体',\n        dataIndex: 'entityName',\n        key: 'entityName',\n        width: 250\n      }, {\n        title: '在职状态',\n        dataIndex: 'status',\n        key: 'status',\n        width: 110\n      }, {\n        title: '所属部门',\n        dataIndex: 'deptName',\n        key: 'deptName',\n        width: 200\n      }, {\n        title: '部门经理',\n        dataIndex: 'deptManager',\n        key: 'deptManager',\n        width: 110\n      }, {\n        title: '客户名称',\n        dataIndex: 'customerName',\n        key: 'customerName',\n        width: 250\n      }, {\n        title: '项目名称',\n        dataIndex: 'projectName',\n        key: 'projectName',\n        width: 220\n      }, {\n        title: '入职时间',\n        dataIndex: 'hireDate',\n        key: 'hireDate',\n        width: 110\n      }, {\n        title: '离职时间',\n        dataIndex: 'dismissDate',\n        key: 'dismissDate',\n        width: 150\n      }, {\n        title: '职位',\n        dataIndex: 'position',\n        key: 'position',\n        width: 150\n      }, {\n        title: '工作地',\n        dataIndex: 'workPlace',\n        key: 'workPlace',\n        width: 110\n      }, {\n        title: '员工属性',\n        dataIndex: 'empAttr',\n        key: 'empAttr',\n        width: 110\n      }],\n      dataSource: [],\n      pagination: {\n        pageSize: 20,\n        pageNum: 1,\n        total: 10\n      }\n    });\n    const exportLoading = ref(false);\n    const handleExport = () => {\n      exportLoading.value = true;\n      let params = {\n        month: moment(monthVal.value).format('yyyy-MM')\n      };\n      exportExcel(params).then(res => {\n        const blob = new Blob([res]);\n        const fileName = `C1人员信息_${moment(monthVal.value).format('yyyyMM')}.xlsx`;\n        const link = document.createElement(\"a\");\n        link.download = fileName;\n        link.style.display = \"none\";\n        link.href = URL.createObjectURL(blob);\n        document.body.appendChild(link);\n        link.click();\n        URL.revokeObjectURL(link.href);\n        document.body.removeChild(link);\n      }).catch(() => {\n        Message.error(\"导出失败\");\n      }).finally(() => {\n        exportLoading.value = false;\n      });\n    };\n    onBeforeMount(() => {\n      getData();\n    });\n    const getData = () => {\n      let params = {\n        month: moment(monthVal.value).format('yyyy-MM'),\n        pageNum: dataContent.pagination.pageNum,\n        pageSize: dataContent.pagination.pageSize\n      };\n      dataContent.loading = true;\n      empInfo(params).then(res => {\n        if (res.code === '000000000000') {\n          let {\n            list,\n            total\n          } = res.data;\n          dataContent.pagination.total = !isNaN(+total) && +total;\n          Array.isArray(list) && list.forEach((item, i) => {\n            item.key = item.empCode;\n          });\n          dataContent.dataSource = list;\n        }\n      }).catch(e => {\n        Message.error(e.message || '请求失败');\n      }).finally(() => {\n        dataContent.loading = false;\n      });\n    };\n    const paginationCurrentChange = pageNum => {\n      dataContent.pagination.pageNum = pageNum;\n      getData();\n    };\n    const paginationPageSizeChange = pageSize => {\n      dataContent.pagination.pageSize = pageSize;\n      getData();\n    };\n    const __returned__ = {\n      monthVal,\n      handleMothPicker,\n      dataContent,\n      exportLoading,\n      handleExport,\n      getData,\n      paginationCurrentChange,\n      paginationPageSizeChange,\n      TableContainer,\n      get empInfo() {\n        return empInfo;\n      },\n      get exportExcel() {\n        return exportExcel;\n      },\n      onBeforeMount,\n      reactive,\n      ref,\n      get Message() {\n        return Message;\n      },\n      get moment() {\n        return moment;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"mappings":"AA0CA,OAAOA,cAAc,MAAM,iCAAiC;AAC5D,SAASC,OAAO,EAAEC,WAAW,QAAQ,sBAAsB;AAC3D,SAASC,aAAa,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,KAAK;AAClD,SAASC,OAAO,QAAQ,sBAAsB;AAC9C,OAAOC,MAAM,MAAM,QAAQ;;;;;;;IAE3B,MAAMC,QAAQ,GAAGH,GAAG,CAAC,IAAII,IAAI,EAAE,CAAC;IAEhC,MAAMC,gBAAgB,GAAG,CAACC,KAAK,EAACC,IAAI,KAAG;MACnCJ,QAAQ,CAACG,KAAK,GAAGC,IAAI;MACrBC,OAAO,EAAE;IACb,CAAC;IAED,MAAMC,WAAW,GAAGV,QAAQ,CAAC;MACzBW,OAAO,EAAG,KAAK;MACfC,OAAO,EAAG,CACN;QACIC,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,SAAS;QACpBC,GAAG,EAAE,SAAS;QACdC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,SAAS;QACpBC,GAAG,EAAE,SAAS;QACdC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,gBAAgB;QAC3BC,GAAG,EAAE,gBAAgB;QACrBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,YAAY;QACvBC,GAAG,EAAE,YAAY;QACjBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,QAAQ;QACnBC,GAAG,EAAE,QAAQ;QACbC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,UAAU;QACrBC,GAAG,EAAE,UAAU;QACfC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,aAAa;QACxBC,GAAG,EAAE,aAAa;QAClBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,cAAc;QACzBC,GAAG,EAAE,cAAc;QACnBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,aAAa;QACxBC,GAAG,EAAE,aAAa;QAClBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,UAAU;QACrBC,GAAG,EAAE,UAAU;QACfC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,aAAa;QACxBC,GAAG,EAAE,aAAa;QAClBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,IAAI;QACXC,SAAS,EAAE,UAAU;QACrBC,GAAG,EAAE,UAAU;QACfC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,KAAK;QACZC,SAAS,EAAE,WAAW;QACtBC,GAAG,EAAE,WAAW;QAChBC,KAAK,EAAG;MACZ,CAAC,EACD;QACIH,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,SAAS;QACpBC,GAAG,EAAE,SAAS;QACdC,KAAK,EAAG;MACZ,CAAC,CACJ;MACDC,UAAU,EAAG,EAAE;MACfC,UAAU,EAAG;QACTC,QAAQ,EAAG,EAAE;QACbC,OAAO,EAAG,CAAC;QACXC,KAAK,EAAG;MACZ;IAEJ,CAAC,CAAC;IAEF,MAAMC,aAAa,GAAGrB,GAAG,CAAC,KAAK,CAAC;IAChC,MAAMsB,YAAY,GAAG,MAAI;MACrBD,aAAa,CAACf,KAAK,GAAG,IAAI;MAC1B,IAAIiB,MAAM,GAAG;QACTC,KAAK,EAAGtB,MAAM,CAACC,QAAQ,CAACG,KAAK,CAAC,CAACmB,MAAM,CAAC,SAAS;MACnD,CAAC;MACD5B,WAAW,CAAC0B,MAAM,CAAC,CAClBG,IAAI,CAACC,GAAG,IAAI;QACX,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACF,GAAG,CAAC,CAAC;QAC5B,MAAMG,QAAQ,GAAI,UAAS5B,MAAM,CAACC,QAAQ,CAACG,KAAK,CAAC,CAACmB,MAAM,CAAC,QAAQ,CAAE,OAAM;QACzE,MAAMM,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;QACxCF,IAAI,CAACG,QAAQ,GAAGJ,QAAQ;QACxBC,IAAI,CAACI,KAAK,CAACC,OAAO,GAAG,MAAM;QAC3BL,IAAI,CAACM,IAAI,GAAGC,GAAG,CAACC,eAAe,CAACX,IAAI,CAAC;QACrCI,QAAQ,CAACQ,IAAI,CAACC,WAAW,CAACV,IAAI,CAAC;QAC/BA,IAAI,CAACW,KAAK,EAAE;QACZJ,GAAG,CAACK,eAAe,CAACZ,IAAI,CAACM,IAAI,CAAC;QAC9BL,QAAQ,CAACQ,IAAI,CAACI,WAAW,CAACb,IAAI,CAAC;MACjC,CAAC,CAAC,CACDc,KAAK,CAAC,MAAM;QACX5C,OAAO,CAAC6C,KAAK,CAAC,MAAM,CAAC;MACvB,CAAC,CAAC,CACDC,OAAO,CAAC,MAAM;QACX1B,aAAa,CAACf,KAAK,GAAG,KAAK;MAC/B,CAAC,CAAC;IACN,CAAC;IAEDR,aAAa,CAAC,MAAI;MACdU,OAAO,EAAE;IACb,CAAC,CAAC;IAEF,MAAMA,OAAO,GAAG,MAAI;MAChB,IAAIe,MAAM,GAAC;QACPC,KAAK,EAAGtB,MAAM,CAACC,QAAQ,CAACG,KAAK,CAAC,CAACmB,MAAM,CAAC,SAAS,CAAC;QAChDN,OAAO,EAAGV,WAAW,CAACQ,UAAU,CAACE,OAAO;QACxCD,QAAQ,EAAGT,WAAW,CAACQ,UAAU,CAACC;MACtC,CAAC;MACDT,WAAW,CAACC,OAAO,GAAG,IAAI;MAC1Bd,OAAO,CAAC2B,MAAM,CAAC,CAACG,IAAI,CAACC,GAAG,IAAE;QACtB,IAAGA,GAAG,CAACqB,IAAI,KAAK,cAAc,EAAC;UAC3B,IAAI;YAAEC,IAAI;YAAC7B;UAAK,CAAC,GAAGO,GAAG,CAACuB,IAAI;UAC5BzC,WAAW,CAACQ,UAAU,CAACG,KAAK,GAAG,CAAC+B,KAAK,CAAC,CAAC/B,KAAK,CAAC,IAAI,CAACA,KAAK;UACvDgC,KAAK,CAACC,OAAO,CAACJ,IAAI,CAAC,IAAIA,IAAI,CAACK,OAAO,CAAC,CAACC,IAAI,EAACC,CAAC,KAAG;YAC1CD,IAAI,CAACzC,GAAG,GAAGyC,IAAI,CAACE,OAAO;UAC3B,CAAC,CAAC;UACFhD,WAAW,CAACO,UAAU,GAAGiC,IAAI;QACjC;MACJ,CAAC,CAAC,CAACJ,KAAK,CAACa,CAAC,IAAE;QACRzD,OAAO,CAAC6C,KAAK,CAACY,CAAC,CAACC,OAAO,IAAI,MAAM,CAAC;MACtC,CAAC,CAAC,CAACZ,OAAO,CAAC,MAAI;QACXtC,WAAW,CAACC,OAAO,GAAG,KAAK;MAC/B,CAAC,CAAC;IACN,CAAC;IACD,MAAMkD,uBAAuB,GAAIzC,OAAO,IAAG;MACvCV,WAAW,CAACQ,UAAU,CAACE,OAAO,GAAGA,OAAO;MACxCX,OAAO,EAAE;IACb,CAAC;IACD,MAAMqD,wBAAwB,GAAI3C,QAAQ,IAAG;MACzCT,WAAW,CAACQ,UAAU,CAACC,QAAQ,GAAGA,QAAQ;MAC1CV,OAAO,EAAE;IACb,CAAC","names":["TableContainer","empInfo","exportExcel","onBeforeMount","reactive","ref","Message","moment","monthVal","Date","handleMothPicker","value","date","getData","dataContent","loading","columns","title","dataIndex","key","width","dataSource","pagination","pageSize","pageNum","total","exportLoading","handleExport","params","month","format","then","res","blob","Blob","fileName","link","document","createElement","download","style","display","href","URL","createObjectURL","body","appendChild","click","revokeObjectURL","removeChild","catch","error","finally","code","list","data","isNaN","Array","isArray","forEach","item","i","empCode","e","message","paginationCurrentChange","paginationPageSizeChange"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-mgmt-frontend/src/views/dataManagement/empInfo.vue"],"sourcesContent":["<template>\n    <div class=\"defaultPadding\">\n        <a-row :gutter=\"[14,20]\" align=\"center\">\n            <a-col flex=\"120px\">\n                <a-month-picker v-bind:model-value=\"monthVal\" @change=\"handleMothPicker\"/>\n            </a-col>\n            <a-col flex=\"85px\">\n            </a-col>\n            <a-col flex=\"85px\">\n            </a-col>\n            <a-col flex=\"auto\"></a-col>\n            <a-col flex=\"100px\">\n                <a-button type=\"primary\" :loading=\"exportLoading\" @click=\"handleExport\">\n                <template #icon>\n                  <icon-export />\n                </template>\n                <template #default>导出本页</template>\n              </a-button>\n            </a-col>\n        </a-row>\n        <a-row>\n            <a-col :span=\"24\">\n                <TableContainer\n                    column-resizable\n                    scrollY=\"600px\"\n                    :scrollbar=\"false\"\n                    :loading=\"dataContent.loading\"\n                    :paginationTotal=\"dataContent.pagination.total\"\n                    :paginationPageSize=\"dataContent.pagination.pageSize\"\n                    :paginationCurrent=\"dataContent.pagination.pageNum\"\n                    :tableColumns=\"dataContent.columns\"\n                    :table-data=\"dataContent.dataSource\"\n                    @paginationCurrentChange=\"paginationCurrentChange\"\n                    @paginationPageSizeChange=\"paginationPageSizeChange\"\n                    >\n                </TableContainer>\n            </a-col>\n        </a-row>\n    </div>\n</template>\n\n<script setup>\nimport TableContainer from \"@/components/tableContainer.vue\";\nimport { empInfo, exportExcel } from '../../api/empInfo.js'\nimport { onBeforeMount, reactive, ref } from \"vue\";\nimport { Message } from \"@arco-design/web-vue\";\nimport moment from 'moment'\n\nconst monthVal = ref(new Date())\n\nconst handleMothPicker = (value,date)=>{\n    monthVal.value = date\n    getData()\n}\n\nconst dataContent = reactive({\n    loading : false,\n    columns : [\n        {\n            title: '员工编号',\n            dataIndex: 'empCode',\n            key: 'empCode',\n            width : 110    \n        },\n        {\n            title: '员工姓名',\n            dataIndex: 'empName',\n            key: 'empName',\n            width : 110    \n        },\n        {\n            title: '成本中心',\n            dataIndex: 'costCenterName',\n            key: 'costCenterName',\n            width : 110\n        },\n        {\n            title: '所属实体',\n            dataIndex: 'entityName',\n            key: 'entityName',\n            width : 250   \n        },\n        {\n            title: '在职状态',\n            dataIndex: 'status',\n            key: 'status',\n            width : 110    \n        },\n        {\n            title: '所属部门',\n            dataIndex: 'deptName',\n            key: 'deptName',\n            width : 200    \n        },\n        {\n            title: '部门经理',\n            dataIndex: 'deptManager',\n            key: 'deptManager',\n            width : 110    \n        },\n        {\n            title: '客户名称',\n            dataIndex: 'customerName',\n            key: 'customerName',\n            width : 250\n        },\n        {\n            title: '项目名称',\n            dataIndex: 'projectName',\n            key: 'projectName',\n            width : 220   \n        },\n        {\n            title: '入职时间',\n            dataIndex: 'hireDate',\n            key: 'hireDate',\n            width : 110   \n        },   \n        {\n            title: '离职时间',\n            dataIndex: 'dismissDate',\n            key: 'dismissDate',\n            width : 150    \n        },\n        {\n            title: '职位',\n            dataIndex: 'position',\n            key: 'position',\n            width : 150   \n        },   \n        {\n            title: '工作地',\n            dataIndex: 'workPlace',\n            key: 'workPlace',\n            width : 110   \n        },   \n        {\n            title: '员工属性',\n            dataIndex: 'empAttr',\n            key: 'empAttr',\n            width : 110   \n        },\n    ],\n    dataSource : [],\n    pagination : {\n        pageSize : 20,\n        pageNum : 1,\n        total : 10\n    }\n\n})\n\nconst exportLoading = ref(false)\nconst handleExport = ()=>{\n    exportLoading.value = true\n    let params = {\n        month : moment(monthVal.value).format('yyyy-MM')\n    }\n    exportExcel(params)\n    .then(res => {\n      const blob = new Blob([res]);\n      const fileName = `C1人员信息_${moment(monthVal.value).format('yyyyMM')}.xlsx`;\n      const link = document.createElement(\"a\");\n      link.download = fileName;\n      link.style.display = \"none\";\n      link.href = URL.createObjectURL(blob);\n      document.body.appendChild(link);\n      link.click();\n      URL.revokeObjectURL(link.href);\n      document.body.removeChild(link);\n    })\n    .catch(() => {\n      Message.error(\"导出失败\");\n    })\n    .finally(() => {\n        exportLoading.value = false;\n    });\n}\n\nonBeforeMount(()=>{\n    getData()\n})\n\nconst getData = ()=>{\n    let params={\n        month : moment(monthVal.value).format('yyyy-MM'),\n        pageNum : dataContent.pagination.pageNum,\n        pageSize : dataContent.pagination.pageSize\n    }\n    dataContent.loading = true\n    empInfo(params).then(res=>{\n        if(res.code === '000000000000'){\n            let { list,total} = res.data\n            dataContent.pagination.total = !isNaN(+total) && +total\n            Array.isArray(list) && list.forEach((item,i)=>{\n                item.key = item.empCode\n            })\n            dataContent.dataSource = list\n        }\n    }).catch(e=>{\n        Message.error(e.message || '请求失败')\n    }).finally(()=>{\n        dataContent.loading = false\n    })\n} \nconst paginationCurrentChange = (pageNum)=>{\n    dataContent.pagination.pageNum = pageNum\n    getData()\n}\nconst paginationPageSizeChange = (pageSize)=>{\n    dataContent.pagination.pageSize = pageSize\n    getData()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}