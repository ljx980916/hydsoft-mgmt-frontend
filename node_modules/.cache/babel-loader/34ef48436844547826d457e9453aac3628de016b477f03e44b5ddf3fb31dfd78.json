{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport \"core-js/modules/es.array.push.js\";\nimport { onBeforeMount, reactive, ref, watchEffect, nextTick, toRaw, onUnmounted, markRaw } from \"vue\";\nimport { Message } from \"@arco-design/web-vue\";\nimport scatterPlot from \"@/components/scatterPlot.vue\";\nimport { useTagColumnListStore } from \"../../store/index\";\nimport { queryCoreData, queryDownDrillSecond, queryDownDrillThird, countWorkdaysByMonth, queryScatterDiagram, listByProjectNo, queryLikeDept, save, empExportExcel, bgExportExcel, cuPoExportExcel, downAllExcel } from \"../../api/drillAnalyze\";\nimport { number2percentage, toInteger, dataAddKey, getCurrentDate, encrypt } from \"../../utils/util\";\nimport { getCurrentInstance } from \"@vue/runtime-core\";\nimport moment from \"moment\";\nexport default {\n  __name: 'drillAnalyze',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    let $bus = getCurrentInstance().appContext.config.globalProperties.$bus;\n\n    // 第三层tab\n    const level3TabSelect = ref(\"list\");\n    let level3HeaderContent = [];\n    /************* 下钻分析列信息************** */\n    let tagColumnList = useTagColumnListStore();\n    let level3ProjectCode = \"\"; //下钻三层的项目编码\n\n    let level2Record = {}; //点击下钻时的数据\n    let level3Record = {};\n    let columConfig = {};\n    // 颜色维度列表\n    const typeList = ref([{\n      label: 1,\n      value: \"出勤\"\n    }, {\n      label: 2,\n      value: \"入职日期\"\n    }]);\n    // 颜色维度\n    const type = ref(1);\n    // 数据\n    const data = ref([]);\n    // 颜色种类\n    const color = ref([]);\n    // 看图 & 列表\n    const dataType = ref(\"list\");\n\n    //禁止选择2022(含)年之前的月份\n    const disabledDateFn = current => {\n      return current.valueOf() < moment(\"2023-01-01 00:00:00\").valueOf();\n    };\n    const level3HeaderData = ref({});\n    const columns = () => {\n      let tagColumns = toRaw(tagColumnList.getTagColumnList) || [];\n      let currentPageColumn = tagColumns.filter(item => item.report === \"下钻分析\") || [];\n      if (currentPageColumn.length) {\n        currentPageColumn[0].tier.forEach((item, index) => {\n          let tabs = [];\n          let currentPageColumn = {};\n          item.tags.forEach(jtem => {\n            tabs.push(jtem.tag);\n            let columnItem = [];\n            jtem.columns.forEach(ktem => {\n              let {\n                col,\n                conf,\n                title\n              } = ktem;\n              conf = conf || {};\n              let columnItemConfig = {\n                title,\n                dataIndex: col,\n                align: conf.align,\n                cellStyle: {\n                  \"text-align\": conf.cellAlign\n                },\n                width: conf.width,\n                ellipsis: true,\n                headerCellClass: \"noEllipsis\",\n                slotName: col,\n                titleSlotName: \"columTitleSlot\"\n              };\n              if (conf.fixed !== undefined) {\n                columnItemConfig.fixed = conf.fixed;\n              }\n              if (conf.toFixed !== undefined) {\n                if (conf.showPercent) {\n                  columnItemConfig.render = ({\n                    record\n                  }) => {\n                    return _createVNode(\"span\", {\n                      \"innerHTML\": number2percentage(record[col], conf.toFixed, conf.isRed)\n                    }, null);\n                  };\n                } else {\n                  columnItemConfig.render = ({\n                    record\n                  }) => {\n                    return _createVNode(\"span\", {\n                      \"innerHTML\": toInteger(record[col], conf.toFixed, conf.isRed)\n                    }, null);\n                  };\n                }\n              }\n              columnItem.push(columnItemConfig);\n            });\n            currentPageColumn[jtem.tag.key] = columnItem;\n          });\n          columConfig[\"level\" + (index + 1)] = {\n            tabs,\n            params: item.params || [],\n            columns: currentPageColumn\n          };\n        });\n      }\n      let {\n        level1,\n        level2,\n        level3\n      } = columConfig;\n      level1CheckedValue.value = level1.tabs[0].key;\n      level2CheckedValue.value = level2.tabs[1].key;\n      level3CheckedValue.value = level3.tabs[1].key;\n      tableInfo.level1.tabs = level1.tabs;\n      tableInfo.level1.columns = level1.columns;\n      tableInfo.level2.tabs = level2.tabs;\n      tableInfo.level2.columns = level2.columns;\n      tableInfo.level3.tabs = level3.tabs;\n      tableInfo.level3.columns = level3.columns;\n    };\n    /************* 下钻分析列信息************** */\n\n    /***************获取当前月份********************* */\n    const currentLevel = ref(\"level1\"); //level2,level3\n    let {\n      year,\n      month\n    } = getCurrentDate();\n    let currentDate = `${year}-${month}`;\n    const dateNow = ref(currentDate);\n\n    /***************获取当前月份********************* */\n\n    /****************** 获取当月工作日天数************************** */\n    const currentMonthDay = ref(0);\n    const getCurrentMonthWorkday = () => {\n      const params = {\n        month: dateNow.value\n      };\n      console.log(params, 'params');\n      countWorkdaysByMonth(params).then(res => {\n        if (res.code === \"200\") {\n          currentMonthDay.value = res.data;\n        }\n      }).catch(() => {\n        Message.error(\"请求失败\");\n      });\n    };\n\n    /****************** 标签表格配置信息************************** */\n    const level1CheckedValue = ref(\"coreData\");\n    const level1RadioDisabled = ref(true);\n    const level2CheckedValue = ref(\"coreData2\");\n    const level2RadioDisabled = ref(true);\n    const level3CheckedValue = ref(\"empInfo\");\n    const level3RadioDisabled = ref(true);\n    const tableInfo = reactive({\n      loading: false,\n      level1: {\n        tabs: [],\n        columns: {},\n        data: [],\n        defaultExpandedKeys: [],\n        maxHeight: \"200px\"\n      },\n      level2: {\n        tabs: [],\n        columns: {},\n        data: [],\n        defaultExpandedKeys: [],\n        maxHeight: \"200px\"\n      },\n      level3: {\n        tabs: [],\n        columns: {},\n        data: [],\n        defaultExpandedKeys: [],\n        maxHeight: \"200px\"\n      }\n    });\n    /****************** 标签表格配置信息************************** */\n\n    /***************** 计算表格自适应高度************************ */\n    const level1tableRef = ref(null);\n    const level2tableRef = ref(null);\n    const level3tableRef = ref(null);\n\n    /***************** 计算表格自适应高度************************ */\n\n    /******************* 月份改变重新请求数据**************************** */\n    const monthPickChange = value => {\n      dateNow.value = value;\n      getCurrentMonthWorkday();\n      level1Data(level1CheckedValue.value);\n    };\n    /******************* 月份改变重新请求数据**************************** */\n    onBeforeMount(() => {\n      // if(month == '00'){\n      //   currentDate = `${year-1}-12`;\n      //   dateNow.value = currentDate;\n      // }\n      columns();\n      level1Data(level1CheckedValue.value);\n      getCurrentMonthWorkday();\n    });\n\n    /**************** 表格偶数层级指定背景色************************** */\n    const rowClass = record => {\n      if (record.raw.deptLevel % 2 === 0) {\n        return \"row-gray\";\n      }\n    };\n    const level3RadioCheckedChange = val => {\n      level3Data(val);\n    };\n    /******************** 根据所选标签请求表格数据*************************** */\n    const level1Data = tagKey => {\n      // let mon = dateNow.value + \"\";\n      // let month = mon.replaceAll(\"-\", \"\");\n      let month = dateNow.value;\n      console.log(month, 'month');\n      let params = {\n        month,\n        tagKey\n      };\n      tableInfo.loading = true;\n      level1RadioDisabled.value = true;\n      // console.log(dateNow.value,'dateNow.value');\n      // console.log(params,'params');\n      queryCoreData(params).then(res => {\n        if (res.code === \"200\") {\n          let data = dataAddKey(res.data, \"key\", \"id\");\n          let keys = [];\n          res.data.forEach(item => keys.push(item.id));\n          tableInfo.level1.defaultExpandedKeys = keys;\n          tableInfo.level1.data = data;\n          if (level1tableRef.value) {\n            let head = level1tableRef.value.$el;\n            let elHeight = head.getBoundingClientRect().top;\n            let innerHeight = window.innerHeight;\n            tableInfo.level1.maxHeight = innerHeight - elHeight + \"px\";\n            nextTick(() => {\n              let layoutContent = document.getElementById('a-layout-main');\n              if (layoutContent) {\n                let diff = layoutContent.scrollHeight - layoutContent.offsetHeight;\n                tableInfo.level1.maxHeight = parseInt(tableInfo.level1.maxHeight) - diff + 'px';\n              }\n            });\n          }\n        } else {\n          tableInfo.level1.data = [];\n          Message.error(res.desc || \"请求数据失败\");\n        }\n      }).catch(err => {\n        Message.error(err.message || \"请求数据失败\");\n      }).finally(() => {\n        tableInfo.loading = false;\n        level1RadioDisabled.value = false;\n      });\n    };\n    let level2keys = [];\n    function expandAllRows(arr) {\n      arr.forEach(item => {\n        level2keys.push(item.title);\n        if (item.children && item.children.length) {\n          expandAllRows(item.children);\n        }\n      });\n    }\n    const level2Data = tagKey => {\n      tableInfo.loading = true;\n      level2RadioDisabled.value = true;\n      $bus.emit(\"goBackDisabled\", true);\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        deptId: level2Record.id,\n        month,\n        tagKey\n      };\n      Array.isArray(columConfig.level1.params) && columConfig.level1.params.forEach(item => {\n        params[item] = encrypt(level2Record[item]);\n        if (level2Record[item] === undefined || level2Record[item] === null) {\n          params[item] = encrypt(0);\n        }\n      });\n      queryDownDrillSecond(params).then(res => {\n        if (res.code === \"200\") {\n          let data = dataAddKey(res.data, \"key\", \"title\");\n          expandAllRows(res.data);\n          tableInfo.level2.defaultExpandedKeys = level2keys;\n          tableInfo.level2.data = data;\n          if (level2CheckedValue.value !== \"financeManage2\") {\n            level3HeaderContent = data;\n          }\n          if (level2tableRef.value) {\n            let head = level2tableRef.value.$el;\n            let innerHeight = window.innerHeight;\n            let elHeight = head.getBoundingClientRect().top;\n            tableInfo.level2.maxHeight = innerHeight - elHeight + \"px\";\n          }\n          nextTick(() => {\n            let layoutContent = document.getElementById('a-layout-main');\n            if (layoutContent) {\n              let diff = layoutContent.scrollHeight - layoutContent.offsetHeight;\n              tableInfo.level2.maxHeight = parseInt(tableInfo.level2.maxHeight) - diff + 'px';\n            }\n          });\n        } else {\n          tableInfo.level2.data = [];\n          Message.error(res.desc || \"操作失败\");\n        }\n      }).catch(err => {\n        Message.error(err.message || \"请求数据失败\");\n      }).finally(() => {\n        tableInfo.loading = false;\n        level2RadioDisabled.value = false;\n        $bus.emit(\"goBackDisabled\", false);\n      });\n    };\n    const level3Data = tagKey => {\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        projectCode: level3ProjectCode,\n        deptId: level2Record.id,\n        month,\n        tagKey\n      };\n      Array.isArray(columConfig.level2.params) && columConfig.level2.params.forEach(item => {\n        params[item] = encrypt(level3Record[item]);\n        if (level3Record[item] === undefined || level3Record[item] === null) {\n          params[item] = encrypt(0);\n        }\n      });\n      tableInfo.loading = true;\n      level3RadioDisabled.value = true;\n      $bus.emit(\"goBackDisabled\", true);\n      queryDownDrillThird(params).then(res => {\n        if (res.code === \"200\") {\n          let data = dataAddKey(res.data, \"key\", \"id\");\n          let keys = [];\n          res.data.forEach(item => keys.push(item.id));\n          tableInfo.level3.defaultExpandedKeys = keys;\n          tableInfo.level3.data = data;\n          if (level3tableRef.value) {\n            let head = level3tableRef.value.$el;\n            let innerHeight = window.innerHeight;\n            let elHeight = head.getBoundingClientRect().top;\n            tableInfo.level3.maxHeight = innerHeight - elHeight + \"px\";\n          }\n          nextTick(() => {\n            let layoutContent = document.getElementById('a-layout-main');\n            if (layoutContent) {\n              let diff = layoutContent.scrollHeight - layoutContent.offsetHeight;\n              tableInfo.level3.maxHeight = parseInt(tableInfo.level3.maxHeight) - diff + 'px';\n            }\n          });\n        } else {\n          tableInfo.level3.data = [];\n          Message.error(res.desc || \"请求数据失败\");\n        }\n      }).catch(err => {\n        Message.error(err.message || \"请求数据失败\");\n      }).finally(() => {\n        tableInfo.loading = false;\n        level3RadioDisabled.value = false;\n        $bus.emit(\"goBackDisabled\", false);\n      });\n      getList(type.value);\n    };\n    /******************** 根据所选标签请求表格数据*************************** */\n\n    /***************** 标签点击切换请求数据************************** */\n    const radioCheckedChange = val => {\n      level1Data(val);\n    };\n    const level2RadioCheckedChange = val => {\n      level2Data(val);\n    };\n    /***************** 标签点击切换请求数据************************** */\n    watchEffect(() => {\n      $bus.emit(\"updateStructure\", [{\n        type: \"text\",\n        color: \"#333\",\n        msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`\n      }]);\n    });\n\n    /**************** 监听点击返回上一层***************************** */\n    $bus.on(\"goBack\", val => {\n      currentLevel.value = val;\n      switch (val) {\n        case \"level1\":\n          let breadList1 = [{\n            type: \"text\",\n            color: \"#333\",\n            msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`\n          }];\n          $bus.emit(\"updateStructure\", breadList1);\n          //level1Data(level1CheckedValue.value)\n          break;\n        case \"level2\":\n          let breadList2 = [{\n            type: \"button\",\n            color: \"#5370FD\",\n            msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`,\n            params: \"level1\"\n          }, {\n            type: \"text\",\n            color: \"#333\",\n            msg: level2Record.deptName\n          }];\n          $bus.emit(\"updateStructure\", breadList2);\n          break;\n        default:\n          break;\n      }\n    });\n    onUnmounted(() => {\n      $bus.off(\"goBack\");\n    });\n    /**************** 监听点击返回上一层***************************** */\n\n    /***********************点击跳转下钻层级********************************** */\n    const jump = (val, record) => {\n      currentLevel.value = val;\n      if (val === \"level2\") {\n        level2Record = record;\n        level2Data(level2CheckedValue.value);\n        let breadList = [{\n          type: \"button\",\n          color: \"#5370FD\",\n          msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`,\n          params: \"level1\"\n        }, {\n          type: \"text\",\n          color: \"#333\",\n          msg: level2Record.deptName\n        }];\n        $bus.emit(\"updateStructure\", breadList);\n        level2CheckedArr.value = [];\n      }\n      if (val === \"level3\") {\n        level3ProjectCode = record.projectNo;\n        level3Record = record;\n        let {\n          groupCustomerName,\n          customerName,\n          title\n        } = record;\n        let level3HeaderDataArr1 = level3HeaderContent.filter(item => item.title === groupCustomerName);\n        let level3HeaderDataArr2 = level3HeaderDataArr1 && level3HeaderDataArr1[0]?.children.filter(item => item.title === customerName);\n        let level3HeaderDataArr3 = level3HeaderDataArr2 && level3HeaderDataArr2[0]?.children.filter(item => item.title === title);\n        level3HeaderData.value = level3HeaderDataArr3 && level3HeaderDataArr3[0] || {};\n        level3Data(level3CheckedValue.value);\n        let breadList = [{\n          type: \"button\",\n          color: \"#5370FD\",\n          msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`,\n          params: \"level1\"\n        }, {\n          type: \"button\",\n          color: \"#5370FD\",\n          msg: level2Record.deptName,\n          params: \"level2\"\n        }, {\n          type: \"text\",\n          color: \"#333\",\n          msg: `项目： ${record.title}`\n        }];\n        $bus.emit(\"updateStructure\", breadList);\n      }\n    };\n    /***********************点击跳转下钻层级********************************** */\n\n    /*************************表格树结构展开切换******************************************** */\n    const expandedChange = rowKeys => {\n      tableInfo[currentLevel.value].defaultExpandedKeys = rowKeys;\n    };\n    /*************************表格树结构展开切换******************************************** */\n    const spinLoading = ref(false);\n    // 获取散点图数据\n    const getList = value => {\n      spinLoading.value = true;\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        projectCode: level3ProjectCode,\n        deptId: level2Record.id,\n        month,\n        tagKey: level3CheckedValue.value,\n        type: value\n      };\n      Array.isArray(columConfig.level2.params) && columConfig.level2.params.forEach(item => {\n        params[item] = encrypt(level3Record[item]);\n        if (level3Record[item] === undefined || level3Record[item] === null) {\n          params[item] = encrypt(0);\n        }\n      });\n      // 接口数据\n      queryScatterDiagram(params).then(res => {\n        if (res.code === \"200\") {\n          data.value = res.data;\n          // 每个点的样式\n          var itemStyle = {\n            //设置圆形的样式\n            shadowBlur: 10,\n            shadowColor: \"rgba(120, 36, 50, 0.5)\",\n            shadowOffsetY: 5\n          };\n          data.value.forEach(item => {\n            item.type = \"scatter\";\n            item.itemStyle = itemStyle;\n            item.symbolSize = 15;\n          });\n        }\n        if (value === 1) {\n          color.value = [\"#503e6a\", \"#fec42c\", \"#f96f0d\", \"#dd4444\"];\n        } else {\n          color.value = [\"#f6d91d\", \"#fec42c\", \"#fb954d\", \"#f6682c\", \"#f81313\", \"#7d1d07\"];\n        }\n      }).catch(e => {\n        Message.error(e.message || \"数据请求失败\");\n      }).finally(() => {\n        spinLoading.value = false;\n      });\n    };\n    // 更改颜色维度\n    const changeType = value => {\n      type.value = value;\n      getList(value);\n    };\n    //更改看图 列表\n    const changeDataType = value => {\n      dataType.value = value;\n    };\n\n    /**************** 设置角色******************** */\n    const level2CheckedArr = ref([]);\n    const level2CheckboxChange = (bool, record) => {\n      let index = level2CheckedArr.value.findIndex(item => item.id === record.id);\n      if (bool) {\n        if (level2CheckedArr.value.length > 0) {\n          if (index === -1) {\n            level2CheckedArr.value.push(toRaw(record));\n          }\n        } else {\n          level2CheckedArr.value.push(toRaw(record));\n        }\n      } else {\n        if (level2CheckedArr.value.length > 0) {\n          if (index !== -1) {\n            level2CheckedArr.value.splice(index, 1);\n          }\n        }\n      }\n    };\n    const setRoleModal = reactive({\n      visible: false,\n      selectOptions: [],\n      loading: false,\n      roles: [{\n        label: \"项目经理角色\",\n        value: undefined\n      }, {\n        label: \"收入上报角色\",\n        value: undefined\n      }, {\n        label: \"薪资异动上报角色\",\n        value: undefined\n      }, {\n        label: \"考勤上报角色\",\n        value: undefined\n      }],\n      confirmBtnLoading: false\n    });\n    const level2SetRole = async () => {\n      setRoleModal.visible = true;\n      let roleStaffInfoList = [];\n      let echoList = [];\n      setRoleModal.roles.forEach(item => {\n        item.value = undefined;\n      });\n      try {\n        let params1 = {\n          projectNo: level2CheckedArr.value.map(item => item.projectNo).toString()\n        };\n        let roleStaffInfoResult = await listByProjectNo(params1);\n        if (roleStaffInfoResult.code === \"200\") {\n          roleStaffInfoList = roleStaffInfoResult.data;\n        }\n      } catch (error) {\n        Message.error(\"请求数据失败\");\n      }\n      try {\n        setRoleModal.loading = true;\n        let params = {\n          deptName: level2Record.deptName\n        };\n        let res2 = await queryLikeDept(params);\n        if (res2.code === \"200\") {\n          setRoleModal.selectOptions = Array.isArray(res2.data) && markRaw(res2.data.map(item => {\n            roleStaffInfoList.forEach(jtem => {\n              if (item.id === jtem.empId) {\n                echoList.push({\n                  ...item,\n                  roleId: jtem.roleId\n                });\n              }\n            });\n            return {\n              value: JSON.stringify(item),\n              label: `${item.empName} ( ${item.empCode},  ${item.deptName} )`\n            };\n          })) || [];\n        }\n      } catch (error) {\n        Message.error(\"请求数据失败\");\n      }\n      if (level2CheckedArr.value.length > 1) {\n        setRoleModal.loading = false;\n        return;\n      }\n      if (echoList.length) {\n        setRoleModal.roles.forEach(item => {\n          let index = echoList.findIndex(jtem => jtem.roleId === item.label);\n          if (index !== -1) {\n            delete echoList[index].roleId;\n            item.value = JSON.stringify(echoList[index]);\n          }\n        });\n      } else {\n        setRoleModal.roles.forEach(item => {\n          item.value = undefined;\n        });\n      }\n      setRoleModal.loading = false;\n    };\n    const setRoleCancel = () => {\n      setRoleModal.roles.forEach(item => {\n        item.value = undefined;\n      });\n      setRoleModal.visible = false;\n    };\n    const setRoleOk = () => {\n      let emptyArr = [];\n      setRoleModal.roles.forEach(item => {\n        if (item.value === undefined || item.value === \"\") {\n          emptyArr.push(\" \");\n        }\n      });\n      if (emptyArr.length === setRoleModal.roles.length) return Message.error(\"至少选择一条\");\n      setRoleModal.confirmBtnLoading = true;\n      let selsected = [];\n      setRoleModal.roles.forEach(item => {\n        if (item.value !== undefined) {\n          try {\n            let value = JSON.parse(item.value);\n            selsected.push({\n              dept: value.deptName || \"\",\n              empId: value.id || \"\",\n              empNo: value.empCode || \"\",\n              empName: value.empName || \"\",\n              roleId: item.label\n            });\n          } catch (error) {\n            throw Error(error);\n          }\n        }\n      });\n      let params = {\n        projectNos: level2CheckedArr.value.map(item => item.projectNo),\n        info: selsected\n      };\n      save(params).then(res => {\n        if (res.code === \"200\") {\n          Message.success(res.desc || \"新建角色成功\");\n          level2CheckedArr.value = [];\n        } else {\n          Message.error(res.message || \"请求失败\");\n        }\n      }).catch(() => {\n        Message.error(\"请求失败\");\n      }).finally(() => {\n        setRoleModal.confirmBtnLoading = false;\n        setRoleModal.visible = false;\n      });\n    };\n    /**************** 设置角色******************** */\n    /************************ level1导出********************************** */\n    const level1ExportLoading = ref(false);\n    const level1ExportCurrentPage = () => {\n      level1ExportLoading.value = true;\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        month\n      };\n      bgExportExcel(params).then(res => {\n        const blob = new Blob([res]);\n        const fileReader = new FileReader();\n        fileReader.readAsText(res, \"utf-8\");\n        fileReader.onerror = function () {\n          Message.error(\"导出文件失败\");\n          return;\n        };\n        const fileName = `下钻分析_部门级别_${month}.xlsx`;\n        const link = document.createElement(\"a\");\n        link.download = fileName;\n        link.style.display = \"none\";\n        link.href = URL.createObjectURL(blob);\n        document.body.appendChild(link);\n        link.click();\n        URL.revokeObjectURL(link.href);\n        document.body.removeChild(link);\n      }).catch(() => {\n        Message.error(\"导出失败\");\n      }).finally(() => {\n        level1ExportLoading.value = false;\n      });\n    };\n    /************************ level1导出********************************** */\n\n    /************************ level1导出全部********************************** */\n    const level1ExportAllLoading = ref(false);\n    const level1ExportAll = () => {\n      level1ExportAllLoading.value = true;\n      Message.loading(\"下载时间较长，请耐心等待\");\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        month\n      };\n      downAllExcel(params).then(res => {\n        const blob = new Blob([res]);\n        const fileName = `下钻分析_全部_${month}.xlsx`;\n        const link = document.createElement(\"a\");\n        link.download = fileName;\n        link.style.display = \"none\";\n        link.href = URL.createObjectURL(blob);\n        document.body.appendChild(link);\n        link.click();\n        URL.revokeObjectURL(link.href);\n        document.body.removeChild(link);\n      }).catch(() => {\n        Message.error(\"导出失败\");\n      }).finally(() => {\n        level1ExportAllLoading.value = false;\n      });\n    };\n\n    /************************ level1导出全部********************************** */\n\n    /************************ level2导出********************************** */\n    const level2ExportLoading = ref(false);\n    const level2ExportAll = () => {\n      level2ExportLoading.value = true;\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        deptId: level2Record.id,\n        month,\n        deptName: level2Record.deptName,\n        tagKey: level2CheckedValue.value\n      };\n      Array.isArray(columConfig.level1.params) && columConfig.level1.params.forEach(item => {\n        params[item] = encrypt(level2Record[item]);\n        if (level2Record[item] === undefined || level2Record[item] === null) {\n          params[item] = encrypt(0);\n        }\n      });\n      cuPoExportExcel(params).then(res => {\n        const blob = new Blob([res]);\n        const fileName = `下钻分析_客户项目级别_${month}.xlsx`;\n        const link = document.createElement(\"a\");\n        link.download = fileName;\n        link.style.display = \"none\";\n        link.href = URL.createObjectURL(blob);\n        document.body.appendChild(link);\n        link.click();\n        URL.revokeObjectURL(link.href);\n        document.body.removeChild(link);\n      }).catch(() => {\n        Message.error(\"导出失败\");\n      }).finally(() => {\n        level2ExportLoading.value = false;\n      });\n    };\n\n    /************************ level2导出********************************** */\n\n    /**************** levle3导出本页****************** */\n    const level3ExportLoading = ref(false);\n    const level3Export = () => {\n      level3ExportLoading.value = true;\n      let mon = dateNow.value + \"\";\n      let month = mon.replaceAll(\"-\", \"\");\n      let params = {\n        projectCode: level3ProjectCode,\n        deptId: level2Record.id,\n        month,\n        tagKey: level3CheckedValue.value,\n        deptName: level2Record.deptName,\n        groupCustomer: level3HeaderData.value.groupCustomerName + \"\",\n        customer: level3HeaderData.value.customerName + \"\",\n        projectName: level3HeaderData.value.title + \"\"\n      };\n      Array.isArray(columConfig.level2.params) && columConfig.level2.params.forEach(item => {\n        params[item] = encrypt(level3Record[item]);\n        if (level3Record[item] === undefined || level3Record[item] === null) {\n          params[item] = encrypt(0);\n        }\n      });\n      empExportExcel(params).then(res => {\n        const blob = new Blob([res]);\n        const fileName = `下钻分析_人员级别_${month}.xlsx`;\n        const link = document.createElement(\"a\");\n        link.download = fileName;\n        link.style.display = \"none\";\n        link.href = URL.createObjectURL(blob);\n        document.body.appendChild(link);\n        link.click();\n        URL.revokeObjectURL(link.href);\n        document.body.removeChild(link);\n      }).catch(() => {\n        Message.error(\"导出失败\");\n      }).finally(() => {\n        level3ExportLoading.value = false;\n      });\n    };\n    /**************** levle3导出本页****************** */\n\n    /****************** 集团/客户/项目详情***************************** */\n    const blocInfoModal = reactive({\n      visible: false,\n      tableColumns: [{\n        title: \"客户名称\",\n        dataIndex: \"customerName\",\n        width: 294,\n        headerCellStyle: {\n          background: \"#F7F8FF\",\n          color: \"#78797B\"\n        },\n        cellStyle: {\n          color: \"#7B7B7B\"\n        }\n      }, {\n        title: \"行业\",\n        dataIndex: \"industry\",\n        width: 82,\n        headerCellStyle: {\n          background: \"#F7F8FF\",\n          color: \"#78797B\"\n        },\n        cellStyle: {\n          color: \"#7B7B7B\"\n        }\n      }, {\n        title: \"地址\",\n        dataIndex: \"adress\",\n        width: 330,\n        headerCellStyle: {\n          background: \"#F7F8FF\",\n          color: \"#78797B\"\n        },\n        cellStyle: {\n          color: \"#7B7B7B\"\n        }\n      }],\n      tableData: [{\n        customerName: \"三星半导体(中国)研究开发有限公司北京分公司\",\n        industry: \"通信\",\n        adress: \"北京市朝阳区北京市朝阳区太阳宫中路冠捷大厦8层\",\n        key: 1\n      }]\n    });\n    const blocInfoModalOk = () => {\n      blocInfoModal.visible = false;\n    };\n    const customerModal = reactive({\n      visible: false,\n      basicColumn: 2,\n      basicData: [{\n        label: \"客户名称\",\n        value: \"广州三星通信技术研究有限公司\"\n      }, {\n        label: \"集团客户名称\",\n        value: \"集团客户-三星\"\n      }, {\n        label: \"行业\",\n        value: \"信息技术\"\n      }, {\n        label: \"开始合作时间\",\n        value: \"2022-22-01\"\n      }, {\n        label: \"区域\",\n        value: \"大中华区\"\n      }, {\n        label: \"地址\",\n        value: \"广东省广州市黄埔区黄埔区科学城科学大道185号\"\n      }],\n      staffColumn: 2,\n      staffData: [{\n        label: \"销售人员\",\n        value: \"鲍雪欣\"\n      }, {\n        label: \"销售人员部门\",\n        value: \"BG2-STA-ERIREG_S\"\n      }]\n    });\n    const projectModal = reactive({\n      visible: false,\n      basicColumn: 2,\n      basicData: [{\n        label: \"客户名称\",\n        value: \"广州三星通信技术研究有限公司\"\n      }, {\n        label: \"集团客户名称\",\n        value: \"集团客户-三星\"\n      }, {\n        label: \"行业\",\n        value: \"信息技术\"\n      }, {\n        label: \"开始合作时间\",\n        value: \"2022-22-01\"\n      }, {\n        label: \"区域\",\n        value: \"大中华区\"\n      }, {\n        label: \"地址\",\n        value: \"广东省广州市黄埔区黄埔区科学城科学大道185号\"\n      }],\n      staffColumn: 2,\n      staffData: [{\n        label: \"所属部门\",\n        value: \"BG1-MSD\"\n      }, {\n        label: \"部门负责人\",\n        value: \"金迪\"\n      }],\n      manageColumn: 2,\n      manageData: [{\n        label: \"税率\",\n        value: \" 6%\"\n      }, {\n        label: \"预估毛利率\",\n        value: \"50\"\n      }, {\n        label: \"结算周期(天)\",\n        value: \" 90\"\n      }, {\n        label: \"回款周期(天)\",\n        value: \"90\"\n      }]\n    });\n    /****************** 集团/客户/项目详情***************************** */\n\n    const __returned__ = {\n      get $bus() {\n        return $bus;\n      },\n      set $bus(v) {\n        $bus = v;\n      },\n      level3TabSelect,\n      get level3HeaderContent() {\n        return level3HeaderContent;\n      },\n      set level3HeaderContent(v) {\n        level3HeaderContent = v;\n      },\n      get tagColumnList() {\n        return tagColumnList;\n      },\n      set tagColumnList(v) {\n        tagColumnList = v;\n      },\n      get level3ProjectCode() {\n        return level3ProjectCode;\n      },\n      set level3ProjectCode(v) {\n        level3ProjectCode = v;\n      },\n      get level2Record() {\n        return level2Record;\n      },\n      set level2Record(v) {\n        level2Record = v;\n      },\n      get level3Record() {\n        return level3Record;\n      },\n      set level3Record(v) {\n        level3Record = v;\n      },\n      get columConfig() {\n        return columConfig;\n      },\n      set columConfig(v) {\n        columConfig = v;\n      },\n      typeList,\n      type,\n      data,\n      color,\n      dataType,\n      disabledDateFn,\n      level3HeaderData,\n      columns,\n      currentLevel,\n      get year() {\n        return year;\n      },\n      set year(v) {\n        year = v;\n      },\n      get month() {\n        return month;\n      },\n      set month(v) {\n        month = v;\n      },\n      get currentDate() {\n        return currentDate;\n      },\n      set currentDate(v) {\n        currentDate = v;\n      },\n      dateNow,\n      currentMonthDay,\n      getCurrentMonthWorkday,\n      level1CheckedValue,\n      level1RadioDisabled,\n      level2CheckedValue,\n      level2RadioDisabled,\n      level3CheckedValue,\n      level3RadioDisabled,\n      tableInfo,\n      level1tableRef,\n      level2tableRef,\n      level3tableRef,\n      monthPickChange,\n      rowClass,\n      level3RadioCheckedChange,\n      level1Data,\n      get level2keys() {\n        return level2keys;\n      },\n      set level2keys(v) {\n        level2keys = v;\n      },\n      expandAllRows,\n      level2Data,\n      level3Data,\n      radioCheckedChange,\n      level2RadioCheckedChange,\n      jump,\n      expandedChange,\n      spinLoading,\n      getList,\n      changeType,\n      changeDataType,\n      level2CheckedArr,\n      level2CheckboxChange,\n      setRoleModal,\n      level2SetRole,\n      setRoleCancel,\n      setRoleOk,\n      level1ExportLoading,\n      level1ExportCurrentPage,\n      level1ExportAllLoading,\n      level1ExportAll,\n      level2ExportLoading,\n      level2ExportAll,\n      level3ExportLoading,\n      level3Export,\n      blocInfoModal,\n      blocInfoModalOk,\n      customerModal,\n      projectModal,\n      onBeforeMount,\n      reactive,\n      ref,\n      watchEffect,\n      nextTick,\n      toRaw,\n      onUnmounted,\n      markRaw,\n      get Message() {\n        return Message;\n      },\n      scatterPlot,\n      get useTagColumnListStore() {\n        return useTagColumnListStore;\n      },\n      get queryCoreData() {\n        return queryCoreData;\n      },\n      get queryDownDrillSecond() {\n        return queryDownDrillSecond;\n      },\n      get queryDownDrillThird() {\n        return queryDownDrillThird;\n      },\n      get countWorkdaysByMonth() {\n        return countWorkdaysByMonth;\n      },\n      get queryScatterDiagram() {\n        return queryScatterDiagram;\n      },\n      get listByProjectNo() {\n        return listByProjectNo;\n      },\n      get queryLikeDept() {\n        return queryLikeDept;\n      },\n      get save() {\n        return save;\n      },\n      get empExportExcel() {\n        return empExportExcel;\n      },\n      get bgExportExcel() {\n        return bgExportExcel;\n      },\n      get cuPoExportExcel() {\n        return cuPoExportExcel;\n      },\n      get downAllExcel() {\n        return downAllExcel;\n      },\n      get number2percentage() {\n        return number2percentage;\n      },\n      get toInteger() {\n        return toInteger;\n      },\n      get dataAddKey() {\n        return dataAddKey;\n      },\n      get getCurrentDate() {\n        return getCurrentDate;\n      },\n      get encrypt() {\n        return encrypt;\n      },\n      get getCurrentInstance() {\n        return getCurrentInstance;\n      },\n      get moment() {\n        return moment;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"mappings":"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","names":["onBeforeMount","reactive","ref","watchEffect","nextTick","toRaw","onUnmounted","markRaw","Message","scatterPlot","useTagColumnListStore","queryCoreData","queryDownDrillSecond","queryDownDrillThird","countWorkdaysByMonth","queryScatterDiagram","listByProjectNo","queryLikeDept","save","empExportExcel","bgExportExcel","cuPoExportExcel","downAllExcel","number2percentage","toInteger","dataAddKey","getCurrentDate","encrypt","getCurrentInstance","moment","$bus","appContext","config","globalProperties","level3TabSelect","level3HeaderContent","tagColumnList","level3ProjectCode","level2Record","level3Record","columConfig","typeList","label","value","type","data","color","dataType","disabledDateFn","current","valueOf","level3HeaderData","columns","tagColumns","getTagColumnList","currentPageColumn","filter","item","report","length","tier","forEach","index","tabs","tags","jtem","push","tag","columnItem","ktem","col","conf","title","columnItemConfig","dataIndex","align","cellStyle","cellAlign","width","ellipsis","headerCellClass","slotName","titleSlotName","fixed","undefined","toFixed","showPercent","render","record","isRed","key","params","level1","level2","level3","level1CheckedValue","level2CheckedValue","level3CheckedValue","tableInfo","currentLevel","year","month","currentDate","dateNow","currentMonthDay","getCurrentMonthWorkday","console","log","then","res","code","catch","error","level1RadioDisabled","level2RadioDisabled","level3RadioDisabled","loading","defaultExpandedKeys","maxHeight","level1tableRef","level2tableRef","level3tableRef","monthPickChange","level1Data","rowClass","raw","deptLevel","level3RadioCheckedChange","val","level3Data","tagKey","keys","id","head","$el","elHeight","getBoundingClientRect","top","innerHeight","window","layoutContent","document","getElementById","diff","scrollHeight","offsetHeight","parseInt","desc","err","message","finally","level2keys","expandAllRows","arr","children","level2Data","emit","mon","replaceAll","deptId","Array","isArray","projectCode","getList","radioCheckedChange","level2RadioCheckedChange","msg","format","on","breadList1","breadList2","deptName","off","jump","breadList","level2CheckedArr","projectNo","groupCustomerName","customerName","level3HeaderDataArr1","level3HeaderDataArr2","level3HeaderDataArr3","expandedChange","rowKeys","spinLoading","itemStyle","shadowBlur","shadowColor","shadowOffsetY","symbolSize","e","changeType","changeDataType","level2CheckboxChange","bool","findIndex","splice","setRoleModal","visible","selectOptions","roles","confirmBtnLoading","level2SetRole","roleStaffInfoList","echoList","params1","map","toString","roleStaffInfoResult","res2","empId","roleId","JSON","stringify","empName","empCode","setRoleCancel","setRoleOk","emptyArr","selsected","parse","dept","empNo","Error","projectNos","info","success","level1ExportLoading","level1ExportCurrentPage","blob","Blob","fileReader","FileReader","readAsText","onerror","fileName","link","createElement","download","style","display","href","URL","createObjectURL","body","appendChild","click","revokeObjectURL","removeChild","level1ExportAllLoading","level1ExportAll","level2ExportLoading","level2ExportAll","level3ExportLoading","level3Export","groupCustomer","customer","projectName","blocInfoModal","tableColumns","headerCellStyle","background","tableData","industry","adress","blocInfoModalOk","customerModal","basicColumn","basicData","staffColumn","staffData","projectModal","manageColumn","manageData"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-oms-frontend/src/views/LeanAnalyze/drillAnalyze.vue"],"sourcesContent":["<template>\n  <div v-show=\"currentLevel === 'level1'\" class=\"defaultPadding\">\n    <div class=\"m-b-26 flex-between\">\n      <div class=\"flex m-r-24\">\n        <div class=\"m-r-24\">\n          月份：\n          <a-month-picker\n            v-model=\"dateNow\"\n            style=\"width: 120px; border-radius: 4px\"\n            :allow-clear=\"false\"\n            :disabledDate=\"disabledDateFn\"\n            @change=\"monthPickChange\"\n          />\n        </div>\n        <a-radio-group\n          type=\"button\"\n          size=\"large\"\n          v-model=\"level1CheckedValue\"\n          @change=\"radioCheckedChange\"\n          :disabled=\"level1RadioDisabled\"\n        >\n          <a-radio v-for=\"item of tableInfo.level1.tabs\" :value=\"item.key\">{{ item.name }}</a-radio>\n        </a-radio-group>\n      </div>\n      <a-space>\n        <a-popconfirm content=\"确定导出全部吗?\" @ok=\"level1ExportAll\">\n          <a-button type=\"outline\" :loading=\"level1ExportAllLoading\" style=\"border-radius: 4px\">\n            <template #icon>\n              <icon-download />\n            </template>\n            <template #default>导出全部</template>\n          </a-button>\n        </a-popconfirm>\n        <a-popconfirm content=\"确定导出本页吗?\" @ok=\"level1ExportCurrentPage\">\n          <a-button type=\"primary\" :loading=\"level1ExportLoading\" style=\"border-radius: 4px\">\n            <template #icon>\n              <icon-download />\n            </template>\n            <template #default>导出本页</template>\n          </a-button>\n        </a-popconfirm>\n      </a-space>\n    </div>\n    <a-table\n      :row-class=\"rowClass\"\n      :columns=\"tableInfo.level1.columns[level1CheckedValue] || []\"\n      :data=\"tableInfo.level1.data\"\n      :bordered=\"false\"\n      column-resizable\n      :expanded-keys=\"tableInfo.level1.defaultExpandedKeys\"\n      :scroll=\"{ maxHeight: tableInfo.level1.maxHeight }\"\n      :scrollbar=\"false\"\n      :pagination=\"false\"\n      :loading=\"tableInfo.loading\"\n      ref=\"level1tableRef\"\n      @expanded-change=\"expandedChange\"\n    >\n      <template #lastDeptName=\"{ record }\">\n        <a-popover\n          v-if=\"currentLevel === 'level1'\"\n          :content-style=\"{ background: 'rgba(0,0,0,.8)', color: '#fff' }\"\n          :arrow-style=\"{ background: 'rgba(0,0,0,.8)' }\"\n        >\n          <a href=\"javaScript:void(0)\" v-if=\"record.leafNode === '1'\" style=\"color: #165dff\" @click=\"jump('level2', record)\">\n            {{ record.lastDeptName }}\n          </a>\n          <span class=\"pointer\" v-else>{{ record.lastDeptName }}</span>\n          <template #content>\n            {{ record.deptName }}\n          </template>\n        </a-popover>\n      </template>\n      <template #columTitleSlot=\"{ column }\">\n        <a-tooltip style=\"width: max-content\" :content=\"column.title\">\n          <a href=\"javaScript:void(0)\" style=\"color: #333\">{{ column.title }}</a>\n        </a-tooltip>\n      </template>\n      <template #empty>\n        <a-empty />\n      </template>\n    </a-table>\n  </div>\n  <div v-show=\"currentLevel === 'level2'\" class=\"defaultPadding\">\n    <div class=\"m-b-26 flex-between\">\n      <div class=\"m-r-24\">\n        <a-radio-group\n          type=\"button\"\n          size=\"large\"\n          v-model=\"level2CheckedValue\"\n          @change=\"level2RadioCheckedChange\"\n          :disabled=\"level2RadioDisabled\"\n        >\n          <a-radio v-for=\"item of tableInfo.level2.tabs\" :value=\"item.key\">{{ item.name }}</a-radio>\n        </a-radio-group>\n      </div>\n      <div>\n        <a-button\n          type=\"outline\"\n          :disabled=\"level2CheckedArr.length === 0\"\n          style=\"border-radius: 4px\"\n          class=\"m-r-24\"\n          @click=\"level2SetRole\"\n        >\n          <template #icon>\n            <icon-user />\n          </template>\n          <template #default>设置角色</template>\n        </a-button>\n        <a-popconfirm content=\"确定导出本页吗?\" @ok=\"level2ExportAll\">\n          <a-button type=\"primary\" :loading=\"level2ExportLoading\" style=\"border-radius: 4px\">\n            <template #icon>\n              <icon-download />\n            </template>\n            <template #default>导出本页</template>\n          </a-button>\n        </a-popconfirm>\n      </div>\n    </div>\n    <a-table\n      :row-class=\"rowClass\"\n      :columns=\"tableInfo.level2.columns[level2CheckedValue] || []\"\n      :data=\"tableInfo.level2.data\"\n      :bordered=\"false\"\n      column-resizable\n      :expanded-keys=\"tableInfo.level2.defaultExpandedKeys\"\n      :scroll=\"{ maxHeight: tableInfo.level2.maxHeight }\"\n      :scrollbar=\"false\"\n      :pagination=\"false\"\n      :loading=\"tableInfo.loading\"\n      ref=\"level2tableRef\"\n      @expanded-change=\"expandedChange\"\n    >\n      <template #title=\"{ record }\">\n        <a-checkbox\n          class=\"m-r-8\"\n          style=\"vertical-align: middle\"\n          v-if=\"record.leafNode === '1'\"\n          :model-value=\"level2CheckedArr.length > 0 && level2CheckedArr.findIndex(item => item.id === record.id) !== -1\"\n          @change=\"level2CheckboxChange($event, record)\"\n        />\n        <a-popover\n          v-if=\"currentLevel === 'level2'\"\n          :content-style=\"{ background: 'rgba(0,0,0,.8)', color: '#fff' }\"\n          :arrow-style=\"{ background: 'rgba(0,0,0,.8)' }\"\n        >\n          <a href=\"javaScript:void(0)\" v-if=\"record.leafNode === '1'\" style=\"color: #165dff\" @click=\"jump('level3', record)\">\n            {{ record.title }}\n          </a>\n          <span class=\"pointer\" v-else>{{ record.title }}</span>\n          <template #content>\n            {{ record.title }}\n          </template>\n        </a-popover>\n      </template>\n      <template #empty>\n        <a-empty />\n      </template>\n    </a-table>\n  </div>\n  <div v-show=\"currentLevel === 'level3'\">\n    <div class=\"level3Header\">\n      <div class=\"w-perct-80\">\n        <a-space wrap :size=\"[20, 0]\">\n          <div class=\"item\">\n            <span>项目营业收入：</span>\n            {{ toInteger(level3HeaderData.colNo5, 0) }}\n          </div>\n          <div class=\"item\">\n            <span>项目销售毛利：</span>\n            {{ toInteger(level3HeaderData.colNo8, 0) }}\n          </div>\n          <div class=\"item\">\n            <span>项目销售毛利率：</span>\n            {{ number2percentage(level3HeaderData.colNo9, 2) }}\n          </div>\n          <div class=\"item\">\n            <span>项目C1总人数：</span>\n            {{ toInteger(level3HeaderData.colNo1, 0) }}\n          </div>\n          <div class=\"item\">\n            <span>项目人员利用率：</span>\n            {{ number2percentage(level3HeaderData.colNo3, 2) }}\n          </div>\n        </a-space>\n      </div>\n      <div>\n        <a-radio-group type=\"button\" size=\"large\" v-model:model-value=\"level3TabSelect\" @change=\"changeDataType\">\n          <a-radio value=\"list\">列表</a-radio>\n          <a-radio value=\"chart\">看图</a-radio>\n        </a-radio-group>\n      </div>\n    </div>\n    <div class=\"defaultPadding\" v-if=\"dataType == 'list'\">\n      <div class=\"m-b-20\">\n        集团/客户/项目 :\n        {{ level3HeaderData.groupCustomerName + \" / \" + level3HeaderData.customerName + \" / \" + level3HeaderData.title }}\n        <!-- <a href=\"javaScript:void(0)\" style=\"color: #165dff\">\n          {{ level3HeaderData.groupCustomerName }}\n        </a>\n        /\n        <a href=\"javaScript:void(0)\" style=\"color: #165dff\">\n          {{ level3HeaderData.customerName }}\n        </a>\n        /\n        <a href=\"javaScript:void(0)\" style=\"color: #165dff\">\n          {{ level3HeaderData.title }}\n        </a> -->\n      </div>\n      <div class=\"m-b-20 flex-between\">\n        <div>\n          <a-radio-group\n            type=\"button\"\n            size=\"large\"\n            v-model=\"level3CheckedValue\"\n            :disabled=\"level3RadioDisabled\"\n            @change=\"level3RadioCheckedChange\"\n          >\n            <a-radio v-for=\"item of tableInfo.level3.tabs\" :value=\"item.key\">{{ item.name }}</a-radio>\n          </a-radio-group>\n        </div>\n        <div>\n          <a-space>\n            <a-popconfirm content=\"确定导出本页吗?\" @ok=\"level3Export\">\n              <a-button type=\"primary\" class=\"m-l-14\" :loading=\"level3ExportLoading\">\n                <template #icon>\n                  <icon-export />\n                </template>\n                <template #default>导出本页</template>\n              </a-button>\n            </a-popconfirm>\n          </a-space>\n        </div>\n      </div>\n      <a-table\n        :row-class=\"rowClass\"\n        :columns=\"tableInfo.level3.columns[level3CheckedValue] || []\"\n        :data=\"tableInfo.level3.data\"\n        :bordered=\"false\"\n        column-resizable\n        :expanded-keys=\"tableInfo.level3.defaultExpandedKeys\"\n        :scroll=\"{ maxHeight: tableInfo.level3.maxHeight }\"\n        :scrollbar=\"false\"\n        :pagination=\"false\"\n        :loading=\"tableInfo.loading\"\n        ref=\"level3tableRef\"\n        @expanded-change=\"expandedChange\"\n      >\n        <template #position=\"{ record }\">\n          <a-popover\n            v-if=\"currentLevel === 'level3'\"\n            :content-style=\"{ background: 'rgba(0,0,0,.8)', color: '#fff' }\"\n            :arrow-style=\"{ background: 'rgba(0,0,0,.8)' }\"\n          >\n            <span class=\"pointer\">{{ record.position }}</span>\n            <template #content>\n              {{ record.position }}\n            </template>\n          </a-popover>\n        </template>\n        <template #empty>\n          <a-empty />\n        </template>\n      </a-table>\n    </div>\n    <div v-if=\"dataType == 'chart'\">\n      <a-space class=\"chartSelect\">\n        <span>颜色维度：</span>\n        <a-select v-model=\"type\" placeholder=\"请选择\" @change=\"changeType\" style=\"width: 120px\">\n          <a-option v-for=\"item in typeList\" :value=\"item.label\" :key=\"item.label\">{{ item.value }}</a-option>\n        </a-select>\n        <a-tooltip style=\"width: max-content\">\n          <template #content>\n            <div>选项说明:</div>\n            <div>1、出勤=月实际工时天数+法定节假日-实际发薪天数</div>\n          </template>\n          <icon-info-circle-fill size=\"20\" style=\"color: #a9aeb8\" />\n        </a-tooltip>\n      </a-space>\n      <a-spin :loading=\"spinLoading\" tip=\"正在加载...\" style=\"display: block\">\n        <scatterPlot :seriesData=\"data\" :color=\"color\" />\n      </a-spin>\n    </div>\n  </div>\n  <a-modal v-model:visible=\"setRoleModal.visible\" width=\"680px\" title-align=\"start\">\n    <template #title>\n      <span class=\"modal-title\">设置项目行为角色</span>\n    </template>\n    <div class=\"flex-center\">\n      <a-spin :loading=\"setRoleModal.loading\" tip=\"数据加载中。。。\">\n        <a-space direction=\"vertical\" :size=\"24\">\n          <div v-for=\"(item, index) of setRoleModal.roles\" :key=\"index\">\n            <span class=\"modal-label\">{{ item.label }}：</span>\n            <a-select\n              :options=\"setRoleModal.selectOptions\"\n              :style=\"{ width: '378px' }\"\n              placeholder=\"输入并选择项目经理角色\"\n              v-model:model-value=\"item.value\"\n              allow-search\n              :virtual-list-props=\"{ height: 200 }\"\n            >\n              <template #arrow-icon>\n                <icon-down />\n              </template>\n            </a-select>\n          </div>\n        </a-space>\n      </a-spin>\n    </div>\n    <template #footer>\n      <div class=\"text-center\">\n        <a-button type=\"outline\" class=\"m-r-24\" :disabled=\"setRoleModal.loading\" @click=\"setRoleCancel\">取消</a-button>\n        <a-button type=\"primary\" :disabled=\"setRoleModal.loading\" :loading=\"setRoleModal.confirmBtnLoading\" @click=\"setRoleOk\">\n          确定\n        </a-button>\n      </div>\n    </template>\n  </a-modal>\n  <a-modal v-model:visible=\"blocInfoModal.visible\" width=\"760px\" title-align=\"start\">\n    <template #title>\n      <span class=\"modal-title\">详情-集团客户</span>\n    </template>\n    <div>\n      <div class=\"blocInfoModal-content-title\">集团客户名称：集团客户-三星</div>\n      <a-table\n        :columns=\"blocInfoModal.tableColumns\"\n        :data=\"blocInfoModal.tableData\"\n        :bordered=\"{ cell: true }\"\n        :pagination=\"false\"\n      ></a-table>\n    </div>\n    <template #footer>\n      <div class=\"text-center\">\n        <a-button type=\"primary\" @click=\"blocInfoModalOk\">知道了</a-button>\n      </div>\n    </template>\n  </a-modal>\n  <a-modal v-model:visible=\"customerModal.visible\" width=\"784px\" title-align=\"start\">\n    <template #title>\n      <span class=\"modal-title\">详情-客户</span>\n    </template>\n    <div class=\"m-b-30\">\n      <div class=\"customerModal-content-title\">基本信息</div>\n      <a-descriptions\n        :column=\"customerModal.basicColumn\"\n        :data=\"customerModal.basicData\"\n        :value-style=\"{ color: '#7B7B7B', fonSize: '14px' }\"\n        bordered\n      />\n    </div>\n    <div>\n      <div class=\"customerModal-content-title\">人员信息</div>\n      <a-descriptions\n        :column=\"customerModal.staffColumn\"\n        :data=\"customerModal.staffData\"\n        :value-style=\"{ color: '#7B7B7B', fonSize: '14px' }\"\n        bordered\n      />\n    </div>\n    <template #footer>\n      <div class=\"text-center\">\n        <a-button type=\"primary\">知道了</a-button>\n      </div>\n    </template>\n  </a-modal>\n  <a-modal v-model:visible=\"projectModal.visible\" width=\"784px\" title-align=\"start\">\n    <template #title>\n      <span class=\"modal-title\">详情-项目</span>\n    </template>\n    <div class=\"m-b-30\">\n      <div class=\"customerModal-content-title\">基本信息</div>\n      <a-descriptions\n        :column=\"projectModal.basicColumn\"\n        :data=\"projectModal.basicData\"\n        :value-style=\"{ color: '#7B7B7B', fonSize: '14px' }\"\n        bordered\n      />\n    </div>\n    <div class=\"m-b-30\">\n      <div class=\"customerModal-content-title\">人员信息</div>\n      <a-descriptions\n        :column=\"projectModal.staffColumn\"\n        :data=\"projectModal.staffData\"\n        :value-style=\"{ color: '#7B7B7B', fonSize: '14px' }\"\n        bordered\n      />\n    </div>\n    <div>\n      <div class=\"customerModal-content-title\">经营信息</div>\n      <a-descriptions\n        :column=\"projectModal.manageColumn\"\n        :data=\"projectModal.manageData\"\n        :value-style=\"{ color: '#7B7B7B', fonSize: '14px' }\"\n        bordered\n      />\n    </div>\n    <template #footer>\n      <div class=\"text-center\">\n        <a-button type=\"primary\">知道了</a-button>\n      </div>\n    </template>\n  </a-modal>\n</template>\n\n<script setup>\nimport { onBeforeMount, reactive, ref, watchEffect, nextTick, toRaw, onUnmounted, markRaw } from \"vue\";\nimport { Message } from \"@arco-design/web-vue\";\nimport scatterPlot from \"@/components/scatterPlot.vue\";\nimport { useTagColumnListStore } from \"../../store/index\";\nimport {\n  queryCoreData,\n  queryDownDrillSecond,\n  queryDownDrillThird,\n  countWorkdaysByMonth,\n  queryScatterDiagram,\n  listByProjectNo,\n  queryLikeDept,\n  save,\n  empExportExcel,\n  bgExportExcel,\n  cuPoExportExcel,\n  downAllExcel,\n} from \"../../api/drillAnalyze\";\nimport { number2percentage, toInteger, dataAddKey, getCurrentDate, encrypt } from \"../../utils/util\";\nimport { getCurrentInstance } from \"@vue/runtime-core\";\nimport moment from \"moment\";\n\nlet $bus = getCurrentInstance().appContext.config.globalProperties.$bus;\n\n// 第三层tab\nconst level3TabSelect = ref(\"list\");\nlet level3HeaderContent = [];\n/************* 下钻分析列信息************** */\nlet tagColumnList = useTagColumnListStore();\nlet level3ProjectCode = \"\"; //下钻三层的项目编码\n\nlet level2Record = {}; //点击下钻时的数据\nlet level3Record = {};\nlet columConfig = {};\n// 颜色维度列表\nconst typeList = ref([\n  {\n    label: 1,\n    value: \"出勤\",\n  },\n  {\n    label: 2,\n    value: \"入职日期\",\n  },\n]);\n// 颜色维度\nconst type = ref(1);\n// 数据\nconst data = ref([]);\n// 颜色种类\nconst color = ref([]);\n// 看图 & 列表\nconst dataType = ref(\"list\");\n\n//禁止选择2022(含)年之前的月份\nconst disabledDateFn = current => {\n  return current.valueOf() < moment(\"2023-01-01 00:00:00\").valueOf();\n};\nconst level3HeaderData = ref({});\nconst columns = () => {\n  let tagColumns = toRaw(tagColumnList.getTagColumnList) || [];\n  let currentPageColumn = tagColumns.filter(item => item.report === \"下钻分析\") || [];\n  if (currentPageColumn.length) {\n    currentPageColumn[0].tier.forEach((item, index) => {\n      let tabs = [];\n      let currentPageColumn = {};\n      item.tags.forEach(jtem => {\n        tabs.push(jtem.tag);\n        let columnItem = [];\n        jtem.columns.forEach(ktem => {\n          let { col, conf, title } = ktem;\n          conf = conf || {};\n          let columnItemConfig = {\n            title,\n            dataIndex: col,\n            align: conf.align,\n            cellStyle: { \"text-align\": conf.cellAlign },\n            width: conf.width,\n            ellipsis: true,\n            headerCellClass: \"noEllipsis\",\n            slotName: col,\n            titleSlotName: \"columTitleSlot\",\n          };\n          if (conf.fixed !== undefined) {\n            columnItemConfig.fixed = conf.fixed;\n          }\n          if (conf.toFixed !== undefined) {\n            if (conf.showPercent) {\n              columnItemConfig.render = ({ record }) => {\n                return <span innerHTML={number2percentage(record[col], conf.toFixed, conf.isRed)}></span>;\n              };\n            } else {\n              columnItemConfig.render = ({ record }) => {\n                return <span innerHTML={toInteger(record[col], conf.toFixed, conf.isRed)}></span>;\n              };\n            }\n          }\n          columnItem.push(columnItemConfig);\n        });\n        currentPageColumn[jtem.tag.key] = columnItem;\n      });\n      columConfig[\"level\" + (index + 1)] = {\n        tabs,\n        params: item.params || [],\n        columns: currentPageColumn,\n      };\n    });\n  }\n  let { level1, level2, level3 } = columConfig;\n  level1CheckedValue.value = level1.tabs[0].key;\n  level2CheckedValue.value = level2.tabs[1].key;\n  level3CheckedValue.value = level3.tabs[1].key;\n  tableInfo.level1.tabs = level1.tabs;\n  tableInfo.level1.columns = level1.columns;\n  tableInfo.level2.tabs = level2.tabs;\n  tableInfo.level2.columns = level2.columns;\n  tableInfo.level3.tabs = level3.tabs;\n  tableInfo.level3.columns = level3.columns;\n};\n/************* 下钻分析列信息************** */\n\n/***************获取当前月份********************* */\nconst currentLevel = ref(\"level1\"); //level2,level3\nlet { year, month } = getCurrentDate();\nlet currentDate = `${year}-${month}`;\nconst dateNow = ref(currentDate);\n\n/***************获取当前月份********************* */\n\n/****************** 获取当月工作日天数************************** */\nconst currentMonthDay = ref(0);\nconst getCurrentMonthWorkday = () => {\n  const params = {\n    month: dateNow.value,\n  };\n  console.log(params,'params');\n  countWorkdaysByMonth(params)\n    .then(res => {\n      if (res.code === \"200\") {\n        currentMonthDay.value = res.data;\n      }\n    })\n    .catch(() => {\n      Message.error(\"请求失败\");\n    });\n};\n\n/****************** 标签表格配置信息************************** */\nconst level1CheckedValue = ref(\"coreData\");\nconst level1RadioDisabled = ref(true);\nconst level2CheckedValue = ref(\"coreData2\");\nconst level2RadioDisabled = ref(true);\nconst level3CheckedValue = ref(\"empInfo\");\nconst level3RadioDisabled = ref(true);\n\nconst tableInfo = reactive({\n  loading: false,\n  level1: {\n    tabs: [],\n    columns: {},\n    data: [],\n    defaultExpandedKeys: [],\n    maxHeight: \"200px\",\n  },\n  level2: {\n    tabs: [],\n    columns: {},\n    data: [],\n    defaultExpandedKeys: [],\n    maxHeight: \"200px\",\n  },\n  level3: {\n    tabs: [],\n    columns: {},\n    data: [],\n    defaultExpandedKeys: [],\n    maxHeight: \"200px\",\n  },\n});\n/****************** 标签表格配置信息************************** */\n\n/***************** 计算表格自适应高度************************ */\nconst level1tableRef = ref(null);\nconst level2tableRef = ref(null);\nconst level3tableRef = ref(null);\n\n/***************** 计算表格自适应高度************************ */\n\n/******************* 月份改变重新请求数据**************************** */\nconst monthPickChange = value => {\n  dateNow.value = value;\n  getCurrentMonthWorkday();\n  level1Data(level1CheckedValue.value);\n};\n/******************* 月份改变重新请求数据**************************** */\nonBeforeMount(() => {\n  // if(month == '00'){\n  //   currentDate = `${year-1}-12`;\n  //   dateNow.value = currentDate;\n  // }\n  columns();\n  level1Data(level1CheckedValue.value);\n  getCurrentMonthWorkday();\n});\n\n/**************** 表格偶数层级指定背景色************************** */\nconst rowClass = record => {\n  if (record.raw.deptLevel % 2 === 0) {\n    return \"row-gray\";\n  }\n};\nconst level3RadioCheckedChange = val => {\n  level3Data(val);\n};\n/******************** 根据所选标签请求表格数据*************************** */\nconst level1Data = tagKey => {\n  // let mon = dateNow.value + \"\";\n  // let month = mon.replaceAll(\"-\", \"\");\n  let month = dateNow.value;\n  console.log(month,'month');\n  let params = {\n    month,\n    tagKey,\n  };\n  tableInfo.loading = true;\n  level1RadioDisabled.value = true;\n  // console.log(dateNow.value,'dateNow.value');\n  // console.log(params,'params');\n  queryCoreData(params)\n    .then(res => {\n      if (res.code === \"200\") {\n        let data = dataAddKey(res.data, \"key\", \"id\");\n        let keys = [];\n        res.data.forEach(item => keys.push(item.id));\n        tableInfo.level1.defaultExpandedKeys = keys;\n        tableInfo.level1.data = data;\n        if (level1tableRef.value) {\n          let head = level1tableRef.value.$el;\n          let elHeight = head.getBoundingClientRect().top;\n          let innerHeight = window.innerHeight;\n          tableInfo.level1.maxHeight = innerHeight - elHeight + \"px\";\n          nextTick(() => {\n            let layoutContent = document.getElementById('a-layout-main')\n            if(layoutContent){\n              let diff = layoutContent.scrollHeight - layoutContent.offsetHeight\n              tableInfo.level1.maxHeight = parseInt(tableInfo.level1.maxHeight)-diff+'px'\n            }\n          });\n        }\n      } else {\n        tableInfo.level1.data = [];\n        Message.error(res.desc || \"请求数据失败\");\n      }\n    })\n    .catch(err => {\n      Message.error(err.message || \"请求数据失败\");\n    })\n    .finally(() => {\n      tableInfo.loading = false;\n      level1RadioDisabled.value = false;\n    });\n};\nlet level2keys = [];\nfunction expandAllRows(arr) {\n  arr.forEach(item => {\n    level2keys.push(item.title);\n    if (item.children && item.children.length) {\n      expandAllRows(item.children);\n    }\n  });\n}\nconst level2Data = tagKey => {\n  tableInfo.loading = true;\n  level2RadioDisabled.value = true;\n  $bus.emit(\"goBackDisabled\", true);\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    deptId: level2Record.id,\n    month,\n    tagKey,\n  };\n  Array.isArray(columConfig.level1.params) &&\n    columConfig.level1.params.forEach(item => {\n      params[item] = encrypt(level2Record[item]);\n      if (level2Record[item] === undefined || level2Record[item] === null) {\n        params[item] = encrypt(0);\n      }\n    });\n  queryDownDrillSecond(params)\n    .then(res => {\n      if (res.code === \"200\") {\n        let data = dataAddKey(res.data, \"key\", \"title\");\n        expandAllRows(res.data);\n        tableInfo.level2.defaultExpandedKeys = level2keys;\n        tableInfo.level2.data = data;\n        if (level2CheckedValue.value !== \"financeManage2\") {\n          level3HeaderContent = data;\n        }\n        if (level2tableRef.value) {\n          let head = level2tableRef.value.$el;\n          let innerHeight = window.innerHeight;\n          let elHeight = head.getBoundingClientRect().top;\n          tableInfo.level2.maxHeight = innerHeight - elHeight + \"px\";\n        }\n        nextTick(() => {\n          let layoutContent = document.getElementById('a-layout-main')\n          if(layoutContent){\n            let diff = layoutContent.scrollHeight - layoutContent.offsetHeight\n            tableInfo.level2.maxHeight = parseInt(tableInfo.level2.maxHeight)-diff+'px'\n          }\n        });\n      } else {\n        tableInfo.level2.data = [];\n        Message.error(res.desc || \"操作失败\");\n      }\n    })\n    .catch(err => {\n      Message.error(err.message || \"请求数据失败\");\n    })\n    .finally(() => {\n      tableInfo.loading = false;\n      level2RadioDisabled.value = false;\n      $bus.emit(\"goBackDisabled\", false);\n    });\n};\nconst level3Data = tagKey => {\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    projectCode: level3ProjectCode,\n    deptId: level2Record.id,\n    month,\n    tagKey,\n  };\n  Array.isArray(columConfig.level2.params) &&\n    columConfig.level2.params.forEach(item => {\n      params[item] = encrypt(level3Record[item]);\n      if (level3Record[item] === undefined || level3Record[item] === null) {\n        params[item] = encrypt(0);\n      }\n    });\n  tableInfo.loading = true;\n  level3RadioDisabled.value = true;\n  $bus.emit(\"goBackDisabled\", true);\n  queryDownDrillThird(params)\n    .then(res => {\n      if (res.code === \"200\") {\n        let data = dataAddKey(res.data, \"key\", \"id\");\n        let keys = [];\n        res.data.forEach(item => keys.push(item.id));\n        tableInfo.level3.defaultExpandedKeys = keys;\n        tableInfo.level3.data = data;\n        if (level3tableRef.value) {\n          let head = level3tableRef.value.$el;\n          let innerHeight = window.innerHeight;\n          let elHeight = head.getBoundingClientRect().top;\n          tableInfo.level3.maxHeight = innerHeight - elHeight + \"px\";\n        }\n        nextTick(() => {\n          let layoutContent = document.getElementById('a-layout-main')\n          if(layoutContent){\n            let diff = layoutContent.scrollHeight - layoutContent.offsetHeight\n            tableInfo.level3.maxHeight = parseInt(tableInfo.level3.maxHeight)-diff+'px'\n          }\n        });\n      } else {\n        tableInfo.level3.data = [];\n        Message.error(res.desc || \"请求数据失败\");\n      }\n    })\n    .catch(err => {\n      Message.error(err.message || \"请求数据失败\");\n    })\n    .finally(() => {\n      tableInfo.loading = false;\n      level3RadioDisabled.value = false;\n      $bus.emit(\"goBackDisabled\", false);\n    });\n  getList(type.value);\n};\n/******************** 根据所选标签请求表格数据*************************** */\n\n/***************** 标签点击切换请求数据************************** */\nconst radioCheckedChange = val => {\n  level1Data(val);\n};\n\nconst level2RadioCheckedChange = val => {\n  level2Data(val);\n};\n/***************** 标签点击切换请求数据************************** */\nwatchEffect(() => {\n  $bus.emit(\"updateStructure\", [\n    { type: \"text\", color: \"#333\", msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)` },\n  ]);\n});\n\n/**************** 监听点击返回上一层***************************** */\n$bus.on(\"goBack\", val => {\n  currentLevel.value = val;\n  switch (val) {\n    case \"level1\":\n      let breadList1 = [\n        { type: \"text\", color: \"#333\", msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)` },\n      ];\n      $bus.emit(\"updateStructure\", breadList1);\n      //level1Data(level1CheckedValue.value)\n      break;\n    case \"level2\":\n      let breadList2 = [\n        {\n          type: \"button\",\n          color: \"#5370FD\",\n          msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`,\n          params: \"level1\",\n        },\n        {\n          type: \"text\",\n          color: \"#333\",\n          msg: level2Record.deptName,\n        },\n      ];\n      $bus.emit(\"updateStructure\", breadList2);\n      break;\n    default:\n      break;\n  }\n});\nonUnmounted(() => {\n  $bus.off(\"goBack\");\n});\n/**************** 监听点击返回上一层***************************** */\n\n/***********************点击跳转下钻层级********************************** */\nconst jump = (val, record) => {\n  currentLevel.value = val;\n  if (val === \"level2\") {\n    level2Record = record;\n    level2Data(level2CheckedValue.value);\n    let breadList = [\n      {\n        type: \"button\",\n        color: \"#5370FD\",\n        msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`,\n        params: \"level1\",\n      },\n      {\n        type: \"text\",\n        color: \"#333\",\n        msg: level2Record.deptName,\n      },\n    ];\n    $bus.emit(\"updateStructure\", breadList);\n    level2CheckedArr.value = [];\n  }\n  if (val === \"level3\") {\n    level3ProjectCode = record.projectNo;\n    level3Record = record;\n    let { groupCustomerName, customerName, title } = record;\n    let level3HeaderDataArr1 = level3HeaderContent.filter(item => item.title === groupCustomerName);\n    let level3HeaderDataArr2 =\n      level3HeaderDataArr1 && level3HeaderDataArr1[0]?.children.filter(item => item.title === customerName);\n    let level3HeaderDataArr3 = level3HeaderDataArr2 && level3HeaderDataArr2[0]?.children.filter(item => item.title === title);\n    level3HeaderData.value = (level3HeaderDataArr3 && level3HeaderDataArr3[0]) || {};\n    level3Data(level3CheckedValue.value);\n    let breadList = [\n      {\n        type: \"button\",\n        color: \"#5370FD\",\n        msg: `${moment(dateNow.value).format(\"YYYY年MM月\")} (${currentMonthDay.value}天)`,\n        params: \"level1\",\n      },\n      {\n        type: \"button\",\n        color: \"#5370FD\",\n        msg: level2Record.deptName,\n        params: \"level2\",\n      },\n      {\n        type: \"text\",\n        color: \"#333\",\n        msg: `项目： ${record.title}`,\n      },\n    ];\n    $bus.emit(\"updateStructure\", breadList);\n  }\n};\n/***********************点击跳转下钻层级********************************** */\n\n/*************************表格树结构展开切换******************************************** */\nconst expandedChange = rowKeys => {\n  tableInfo[currentLevel.value].defaultExpandedKeys = rowKeys;\n};\n/*************************表格树结构展开切换******************************************** */\nconst spinLoading = ref(false);\n// 获取散点图数据\nconst getList = value => {\n  spinLoading.value = true;\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    projectCode: level3ProjectCode,\n    deptId: level2Record.id,\n    month,\n    tagKey: level3CheckedValue.value,\n    type: value,\n  };\n  Array.isArray(columConfig.level2.params) &&\n    columConfig.level2.params.forEach(item => {\n      params[item] = encrypt(level3Record[item]);\n      if (level3Record[item] === undefined || level3Record[item] === null) {\n        params[item] = encrypt(0);\n      }\n    });\n  // 接口数据\n  queryScatterDiagram(params)\n    .then(res => {\n      if (res.code === \"200\") {\n        data.value = res.data;\n        // 每个点的样式\n        var itemStyle = {\n          //设置圆形的样式\n          shadowBlur: 10,\n          shadowColor: \"rgba(120, 36, 50, 0.5)\",\n          shadowOffsetY: 5,\n        };\n        data.value.forEach(item => {\n          item.type = \"scatter\";\n          item.itemStyle = itemStyle;\n          item.symbolSize = 15;\n        });\n      }\n      if (value === 1) {\n        color.value = [\"#503e6a\", \"#fec42c\", \"#f96f0d\", \"#dd4444\"];\n      } else {\n        color.value = [\"#f6d91d\", \"#fec42c\", \"#fb954d\", \"#f6682c\", \"#f81313\", \"#7d1d07\"];\n      }\n    })\n    .catch(e => {\n      Message.error(e.message || \"数据请求失败\");\n    })\n    .finally(() => {\n      spinLoading.value = false;\n    });\n};\n// 更改颜色维度\nconst changeType = value => {\n  type.value = value;\n  getList(value);\n};\n//更改看图 列表\nconst changeDataType = value => {\n  dataType.value = value;\n};\n\n/**************** 设置角色******************** */\nconst level2CheckedArr = ref([]);\nconst level2CheckboxChange = (bool, record) => {\n  let index = level2CheckedArr.value.findIndex(item => item.id === record.id);\n  if (bool) {\n    if (level2CheckedArr.value.length > 0) {\n      if (index === -1) {\n        level2CheckedArr.value.push(toRaw(record));\n      }\n    } else {\n      level2CheckedArr.value.push(toRaw(record));\n    }\n  } else {\n    if (level2CheckedArr.value.length > 0) {\n      if (index !== -1) {\n        level2CheckedArr.value.splice(index, 1);\n      }\n    }\n  }\n};\nconst setRoleModal = reactive({\n  visible: false,\n  selectOptions: [],\n  loading: false,\n  roles: [\n    {\n      label: \"项目经理角色\",\n      value: undefined,\n    },\n    {\n      label: \"收入上报角色\",\n      value: undefined,\n    },\n    {\n      label: \"薪资异动上报角色\",\n      value: undefined,\n    },\n    {\n      label: \"考勤上报角色\",\n      value: undefined,\n    },\n  ],\n  confirmBtnLoading: false,\n});\nconst level2SetRole = async () => {\n  setRoleModal.visible = true;\n  let roleStaffInfoList = [];\n  let echoList = [];\n  setRoleModal.roles.forEach(item => {\n    item.value = undefined;\n  });\n  try {\n    let params1 = {\n      projectNo: level2CheckedArr.value.map(item => item.projectNo).toString(),\n    };\n    let roleStaffInfoResult = await listByProjectNo(params1);\n    if (roleStaffInfoResult.code === \"200\") {\n      roleStaffInfoList = roleStaffInfoResult.data;\n    }\n  } catch (error) {\n    Message.error(\"请求数据失败\");\n  }\n  try {\n    setRoleModal.loading = true;\n    let params = {\n      deptName: level2Record.deptName,\n    };\n    let res2 = await queryLikeDept(params);\n    if (res2.code === \"200\") {\n      setRoleModal.selectOptions =\n        (Array.isArray(res2.data) &&\n          markRaw(\n            res2.data.map(item => {\n              roleStaffInfoList.forEach(jtem => {\n                if (item.id === jtem.empId) {\n                  echoList.push({\n                    ...item,\n                    roleId: jtem.roleId,\n                  });\n                }\n              });\n              return {\n                value: JSON.stringify(item),\n                label: `${item.empName} ( ${item.empCode},  ${item.deptName} )`,\n              };\n            }),\n          )) ||\n        [];\n    }\n  } catch (error) {\n    Message.error(\"请求数据失败\");\n  }\n  if (level2CheckedArr.value.length > 1) {\n    setRoleModal.loading = false;\n    return;\n  }\n  if (echoList.length) {\n    setRoleModal.roles.forEach(item => {\n      let index = echoList.findIndex(jtem => jtem.roleId === item.label);\n      if (index !== -1) {\n        delete echoList[index].roleId;\n        item.value = JSON.stringify(echoList[index]);\n      }\n    });\n  } else {\n    setRoleModal.roles.forEach(item => {\n      item.value = undefined;\n    });\n  }\n  setRoleModal.loading = false;\n};\nconst setRoleCancel = () => {\n  setRoleModal.roles.forEach(item => {\n    item.value = undefined;\n  });\n  setRoleModal.visible = false;\n};\nconst setRoleOk = () => {\n  let emptyArr = [];\n  setRoleModal.roles.forEach(item => {\n    if (item.value === undefined || item.value === \"\") {\n      emptyArr.push(\" \");\n    }\n  });\n  if (emptyArr.length === setRoleModal.roles.length) return Message.error(\"至少选择一条\");\n  setRoleModal.confirmBtnLoading = true;\n  let selsected = [];\n  setRoleModal.roles.forEach(item => {\n    if (item.value !== undefined) {\n      try {\n        let value = JSON.parse(item.value);\n        selsected.push({\n          dept: value.deptName || \"\",\n          empId: value.id || \"\",\n          empNo: value.empCode || \"\",\n          empName: value.empName || \"\",\n          roleId: item.label,\n        });\n      } catch (error) {\n        throw Error(error);\n      }\n    }\n  });\n  let params = {\n    projectNos: level2CheckedArr.value.map(item => item.projectNo),\n    info: selsected,\n  };\n  save(params)\n    .then(res => {\n      if (res.code === \"200\") {\n        Message.success(res.desc || \"新建角色成功\");\n        level2CheckedArr.value = [];\n      } else {\n        Message.error(res.message || \"请求失败\");\n      }\n    })\n    .catch(() => {\n      Message.error(\"请求失败\");\n    })\n    .finally(() => {\n      setRoleModal.confirmBtnLoading = false;\n      setRoleModal.visible = false;\n    });\n};\n/**************** 设置角色******************** */\n/************************ level1导出********************************** */\nconst level1ExportLoading = ref(false);\nconst level1ExportCurrentPage = () => {\n  level1ExportLoading.value = true;\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    month,\n  };\n  bgExportExcel(params)\n    .then(res => {\n      const blob = new Blob([res]);\n      const fileReader = new FileReader();\n      fileReader.readAsText(res, \"utf-8\");\n      fileReader.onerror = function () {\n        Message.error(\"导出文件失败\");\n        return;\n      };\n      const fileName = `下钻分析_部门级别_${month}.xlsx`;\n      const link = document.createElement(\"a\");\n      link.download = fileName;\n      link.style.display = \"none\";\n      link.href = URL.createObjectURL(blob);\n      document.body.appendChild(link);\n      link.click();\n      URL.revokeObjectURL(link.href);\n      document.body.removeChild(link);\n    })\n    .catch(() => {\n      Message.error(\"导出失败\");\n    })\n    .finally(() => {\n      level1ExportLoading.value = false;\n    });\n};\n/************************ level1导出********************************** */\n\n/************************ level1导出全部********************************** */\nconst level1ExportAllLoading = ref(false);\nconst level1ExportAll = () => {\n  level1ExportAllLoading.value = true;\n  Message.loading(\"下载时间较长，请耐心等待\");\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    month,\n  };\n  downAllExcel(params)\n    .then(res => {\n      const blob = new Blob([res]);\n      const fileName = `下钻分析_全部_${month}.xlsx`;\n      const link = document.createElement(\"a\");\n      link.download = fileName;\n      link.style.display = \"none\";\n      link.href = URL.createObjectURL(blob);\n      document.body.appendChild(link);\n      link.click();\n      URL.revokeObjectURL(link.href);\n      document.body.removeChild(link);\n    })\n    .catch(() => {\n      Message.error(\"导出失败\");\n    })\n    .finally(() => {\n      level1ExportAllLoading.value = false;\n    });\n};\n\n/************************ level1导出全部********************************** */\n\n/************************ level2导出********************************** */\nconst level2ExportLoading = ref(false);\nconst level2ExportAll = () => {\n  level2ExportLoading.value = true;\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    deptId: level2Record.id,\n    month,\n    deptName: level2Record.deptName,\n    tagKey: level2CheckedValue.value,\n  };\n  Array.isArray(columConfig.level1.params) &&\n    columConfig.level1.params.forEach(item => {\n      params[item] = encrypt(level2Record[item]);\n      if (level2Record[item] === undefined || level2Record[item] === null) {\n        params[item] = encrypt(0);\n      }\n    });\n  cuPoExportExcel(params)\n    .then(res => {\n      const blob = new Blob([res]);\n      const fileName = `下钻分析_客户项目级别_${month}.xlsx`;\n      const link = document.createElement(\"a\");\n      link.download = fileName;\n      link.style.display = \"none\";\n      link.href = URL.createObjectURL(blob);\n      document.body.appendChild(link);\n      link.click();\n      URL.revokeObjectURL(link.href);\n      document.body.removeChild(link);\n    })\n    .catch(() => {\n      Message.error(\"导出失败\");\n    })\n    .finally(() => {\n      level2ExportLoading.value = false;\n    });\n};\n\n/************************ level2导出********************************** */\n\n/**************** levle3导出本页****************** */\nconst level3ExportLoading = ref(false);\nconst level3Export = () => {\n  level3ExportLoading.value = true;\n  let mon = dateNow.value + \"\";\n  let month = mon.replaceAll(\"-\", \"\");\n  let params = {\n    projectCode: level3ProjectCode,\n    deptId: level2Record.id,\n    month,\n    tagKey: level3CheckedValue.value,\n    deptName: level2Record.deptName,\n    groupCustomer: level3HeaderData.value.groupCustomerName + \"\",\n    customer: level3HeaderData.value.customerName + \"\",\n    projectName: level3HeaderData.value.title + \"\",\n  };\n  Array.isArray(columConfig.level2.params) &&\n    columConfig.level2.params.forEach(item => {\n      params[item] = encrypt(level3Record[item]);\n      if (level3Record[item] === undefined || level3Record[item] === null) {\n        params[item] = encrypt(0);\n      }\n    });\n  empExportExcel(params)\n    .then(res => {\n      const blob = new Blob([res]);\n      const fileName = `下钻分析_人员级别_${month}.xlsx`;\n      const link = document.createElement(\"a\");\n      link.download = fileName;\n      link.style.display = \"none\";\n      link.href = URL.createObjectURL(blob);\n      document.body.appendChild(link);\n      link.click();\n      URL.revokeObjectURL(link.href);\n      document.body.removeChild(link);\n    })\n    .catch(() => {\n      Message.error(\"导出失败\");\n    })\n    .finally(() => {\n      level3ExportLoading.value = false;\n    });\n};\n/**************** levle3导出本页****************** */\n\n/****************** 集团/客户/项目详情***************************** */\nconst blocInfoModal = reactive({\n  visible: false,\n  tableColumns: [\n    {\n      title: \"客户名称\",\n      dataIndex: \"customerName\",\n      width: 294,\n      headerCellStyle: { background: \"#F7F8FF\", color: \"#78797B\" },\n      cellStyle: { color: \"#7B7B7B\" },\n    },\n    {\n      title: \"行业\",\n      dataIndex: \"industry\",\n      width: 82,\n      headerCellStyle: { background: \"#F7F8FF\", color: \"#78797B\" },\n      cellStyle: { color: \"#7B7B7B\" },\n    },\n    {\n      title: \"地址\",\n      dataIndex: \"adress\",\n      width: 330,\n      headerCellStyle: { background: \"#F7F8FF\", color: \"#78797B\" },\n      cellStyle: { color: \"#7B7B7B\" },\n    },\n  ],\n  tableData: [\n    {\n      customerName: \"三星半导体(中国)研究开发有限公司北京分公司\",\n      industry: \"通信\",\n      adress: \"北京市朝阳区北京市朝阳区太阳宫中路冠捷大厦8层\",\n      key: 1,\n    },\n  ],\n});\nconst blocInfoModalOk = () => {\n  blocInfoModal.visible = false;\n};\nconst customerModal = reactive({\n  visible: false,\n  basicColumn: 2,\n  basicData: [\n    {\n      label: \"客户名称\",\n      value: \"广州三星通信技术研究有限公司\",\n    },\n    {\n      label: \"集团客户名称\",\n      value: \"集团客户-三星\",\n    },\n    {\n      label: \"行业\",\n      value: \"信息技术\",\n    },\n    {\n      label: \"开始合作时间\",\n      value: \"2022-22-01\",\n    },\n    {\n      label: \"区域\",\n      value: \"大中华区\",\n    },\n    {\n      label: \"地址\",\n      value: \"广东省广州市黄埔区黄埔区科学城科学大道185号\",\n    },\n  ],\n  staffColumn: 2,\n  staffData: [\n    {\n      label: \"销售人员\",\n      value: \"鲍雪欣\",\n    },\n    {\n      label: \"销售人员部门\",\n      value: \"BG2-STA-ERIREG_S\",\n    },\n  ],\n});\n\nconst projectModal = reactive({\n  visible: false,\n  basicColumn: 2,\n  basicData: [\n    {\n      label: \"客户名称\",\n      value: \"广州三星通信技术研究有限公司\",\n    },\n    {\n      label: \"集团客户名称\",\n      value: \"集团客户-三星\",\n    },\n    {\n      label: \"行业\",\n      value: \"信息技术\",\n    },\n    {\n      label: \"开始合作时间\",\n      value: \"2022-22-01\",\n    },\n    {\n      label: \"区域\",\n      value: \"大中华区\",\n    },\n    {\n      label: \"地址\",\n      value: \"广东省广州市黄埔区黄埔区科学城科学大道185号\",\n    },\n  ],\n  staffColumn: 2,\n  staffData: [\n    {\n      label: \"所属部门\",\n      value: \"BG1-MSD\",\n    },\n    {\n      label: \"部门负责人\",\n      value: \"金迪\",\n    },\n  ],\n  manageColumn: 2,\n  manageData: [\n    {\n      label: \"税率\",\n      value: \" 6%\",\n    },\n    {\n      label: \"预估毛利率\",\n      value: \"50\",\n    },\n    {\n      label: \"结算周期(天)\",\n      value: \" 90\",\n    },\n    {\n      label: \"回款周期(天)\",\n      value: \"90\",\n    },\n  ],\n});\n/****************** 集团/客户/项目详情***************************** */\n</script>\n\n<style lang=\"scss\">\n.m-t-10 {\n  margin-top: 10px;\n}\n.m-b-10 {\n  margin-bottom: 10px;\n}\n.row-gray .arco-table-td {\n  background-color: #f8f8f8;\n}\n.level3Header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 30px;\n  border-bottom: 10px solid #f0f2f5;\n  .w-perct-80 {\n    width: 80%;\n    .item {\n      color: #1e1e1e;\n      span {\n        color: #87909d;\n      }\n    }\n  }\n}\n.arco-table-hover:not(.arco-table-dragging)\n  .arco-table-tr:not(.arco-table-tr-empty):not(.arco-table-tr-summary):hover\n  .arco-table-td.arco-table-col-fixed-left::before,\n.arco-table-hover .arco-table-tr-drag .arco-table-td.arco-table-col-fixed-left::before,\n.arco-table-hover:not(.arco-table-dragging)\n  .arco-table-tr:not(.arco-table-tr-empty):not(.arco-table-tr-summary):hover\n  .arco-table-td.arco-table-col-fixed-right::before,\n.arco-table-hover .arco-table-tr-drag .arco-table-td.arco-table-col-fixed-right::before {\n  background-color: #f1faff;\n}\n.arco-table-hover:not(.arco-table-dragging)\n  .arco-table-tr:not(.arco-table-tr-empty):not(.arco-table-tr-summary):hover\n  .arco-table-td:not(.arco-table-col-fixed-left):not(.arco-table-col-fixed-right),\n.arco-table-hover .arco-table-tr-drag .arco-table-td:not(.arco-table-col-fixed-left):not(.arco-table-col-fixed-right) {\n  background-color: #f1faff;\n}\n.modal-label {\n  display: inline-block;\n  width: 142px;\n  text-align: right;\n  padding-right: 15px;\n  box-sizing: border-box;\n}\n.text-center {\n  text-align: center;\n}\n.modal-title {\n  color: #5a5a5a;\n  font-size: 14px;\n  font-weight: bold;\n}\n.blocInfoModal-content-title {\n  color: #7b7b7b;\n  font-size: 14px;\n  margin-bottom: 22px;\n}\n.customerModal-content-title {\n  color: \"#333333\";\n  font-size: 14px;\n  margin-bottom: 14px;\n}\n.chartSelect {\n  float: right;\n  margin: 60px 30px 0 0;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}