{"ast":null,"code":"import { isAnyArray } from 'is-any-array';\nimport Matrix from './matrix';\nexport function correlation(xMatrix, yMatrix = xMatrix, options = {}) {\n  xMatrix = new Matrix(xMatrix);\n  let yIsSame = false;\n  if (typeof yMatrix === 'object' && !Matrix.isMatrix(yMatrix) && !isAnyArray(yMatrix)) {\n    options = yMatrix;\n    yMatrix = xMatrix;\n    yIsSame = true;\n  } else {\n    yMatrix = new Matrix(yMatrix);\n  }\n  if (xMatrix.rows !== yMatrix.rows) {\n    throw new TypeError('Both matrices must have the same number of rows');\n  }\n  const {\n    center = true,\n    scale = true\n  } = options;\n  if (center) {\n    xMatrix.center('column');\n    if (!yIsSame) {\n      yMatrix.center('column');\n    }\n  }\n  if (scale) {\n    xMatrix.scale('column');\n    if (!yIsSame) {\n      yMatrix.scale('column');\n    }\n  }\n  const sdx = xMatrix.standardDeviation('column', {\n    unbiased: true\n  });\n  const sdy = yIsSame ? sdx : yMatrix.standardDeviation('column', {\n    unbiased: true\n  });\n  const corr = xMatrix.transpose().mmul(yMatrix);\n  for (let i = 0; i < corr.rows; i++) {\n    for (let j = 0; j < corr.columns; j++) {\n      corr.set(i, j, corr.get(i, j) * (1 / (sdx[i] * sdy[j])) * (1 / (xMatrix.rows - 1)));\n    }\n  }\n  return corr;\n}","map":{"version":3,"names":["isAnyArray","Matrix","correlation","xMatrix","yMatrix","options","yIsSame","isMatrix","rows","TypeError","center","scale","sdx","standardDeviation","unbiased","sdy","corr","transpose","mmul","i","j","columns","set","get"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-oms-frontend/node_modules/ml-matrix/src/correlation.js"],"sourcesContent":["import { isAnyArray } from 'is-any-array';\n\nimport Matrix from './matrix';\n\nexport function correlation(xMatrix, yMatrix = xMatrix, options = {}) {\n  xMatrix = new Matrix(xMatrix);\n  let yIsSame = false;\n  if (\n    typeof yMatrix === 'object' &&\n    !Matrix.isMatrix(yMatrix) &&\n    !isAnyArray(yMatrix)\n  ) {\n    options = yMatrix;\n    yMatrix = xMatrix;\n    yIsSame = true;\n  } else {\n    yMatrix = new Matrix(yMatrix);\n  }\n  if (xMatrix.rows !== yMatrix.rows) {\n    throw new TypeError('Both matrices must have the same number of rows');\n  }\n\n  const { center = true, scale = true } = options;\n  if (center) {\n    xMatrix.center('column');\n    if (!yIsSame) {\n      yMatrix.center('column');\n    }\n  }\n  if (scale) {\n    xMatrix.scale('column');\n    if (!yIsSame) {\n      yMatrix.scale('column');\n    }\n  }\n\n  const sdx = xMatrix.standardDeviation('column', { unbiased: true });\n  const sdy = yIsSame\n    ? sdx\n    : yMatrix.standardDeviation('column', { unbiased: true });\n\n  const corr = xMatrix.transpose().mmul(yMatrix);\n  for (let i = 0; i < corr.rows; i++) {\n    for (let j = 0; j < corr.columns; j++) {\n      corr.set(\n        i,\n        j,\n        corr.get(i, j) * (1 / (sdx[i] * sdy[j])) * (1 / (xMatrix.rows - 1)),\n      );\n    }\n  }\n  return corr;\n}\n"],"mappings":"AAAA,SAASA,UAAU,QAAQ,cAAc;AAEzC,OAAOC,MAAM,MAAM,UAAU;AAE7B,OAAO,SAASC,WAAW,CAACC,OAAO,EAAEC,OAAO,GAAGD,OAAO,EAAEE,OAAO,GAAG,CAAC,CAAC,EAAE;EACpEF,OAAO,GAAG,IAAIF,MAAM,CAACE,OAAO,CAAC;EAC7B,IAAIG,OAAO,GAAG,KAAK;EACnB,IACE,OAAOF,OAAO,KAAK,QAAQ,IAC3B,CAACH,MAAM,CAACM,QAAQ,CAACH,OAAO,CAAC,IACzB,CAACJ,UAAU,CAACI,OAAO,CAAC,EACpB;IACAC,OAAO,GAAGD,OAAO;IACjBA,OAAO,GAAGD,OAAO;IACjBG,OAAO,GAAG,IAAI;EAChB,CAAC,MAAM;IACLF,OAAO,GAAG,IAAIH,MAAM,CAACG,OAAO,CAAC;EAC/B;EACA,IAAID,OAAO,CAACK,IAAI,KAAKJ,OAAO,CAACI,IAAI,EAAE;IACjC,MAAM,IAAIC,SAAS,CAAC,iDAAiD,CAAC;EACxE;EAEA,MAAM;IAAEC,MAAM,GAAG,IAAI;IAAEC,KAAK,GAAG;EAAK,CAAC,GAAGN,OAAO;EAC/C,IAAIK,MAAM,EAAE;IACVP,OAAO,CAACO,MAAM,CAAC,QAAQ,CAAC;IACxB,IAAI,CAACJ,OAAO,EAAE;MACZF,OAAO,CAACM,MAAM,CAAC,QAAQ,CAAC;IAC1B;EACF;EACA,IAAIC,KAAK,EAAE;IACTR,OAAO,CAACQ,KAAK,CAAC,QAAQ,CAAC;IACvB,IAAI,CAACL,OAAO,EAAE;MACZF,OAAO,CAACO,KAAK,CAAC,QAAQ,CAAC;IACzB;EACF;EAEA,MAAMC,GAAG,GAAGT,OAAO,CAACU,iBAAiB,CAAC,QAAQ,EAAE;IAAEC,QAAQ,EAAE;EAAK,CAAC,CAAC;EACnE,MAAMC,GAAG,GAAGT,OAAO,GACfM,GAAG,GACHR,OAAO,CAACS,iBAAiB,CAAC,QAAQ,EAAE;IAAEC,QAAQ,EAAE;EAAK,CAAC,CAAC;EAE3D,MAAME,IAAI,GAAGb,OAAO,CAACc,SAAS,EAAE,CAACC,IAAI,CAACd,OAAO,CAAC;EAC9C,KAAK,IAAIe,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACR,IAAI,EAAEW,CAAC,EAAE,EAAE;IAClC,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,IAAI,CAACK,OAAO,EAAED,CAAC,EAAE,EAAE;MACrCJ,IAAI,CAACM,GAAG,CACNH,CAAC,EACDC,CAAC,EACDJ,IAAI,CAACO,GAAG,CAACJ,CAAC,EAAEC,CAAC,CAAC,IAAI,CAAC,IAAIR,GAAG,CAACO,CAAC,CAAC,GAAGJ,GAAG,CAACK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAIjB,OAAO,CAACK,IAAI,GAAG,CAAC,CAAC,CAAC,CACpE;IACH;EACF;EACA,OAAOQ,IAAI;AACb"},"metadata":{},"sourceType":"module","externalDependencies":[]}