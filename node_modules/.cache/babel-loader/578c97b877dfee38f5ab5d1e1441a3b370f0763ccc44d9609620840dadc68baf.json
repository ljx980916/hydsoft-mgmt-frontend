{"ast":null,"code":"import { ref, reactive } from 'vue';\nimport { revenueColumns, List } from './constColumns.js';\nimport { getRevenueList, getForeignCurrency } from '@/api/revenue.js';\nimport { dealData, getCurrentDate } from '@/utils/util.js';\nimport CollapseTable from '@/components/collapseTable.vue';\nimport NoCollapseTable from '@/components/noCollapseTable.vue';\nimport { countWorkdaysByMonth } from \"@/api/drillAnalyze.js\";\nexport default {\n  __name: 'revenue',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    let {\n      year\n    } = getCurrentDate();\n    // let currentDate = `${year}-${month}`;\n    // const dateNow = ref(currentDate);\n    const expandedRowKeys = ref([]);\n    const noexpandedRowKeys = ref([]);\n    // 折叠表格配置信息\n    const dataContent = reactive({\n      columns: revenueColumns,\n      dataSource: [],\n      loading: false\n    });\n    // 表格配置信息\n    const tableContent = reactive({\n      columns: revenueColumns,\n      dataSource: [],\n      loading: false\n    });\n    // 已展开的数据行发生改变时触发\n    const expandedChange = rowkeys => {\n      expandedRowKeys.value = rowkeys;\n    };\n    const noexpandedChange = rowkeys => {\n      noexpandedRowKeys.value = rowkeys;\n    };\n    // 获取收入列表数据\n    const getRevenueTable = () => {\n      List.forEach(item => {\n        let month = 0;\n        if (item.dataIndex.substring(0, 5) == 'month') {\n          if (Number(item.dataIndex.substring(5)) < 10) {\n            month = `0${item.dataIndex.substring(5)}`;\n          } else {\n            month = item.dataIndex.substring(5);\n          }\n          const params = {\n            month: `${year}-${month}`\n          };\n          countWorkdaysByMonth(params).then(res => {\n            if (res.code === \"200\") {\n              item.days = res.data;\n            }\n          }).catch(() => {\n            Message.error(\"请求失败\");\n          });\n        }\n        // 2023-12\n      });\n\n      List.forEach(item => {\n        const objItem = {\n          title: item.title,\n          dataIndex: item.dataIndex\n          // render({record}){\n          //  return <a href=\"javaScript:void(0)\" onClick={()=>{goRingContrastChart(record,'customer')}}>看图</a>\n          // }\n        };\n      });\n\n      getRevenueList().then(res => {\n        if (res.code == '000000000000') {\n          dataContent.dataSource = dealData(res.data.list).arr;\n          expandedRowKeys.value = dealData(res.data.list).keyArr;\n        }\n      });\n    };\n    getRevenueTable();\n    //获取外币列表数据\n    const getForeignCurrencyTable = () => {\n      getForeignCurrency().then(res => {\n        if (res.code == '000000000000') {\n          tableContent.dataSource = dealData(res.data.list).arr;\n        }\n      });\n    };\n    getForeignCurrencyTable();\n    const __returned__ = {\n      get year() {\n        return year;\n      },\n      set year(v) {\n        year = v;\n      },\n      expandedRowKeys,\n      noexpandedRowKeys,\n      dataContent,\n      tableContent,\n      expandedChange,\n      noexpandedChange,\n      getRevenueTable,\n      getForeignCurrencyTable,\n      ref,\n      reactive,\n      get revenueColumns() {\n        return revenueColumns;\n      },\n      get List() {\n        return List;\n      },\n      get getRevenueList() {\n        return getRevenueList;\n      },\n      get getForeignCurrency() {\n        return getForeignCurrency;\n      },\n      get dealData() {\n        return dealData;\n      },\n      get getCurrentDate() {\n        return getCurrentDate;\n      },\n      CollapseTable,\n      NoCollapseTable,\n      get countWorkdaysByMonth() {\n        return countWorkdaysByMonth;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"mappings":"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","names":["ref","reactive","revenueColumns","List","getRevenueList","getForeignCurrency","dealData","getCurrentDate","CollapseTable","NoCollapseTable","countWorkdaysByMonth","year","expandedRowKeys","noexpandedRowKeys","dataContent","columns","dataSource","loading","tableContent","expandedChange","rowkeys","value","noexpandedChange","getRevenueTable","forEach","item","month","dataIndex","substring","Number","params","then","res","code","days","data","catch","Message","error","objItem","title","list","arr","keyArr","getForeignCurrencyTable"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-oms-frontend/src/views/demo/revenue.vue"],"sourcesContent":["<template>\n  <div class=\"defaultPadding\">\n    <header>\n       <a-space>\n        <div class=\"tag\">部门</div>\n        <span  class=\"dept\">BG1</span>\n        </a-space>\n    </header>\n    <main>\n        <div>\n            <!-- 营业收入 -->\n            <CollapseTable \n                :title=\"'营业收入'\"\n                :columns = \"dataContent.columns\" \n                :data = \"dataContent.dataSource\" \n                :loading =\"dataContent.loading\"\n                :expandedRowKeys=\"expandedRowKeys\"\n                @expandedChange=\"expandedChange\"\n            />\n        </div>\n         <!-- 外币 -->\n        <div>\n            <NoCollapseTable\n                :title=\"'外币'\"\n                :columns = \"tableContent.columns\" \n                :data = \"tableContent.dataSource\" \n                :loading =\"tableContent.loading\"\n                :expandedRowKeys=\"noexpandedRowKeys\"\n                :setColumnsData=\"dataContent.dataSource\"\n                @noexpandedChange=\"noexpandedChange\"\n            />\n        </div>\n    </main>\n  </div>\n</template>\n\n\n<script setup>\nimport { ref,reactive } from 'vue';\nimport {revenueColumns,List} from './constColumns.js';\nimport {getRevenueList,getForeignCurrency} from '@/api/revenue.js';\nimport {dealData,getCurrentDate} from '@/utils/util.js';\nimport CollapseTable from '@/components/collapseTable.vue';\nimport NoCollapseTable from '@/components/noCollapseTable.vue';\nimport {countWorkdaysByMonth} from \"@/api/drillAnalyze.js\";\nlet { year} = getCurrentDate();\n// let currentDate = `${year}-${month}`;\n// const dateNow = ref(currentDate);\nconst expandedRowKeys = ref([]);\nconst noexpandedRowKeys = ref([]);\n// 折叠表格配置信息\nconst dataContent = reactive({\n  columns: revenueColumns,\n  dataSource: [],\n  loading: false\n});\n// 表格配置信息\nconst tableContent = reactive({\n  columns: revenueColumns,\n  dataSource: [],\n  loading: false\n});\n// 已展开的数据行发生改变时触发\nconst expandedChange = (rowkeys)=>{\n    expandedRowKeys.value = rowkeys\n};\nconst noexpandedChange = (rowkeys)=>{\n    noexpandedRowKeys.value = rowkeys\n};\n// 获取收入列表数据\nconst getRevenueTable = ()=>{\n    List.forEach(item=>{\n        let month = 0;\n        if(item.dataIndex.substring(0,5)=='month'){\n            if(Number(item.dataIndex.substring(5))<10){\n                month = `0${item.dataIndex.substring(5)}`\n            }else{\n                month = item.dataIndex.substring(5)\n            }\n            const params = {\n                month: `${year}-${month}`,\n            };\n            countWorkdaysByMonth(params)\n            .then(res => {\n                if (res.code === \"200\") {\n                    item.days = res.data;\n                }\n            })\n            .catch(() => {\n                Message.error(\"请求失败\");\n            });\n        }\n        // 2023-12\n\n    })\n    List.forEach(item=>{\n        const objItem = {\n            title : item.title,\n            dataIndex : item.dataIndex,\n            // render({record}){\n            //  return <a href=\"javaScript:void(0)\" onClick={()=>{goRingContrastChart(record,'customer')}}>看图</a>\n            // }\n        }\n    })\n    getRevenueList().then(res=>{\n        if(res.code =='000000000000'){\n            dataContent.dataSource =  dealData(res.data.list).arr;\n            expandedRowKeys.value = dealData(res.data.list).keyArr;\n        }\n    })\n};\ngetRevenueTable()\n//获取外币列表数据\nconst getForeignCurrencyTable =()=>{\n    getForeignCurrency().then(res=>{\n        if(res.code =='000000000000'){\n            tableContent.dataSource = dealData(res.data.list).arr;\n        }\n    })\n};\ngetForeignCurrencyTable()\n</script>\n\n<style lang=\"scss\" scoped>\n.tag{\n    border-width: 0px;\n    position:relative;\n    left:-40px;\n    top:6px;\n    width: 66px;\n    height: 29px;\n    background: linear-gradient(210deg, rgba(168, 113, 227, 1) 0%, rgba(168, 113, 227, 1) 0%, rgba(141, 78, 218, 1) 100%, rgba(141, 78, 218, 1) 100%);\n    border: none;\n    border-radius: 2px;\n    box-shadow: none;\n    color:#fff;\n    font-weight: 600;\n    text-align: center;\n    line-height: 29px;\n    transform-style:preserve-3d;\n}\n.tag::after{\n    content: '';\n    position:absolute;\n    left:-8px;\n    top:20px;\n    width: 0;\n    height: 0;\n    border: 9px solid;\n    border-color: transparent transparent rgb(113, 52, 178);\n    transform:translateZ(-1px) rotate(270deg);\n}\n.dept{\n    font-family: 'PingFangSC-Medium', 'PingFang SC Medium', 'PingFang SC';\n    font-weight: bold;\n    font-style: normal;\n    color: #4C5767;\n    margin: 12px 0px 0px 0px;\n}\n:deep(.arco-icon-plus){\n    background-image: url(@/assets/images/Triangle-right.png);\n    background-size: 110% 100%;\n    width: 14px!important;\n    height: 14px!important;\n    color: #FFFFFF00;\n    background-position:center;\n    background-repeat: no-repeat;\n}\n:deep(.arco-icon-minus){\n\tbackground-image: url(@/assets/images/Triangle-bottom.png);\n    background-size: 110% 100%;\n    background-repeat: no-repeat;\n    width: 14px!important;\n    height: 14px!important;\n    color: #FFFFFF00;\n    background-position:center;\n}\n:deep(.arco-table .arco-table-expand-btn){\n    background-color: #fff !important;\n}\n:deep(.activeRowGreen > .arco-table-td) {\n    background-color: rgb(234, 248, 243) !important;\n}\n:deep(.activeRowPurple > .arco-table-td) {\n    background-color: rgb(240, 237, 248) !important;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}