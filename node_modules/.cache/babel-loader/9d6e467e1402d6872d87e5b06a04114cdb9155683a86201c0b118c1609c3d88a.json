{"ast":null,"code":"/**\n * @fileoverview 椭圆\n * @author dxq613@gmail.com\n */\nimport { __assign, __extends } from \"tslib\";\nimport ShapeBase from './base';\n// 根据椭圆公式计算 x*x/rx*rx + y*y/ry*ry;\nfunction ellipseDistance(squareX, squareY, rx, ry) {\n  return squareX / (rx * rx) + squareY / (ry * ry);\n}\nvar Ellipse = /** @class */function (_super) {\n  __extends(Ellipse, _super);\n  function Ellipse() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  Ellipse.prototype.getDefaultAttrs = function () {\n    var attrs = _super.prototype.getDefaultAttrs.call(this);\n    return __assign(__assign({}, attrs), {\n      x: 0,\n      y: 0,\n      rx: 0,\n      ry: 0\n    });\n  };\n  Ellipse.prototype.isInStrokeOrPath = function (x, y, isStroke, isFill, lineWidth) {\n    var attrs = this.attr();\n    var halfLineWith = lineWidth / 2;\n    var cx = attrs.x;\n    var cy = attrs.y;\n    var rx = attrs.rx,\n      ry = attrs.ry;\n    var squareX = (x - cx) * (x - cx);\n    var squareY = (y - cy) * (y - cy);\n    // 使用椭圆的公式： x*x/rx*rx + y*y/ry*ry = 1;\n    if (isFill && isStroke) {\n      return ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <= 1;\n    }\n    if (isFill) {\n      return ellipseDistance(squareX, squareY, rx, ry) <= 1;\n    }\n    if (isStroke) {\n      return ellipseDistance(squareX, squareY, rx - halfLineWith, ry - halfLineWith) >= 1 && ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <= 1;\n    }\n    return false;\n  };\n  Ellipse.prototype.createPath = function (context) {\n    var attrs = this.attr();\n    var cx = attrs.x;\n    var cy = attrs.y;\n    var rx = attrs.rx;\n    var ry = attrs.ry;\n    context.beginPath();\n    // 兼容逻辑\n    if (context.ellipse) {\n      context.ellipse(cx, cy, rx, ry, 0, 0, Math.PI * 2, false);\n    } else {\n      // 如果不支持，则使用圆来绘制，进行变形\n      var r = rx > ry ? rx : ry;\n      var scaleX = rx > ry ? 1 : rx / ry;\n      var scaleY = rx > ry ? ry / rx : 1;\n      context.save();\n      context.translate(cx, cy);\n      context.scale(scaleX, scaleY);\n      context.arc(0, 0, r, 0, Math.PI * 2);\n      context.restore();\n      context.closePath();\n    }\n  };\n  return Ellipse;\n}(ShapeBase);\nexport default Ellipse;","map":{"version":3,"mappings":"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","names":["ShapeBase","ellipseDistance","squareX","squareY","rx","ry","__extends","Ellipse","attrs","_super","getDefaultAttrs","x","y","isStroke","isFill","lineWidth","attr","halfLineWith","cx","cy","context","beginPath","ellipse","Math","PI","r","scaleX","scaleY","save","translate","scale","arc","restore","closePath"],"sourceRoot":"","sources":["../../src/shape/ellipse.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}