{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock, createCommentVNode as _createCommentVNode, vShow as _vShow, withDirectives as _withDirectives, Transition as _Transition } from \"vue\";\nconst _hoisted_1 = {\n  class: \"defaultPadding\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"span\", null, \"部门名称：\", -1 /* HOISTED */);\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"m-l-16\"\n}, \"客户名称：\", -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"m-l-16\"\n}, \"项目名称：\", -1 /* HOISTED */);\nconst _hoisted_5 = {\n  class: \"m-t-20 flex-between\"\n};\nconst _hoisted_6 = {\n  style: {\n    \"align-self\": \"flex-start\"\n  }\n};\nconst _hoisted_7 = {\n  class: \"m-b-20\"\n};\nconst _hoisted_8 = {\n  class: \"border-r\"\n};\nconst _hoisted_9 = {\n  style: {\n    \"align-self\": \"flex-start\"\n  }\n};\nconst _hoisted_10 = {\n  class: \"m-t-20\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_a_option = _resolveComponent(\"a-option\");\n  const _component_a_select = _resolveComponent(\"a-select\");\n  const _component_icon_search = _resolveComponent(\"icon-search\");\n  const _component_a_button = _resolveComponent(\"a-button\");\n  const _component_icon_refresh = _resolveComponent(\"icon-refresh\");\n  const _component_a_space = _resolveComponent(\"a-space\");\n  const _component_a_tag = _resolveComponent(\"a-tag\");\n  const _component_icon_up_circle = _resolveComponent(\"icon-up-circle\");\n  const _component_icon_down_circle = _resolveComponent(\"icon-down-circle\");\n  const _component_a_radio = _resolveComponent(\"a-radio\");\n  const _component_a_radio_group = _resolveComponent(\"a-radio-group\");\n  const _component_a_table = _resolveComponent(\"a-table\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", null, [_createVNode(_component_a_space, {\n    wrap: \"\"\n  }, {\n    default: _withCtx(() => [_hoisted_2, _createVNode(_component_a_select, {\n      style: {\n        width: '230px'\n      },\n      placeholder: \"输入并选择部门名称\",\n      \"allow-search\": \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Beijing\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Shanghai\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Guangzhou\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, {\n        disabled: \"\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"Disabled\")]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }), _hoisted_3, _createVNode(_component_a_select, {\n      style: {\n        width: '230px'\n      },\n      placeholder: \"输入并选择客户名称\",\n      \"allow-search\": \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Beijing\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Shanghai\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Guangzhou\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, {\n        disabled: \"\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"Disabled\")]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }), _hoisted_4, _createVNode(_component_a_select, {\n      style: {\n        width: '230px'\n      },\n      placeholder: \"输入项目名称\",\n      \"allow-search\": \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Beijing\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Shanghai\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, null, {\n        default: _withCtx(() => [_createTextVNode(\"Guangzhou\")]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_a_option, {\n        disabled: \"\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"Disabled\")]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_a_button, {\n      type: \"primary\",\n      style: {\n        \"margin-left\": \"16px\"\n      },\n      onClick: $setup.handleSearch\n    }, {\n      icon: _withCtx(() => [_createVNode(_component_icon_search)]),\n      default: _withCtx(() => [_createTextVNode(\"搜索\")]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_a_button, {\n      onClick: $setup.handleReset\n    }, {\n      icon: _withCtx(() => [_createVNode(_component_icon_refresh)]),\n      default: _withCtx(() => [_createTextVNode(\"重置\")]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_a_space, {\n    wrap: \"\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_a_space, null, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.tabChangeColumInfo.columnTabs, (item, index) => {\n        return _openBlock(), _createBlock(_component_a_tag, {\n          key: index,\n          color: item.isShow === 1 ? 'arcoblue' : '',\n          size: \"large\",\n          class: \"pointer\",\n          onClick: $event => $setup.handleTabChange(item)\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(item.title), 1 /* TEXT */)]),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"color\", \"onClick\"]);\n      }), 128 /* KEYED_FRAGMENT */))]),\n      _: 1 /* STABLE */\n    })]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.tabChangeColumInfo.up, (item, index) => {\n      return _openBlock(), _createBlock(_component_a_tag, {\n        key: index,\n        color: item.isShow === 1 ? 'arcoblue' : '',\n        size: \"large\",\n        class: \"pointer\",\n        onClick: $event => $setup.handleHasSonTabChange(item)\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString(item.title), 1 /* TEXT */)]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"color\", \"onClick\"]);\n    }), 128 /* KEYED_FRAGMENT */)), $setup.isFold ? (_openBlock(), _createBlock(_component_icon_up_circle, {\n      key: 0,\n      class: \"pointer\",\n      size: \"20\",\n      onClick: $setup.handleUp\n    })) : (_openBlock(), _createBlock(_component_icon_down_circle, {\n      key: 1,\n      class: \"pointer\",\n      size: \"20\",\n      onClick: $setup.handleDown\n    }))]),\n    _: 1 /* STABLE */\n  })]), _createVNode(_Transition, {\n    appear: \"\",\n    persisted: \"\"\n  }, {\n    default: _withCtx(() => [_withDirectives(_createElementVNode(\"div\", null, [_createVNode(_component_a_space, {\n      wrap: \"\"\n    }, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.tabChangeColumInfo.down, (item, index) => {\n        return _openBlock(), _createBlock(_component_a_tag, {\n          key: index,\n          color: item.isShow === 1 ? 'arcoblue' : '',\n          size: \"large\",\n          class: \"pointer\",\n          onClick: $event => $setup.handleHasSonTabChange(item)\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(item.title), 1 /* TEXT */)]),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"color\", \"onClick\"]);\n      }), 128 /* KEYED_FRAGMENT */))]),\n      _: 1 /* STABLE */\n    })], 512 /* NEED_PATCH */), [[_vShow, $setup.isFold]])]),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_a_radio_group, {\n    type: \"button\",\n    \"model-value\": $setup.selectMonth,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.selectMonth = $event),\n    size: \"large\",\n    onChange: $setup.handleMonthChange\n  }, {\n    default: _withCtx(() => [_createVNode(_component_a_radio, {\n      value: \"3\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"近3个月\")]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_a_radio, {\n      value: \"6\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"近6个月\")]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_a_radio, {\n      value: \"12\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"近12个月\")]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model-value\"])])]), _createElementVNode(\"div\", _hoisted_10, [_createVNode(_component_a_table, {\n    columns: $setup.tableInfo.columns,\n    data: $setup.tableInfo.data,\n    \"column-resizable\": \"\",\n    scroll: {\n      maxHeight: $setup.tableInfo.maxHeight\n    },\n    scrollbar: {\n      x: true,\n      y: 1500\n    },\n    pagination: false,\n    loading: $setup.tableInfo.loading,\n    bordered: {\n      cell: true\n    },\n    ref: \"tableRef\"\n  }, {\n    [$setup.canvasLine1]: _withCtx(({\n      record\n    }) => [_createVNode($setup[\"canvasVue\"], {\n      route: record[$setup.canvasLine1],\n      height: 20,\n      width: 50\n    }, null, 8 /* PROPS */, [\"route\"])]),\n    [$setup.canvasLine2]: _withCtx(({\n      record\n    }) => [_createVNode($setup[\"canvasVue\"], {\n      route: record[$setup.canvasLine2],\n      height: 20,\n      width: 50\n    }, null, 8 /* PROPS */, [\"route\"])]),\n    [$setup.canvasLine3]: _withCtx(({\n      record\n    }) => [_createVNode($setup[\"canvasVue\"], {\n      route: record[$setup.canvasLine3],\n      height: 20,\n      width: 50\n    }, null, 8 /* PROPS */, [\"route\"])]),\n    _: 2 /* DYNAMIC */\n  }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"columns\", \"data\", \"scroll\", \"loading\"])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","style","_createElementBlock","_hoisted_1","_createVNode","_component_a_space","wrap","default","_withCtx","_hoisted_2","_component_a_select","width","placeholder","_component_a_option","_createTextVNode","_","disabled","_hoisted_3","_hoisted_4","_component_a_button","type","onClick","$setup","handleSearch","icon","_component_icon_search","handleReset","_component_icon_refresh","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","tabChangeColumInfo","columnTabs","item","index","_createBlock","_component_a_tag","key","color","isShow","size","$event","handleTabChange","_toDisplayString","title","up","handleHasSonTabChange","isFold","_component_icon_up_circle","handleUp","_component_icon_down_circle","handleDown","_Transition","appear","persisted","down","_hoisted_9","_component_a_radio_group","selectMonth","_cache","onChange","handleMonthChange","_component_a_radio","value","_hoisted_10","_component_a_table","columns","tableInfo","data","scroll","maxHeight","scrollbar","x","y","pagination","loading","bordered","cell","ref","canvasLine1","record","route","height","canvasLine2","canvasLine3"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-oms-frontend/src/views/LeanAnalyze/loopAnalyze.vue"],"sourcesContent":["<template>\n  <div class=\"defaultPadding\">\n    <div>\n      <a-space wrap>\n        <span>部门名称：</span>\n        <a-select :style=\"{ width: '230px' }\" placeholder=\"输入并选择部门名称\" allow-search>\n          <a-option>Beijing</a-option>\n          <a-option>Shanghai</a-option>\n          <a-option>Guangzhou</a-option>\n          <a-option disabled>Disabled</a-option>\n        </a-select>\n        <span class=\"m-l-16\">客户名称：</span>\n        <a-select :style=\"{ width: '230px' }\" placeholder=\"输入并选择客户名称\" allow-search>\n          <a-option>Beijing</a-option>\n          <a-option>Shanghai</a-option>\n          <a-option>Guangzhou</a-option>\n          <a-option disabled>Disabled</a-option>\n        </a-select>\n        <span class=\"m-l-16\">项目名称：</span>\n        <a-select :style=\"{ width: '230px' }\" placeholder=\"输入项目名称\" allow-search>\n          <a-option>Beijing</a-option>\n          <a-option>Shanghai</a-option>\n          <a-option>Guangzhou</a-option>\n          <a-option disabled>Disabled</a-option>\n        </a-select>\n        <a-button type=\"primary\" style=\"margin-left: 16px\" @click=\"handleSearch\">\n          <template #icon>\n            <icon-search />\n          </template>\n          <template #default>搜索</template>\n        </a-button>\n        <a-button @click=\"handleReset\">\n          <template #icon>\n            <icon-refresh />\n          </template>\n          <template #default>重置</template>\n        </a-button>\n      </a-space>\n    </div>\n    <div class=\"m-t-20 flex-between\">\n      <div style=\"align-self: flex-start\">\n        <div class=\"m-b-20\">\n          <a-space wrap>\n            <div class=\"border-r\">\n              <a-space>\n                <a-tag\n                  v-for=\"(item, index) of tabChangeColumInfo.columnTabs\"\n                  :key=\"index\"\n                  :color=\"item.isShow === 1 ? 'arcoblue' : ''\"\n                  size=\"large\"\n                  class=\"pointer\"\n                  @click=\"handleTabChange(item)\"\n                >\n                  {{ item.title }}\n                </a-tag>\n              </a-space>\n            </div>\n            <a-tag\n              v-for=\"(item, index) of tabChangeColumInfo.up\"\n              :key=\"index\"\n              :color=\"item.isShow === 1 ? 'arcoblue' : ''\"\n              size=\"large\"\n              class=\"pointer\"\n              @click=\"handleHasSonTabChange(item)\"\n            >\n              {{ item.title }}\n            </a-tag>\n            <icon-up-circle class=\"pointer\" v-if=\"isFold\" size=\"20\" @click=\"handleUp\" />\n            <icon-down-circle class=\"pointer\" v-else size=\"20\" @click=\"handleDown\" />\n          </a-space>\n        </div>\n        <transition appear>\n          <div v-show=\"isFold\">\n            <a-space wrap>\n              <a-tag\n                v-for=\"(item, index) of tabChangeColumInfo.down\"\n                :key=\"index\"\n                :color=\"item.isShow === 1 ? 'arcoblue' : ''\"\n                size=\"large\"\n                class=\"pointer\"\n                @click=\"handleHasSonTabChange(item)\"\n              >\n                {{ item.title }}\n              </a-tag>\n            </a-space>\n          </div>\n        </transition>\n      </div>\n      <div style=\"align-self: flex-start\">\n        <a-radio-group type=\"button\" v-model:model-value=\"selectMonth\" size=\"large\" @change=\"handleMonthChange\">\n          <a-radio value=\"3\">近3个月</a-radio>\n          <a-radio value=\"6\">近6个月</a-radio>\n          <a-radio value=\"12\">近12个月</a-radio>\n        </a-radio-group>\n      </div>\n    </div>\n    <div class=\"m-t-20\">\n      <a-table\n        :columns=\"tableInfo.columns\"\n        :data=\"tableInfo.data\"\n        column-resizable\n        :scroll=\"{ maxHeight: tableInfo.maxHeight }\"\n        :scrollbar=\"{ x: true, y: 1500 }\"\n        :pagination=\"false\"\n        :loading=\"tableInfo.loading\"\n        :bordered=\"{ cell: true }\"\n        ref=\"tableRef\"\n      >\n        <template #[canvasLine1]=\"{ record }\">\n          <canvasVue :route=\"record[canvasLine1]\" :height=\"20\" :width=\"50\" />\n        </template>\n        <template #[canvasLine2]=\"{ record }\">\n          <canvasVue :route=\"record[canvasLine2]\" :height=\"20\" :width=\"50\" />\n        </template>\n        <template #[canvasLine3]=\"{ record }\">\n          <canvasVue :route=\"record[canvasLine3]\" :height=\"20\" :width=\"50\" />\n        </template>\n      </a-table>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { onBeforeMount, reactive, ref, nextTick, onMounted, toRaw } from \"vue\";\nimport { useTagColumnListStore } from \"../../store/index\";\nimport { getDepartmentRingList } from \"@/api/loopAnalyze.js\";\nimport { getNMonthsAgo } from \"../../utils/util\";\nimport canvasVue from \"@/components/canvasContainer.vue\";\nimport { Message } from \"@arco-design/web-vue\";\nlet tagColumnList = useTagColumnListStore();\nlet columConfig = {};\nconst isFold = ref(false);\nconst tableInfo = reactive({\n  columns: [],\n  data: [],\n  maxHeight: \"200px\",\n  loading: false,\n});\nconst selectMonth = ref(\"3\");\nconst tableRef = ref(null);\nconst tabChangeColumInfo = reactive({\n  columnTabs: [],\n  up: [],\n  down: [],\n});\nconst canvasLine1 = ref(\"\");\nconst canvasLine2 = ref(\"\");\nconst canvasLine3 = ref(\"\");\nonMounted(() => {\n  if (tableRef.value) {\n    let head = tableRef.value.$el;\n    nextTick(() => {\n      let innerHeight = window.innerHeight;\n      let elHeight = head.getBoundingClientRect().top;\n      tableInfo.maxHeight = innerHeight - elHeight - 30 + \"px\";\n    });\n  }\n});\n// 初始化\nconst seltColumns = () => {\n  let tagColumns = toRaw(tagColumnList.getTagColumnList) || [];\n  let currentPageColumn = tagColumns.filter(item => item.report === \"环比分析\") || [];\n  if (currentPageColumn.length) {\n    currentPageColumn[0].tier.forEach((item, index) => {\n      let tabs = [];\n      let columnTabs = [];\n      let columnHasSonTabs = [];\n      let noHiddenColumn = [];\n      let defaultColumHasSonTabs = [];\n      let defaultColumnTabs = [];\n      item.tags.forEach(jtem => {\n        tabs.push(jtem.tag);\n        jtem.columns.forEach(ktem => {\n          let { col, conf, title } = ktem;\n          conf = conf || {};\n          let columnItemConfig = {\n            title,\n            dataIndex: col,\n            align: conf.align,\n            cellStyle: { \"text-align\": conf.cellAlign },\n            width: conf.width,\n            ellipsis: true,\n            headerCellClass: \"noEllipsis\",\n            slotName: col,\n          };\n          columnItemConfig.isShow = conf.isShow;\n          if (conf.fixed !== undefined) {\n            columnItemConfig.fixed = conf.fixed;\n          }\n          if (conf.toFixed !== undefined) {\n            if (conf.showPercent) {\n              columnItemConfig.render = ({ record }) => {\n                return record[col];\n              };\n            } else {\n              columnItemConfig.render = ({ record }) => {\n                return record[col];\n              };\n            }\n          }\n          if (conf.canHide === 1) {\n            if (conf.parentCol === 0) {\n              columnTabs.push(columnItemConfig);\n            } else {\n              columnHasSonTabs.push(columnItemConfig);\n            }\n          } else {\n            noHiddenColumn.push(columnItemConfig);\n          }\n          if (conf.parentCol === 1) {\n            defaultColumHasSonTabs.push(columnItemConfig);\n          } else {\n            defaultColumnTabs.push(columnItemConfig);\n          }\n        });\n      });\n      columConfig[\"level\" + (index + 1)] = {\n        tabs,\n        params: item.params || [],\n        columnTabs,\n        columnHasSonTabs,\n        noHiddenColumn,\n        defaultColumnTabs,\n        defaultColumHasSonTabs,\n      };\n    });\n  }\n  tabChangeColumInfo.columnTabs = columConfig.level1.columnTabs;\n  tabChangeColumInfo.up = columConfig.level1.columnHasSonTabs.slice(0, 5);\n  tabChangeColumInfo.down = columConfig.level1.columnHasSonTabs.slice(5);\n};\nlet filterShowChildrenColumn = [];\n// 更换表头\nconst analysiisColumn = () => {\n  let { columnTabs, noHiddenColumn, defaultColumHasSonTabs } = columConfig.level1;\n  let num = 6;\n  switch (selectMonth.value) {\n    case \"3\":\n      let months1 = getNMonthsAgo(3);\n      let children1 = [];\n      let filterHasSonShowColumn1 = defaultColumHasSonTabs.filter(item => item.isShow === 1);\n      months1.forEach((item, i) => {\n        let columnHasSonConfig = {};\n        columnHasSonConfig.title = `${item[0]}年${item[1]}月`;\n        columnHasSonConfig.children = filterHasSonShowColumn1.map((jtem, j) => {\n          num++;\n          return {\n            ...jtem,\n            dataIndex: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n            slotName: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n          };\n        });\n        children1.push(columnHasSonConfig);\n      });\n      num = 0;\n      filterShowChildrenColumn = children1;\n      break;\n    case \"6\":\n      let months2 = getNMonthsAgo(6);\n      let children2 = [];\n      let filterHasSonShowColumn2 = defaultColumHasSonTabs.filter(item => item.isShow === 1);\n      months2.forEach((item, i) => {\n        let columnHasSonConfig = {};\n        columnHasSonConfig.title = `${item[0]}年${item[1]}月`;\n        columnHasSonConfig.children = filterHasSonShowColumn2.map((jtem, j) => {\n          num++;\n          return {\n            ...jtem,\n            dataIndex: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n            slotName: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n          };\n        });\n        children2.push(columnHasSonConfig);\n      });\n      num = 0;\n      filterShowChildrenColumn = children2;\n      break;\n    case \"12\":\n      let months3 = getNMonthsAgo(12);\n      let children3 = [];\n      let filterHasSonShowColumn3 = defaultColumHasSonTabs.filter(item => item.isShow === 1);\n      months3.forEach((item, i) => {\n        let columnHasSonConfig = {};\n        columnHasSonConfig.title = `${item[0]}年${item[1]}月`;\n        columnHasSonConfig.children = filterHasSonShowColumn3.map((jtem, j) => {\n          num++;\n          return {\n            ...jtem,\n            dataIndex: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n            slotName: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n          };\n        });\n        children3.push(columnHasSonConfig);\n      });\n      num = 0;\n      filterShowChildrenColumn = children3;\n      break;\n    default:\n      break;\n  }\n  filterShowChildrenColumn.forEach(item => {\n    if (item.children?.length) {\n      item.children = item.children.filter(jtem => jtem.isShow === 1);\n    }\n  });\n  let filterAllShowColumn = [...columnTabs.filter(item => item.isShow === 1), ...noHiddenColumn, ...filterShowChildrenColumn];\n  let number = 0;\n  filterAllShowColumn.forEach(item => {\n    number += 1;\n    if (!item.children) {\n      item.dataIndex = `colNo${number}`;\n      item.slotName = `colNo${number}`;\n    } else {\n      number = number - 1;\n      item.children.forEach(jtem => {\n        number += 1;\n        jtem.dataIndex = `colNo${number}`;\n        jtem.slotName = `colNo${number}`;\n      });\n    }\n  });\n  tableInfo.columns = filterAllShowColumn;\n  var index = tableInfo.columns.findIndex(item => item.children);\n  canvasLine3.value = tableInfo.columns[index - 1].dataIndex;\n  canvasLine2.value = tableInfo.columns[index - 2].dataIndex;\n  canvasLine1.value = tableInfo.columns[index - 3].dataIndex;\n};\n// 切换时间区间\nconst handleMonthChange = month => {\n  selectMonth.value = month;\n  analysiisColumn();\n  getList();\n};\nonBeforeMount(() => {\n  seltColumns();\n  analysiisColumn();\n  getList();\n});\n// 点击部门名称 客户名称\nconst handleTabChange = tab => {\n  switch (tab.isShow) {\n    case 0:\n      tab.isShow = 1;\n      changeShowStatus({\n        type: \"parent\",\n        title: tab.title,\n        val: 1,\n      });\n      break;\n    case 1:\n      tab.isShow = 0;\n      changeShowStatus({\n        type: \"parent\",\n        title: tab.title,\n        val: 0,\n      });\n      break;\n    default:\n      break;\n  }\n};\n// 点击部门名称 客户名称之外的标签\nconst handleHasSonTabChange = tab => {\n  switch (tab.isShow) {\n    case 0:\n      tab.isShow = 1;\n      changeShowStatus({\n        type: \"self\",\n        title: tab.title,\n        val: 1,\n      });\n      break;\n    case 1:\n      tab.isShow = 0;\n      changeShowStatus({\n        type: \"self\",\n        title: tab.title,\n        val: 0,\n      });\n      break;\n    default:\n      break;\n  }\n};\n// 更改高亮状态并更换表头\nconst changeShowStatus = obj => {\n  let { columnTabs, noHiddenColumn, defaultColumHasSonTabs } = columConfig.level1;\n  let columnsArr = [];\n  let filterHasSonShowColumn = defaultColumHasSonTabs.filter(item => item.isShow === 1);\n  if (obj.type === \"parent\") {\n    columnTabs.forEach(item => {\n      if (obj.title === item.title) {\n        item.isShow = obj.val;\n      }\n    });\n  }\n  if (obj.type === \"self\") {\n    defaultColumHasSonTabs.forEach(item => {\n      if (obj.title === item.title) {\n        item.isShow = obj.val;\n      }\n    });\n  }\n  let months = getNMonthsAgo(selectMonth.value);\n  let children = [];\n  let num = 0;\n  months.forEach((item, i) => {\n    let columnHasSonConfig = {};\n    columnHasSonConfig.title = `${item[0]}年${item[1]}月`;\n    columnHasSonConfig.children = filterHasSonShowColumn.map((jtem, j) => {\n      num++;\n      return {\n        ...jtem,\n        dataIndex: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n        slotName: `${item[0]}${(\"\" + item[1]).padStart(2, \"0\")}col${num}`,\n      };\n    });\n    children.push(columnHasSonConfig);\n  });\n  columnsArr = [...columnTabs.filter(item => item.isShow === 1), ...noHiddenColumn, ...children];\n  let number = 0;\n  columnsArr.forEach(item => {\n    number += 1;\n    if (!item.children) {\n      item.dataIndex = `colNo${number}`;\n      item.slotName = `colNo${number}`;\n    } else {\n      number = number - 1;\n      item.children.forEach(jtem => {\n        number += 1;\n        jtem.dataIndex = `colNo${number}`;\n        jtem.slotName = `colNo${number}`;\n      });\n    }\n  });\n  tableInfo.columns = columnsArr;\n  var index = tableInfo.columns.findIndex(item => item.children);\n  canvasLine3.value = tableInfo.columns[index - 1].dataIndex;\n  canvasLine2.value = tableInfo.columns[index - 2].dataIndex;\n  canvasLine1.value = tableInfo.columns[index - 3].dataIndex;\n  getList();\n};\n// 获取列表数据\nconst getList = () => {\n  tableInfo.data = [];\n  tableInfo.loading = true;\n  let arr = [];\n  var newColumns = JSON.parse(JSON.stringify(tableInfo.columns));\n  newColumns.forEach(item => {\n    if (item.title === \"部门名称\") {\n      arr.push(\"deptName\");\n    }\n    if (item.title === \"客户名称\") {\n      arr.push(\"customerName\");\n    }\n    if (item.title === \"项目名称\") {\n      arr.push(\"projectName\");\n    }\n    if (item.title === \"收入趋势\") {\n      arr.push(\"canvasLine1\");\n    }\n    if (item.title === \"成本趋势\") {\n      arr.push(\"canvasLine2\");\n    }\n    if (item.title === \"毛利率趋势\") {\n      arr.push(\"canvasLine3\");\n    }\n    if (item.children) {\n      item.children.forEach(jtem => {\n        if (jtem.title === \"人数\") {\n          arr.push(\"colNo1\");\n        }\n        if (jtem.title === \"营业收入\") {\n          arr.push(\"colNo2\");\n        }\n        if (jtem.title === \"销售毛利\") {\n          arr.push(\"colNo3\");\n        }\n        if (jtem.title === \"销售毛利率\") {\n          arr.push(\"colNo4\");\n        }\n        if (jtem.title === \"直接成本\") {\n          arr.push(\"colNo5\");\n        }\n        if (jtem.title === \"人均营业收入\") {\n          arr.push(\"colNo6\");\n        }\n        if (jtem.title === \"人均直接成本\") {\n          arr.push(\"colNo7\");\n        }\n        if (jtem.title === \"未完工项目成本\") {\n          arr.push(\"colNo8\");\n        }\n        if (jtem.title === \"招聘费用\") {\n          arr.push(\"colNo9\");\n        }\n        if (jtem.title === \"销售费用\") {\n          arr.push(\"colNo10\");\n        }\n        if (jtem.title === \"管理费用\") {\n          arr.push(\"colNo11\");\n        }\n      });\n    }\n  });\n  const params = {\n    interval: Number(selectMonth.value),\n    dynamicHeaderParam: Array.from(new Set(arr)),\n    xAxis: 50,\n    yAxis: 20,\n  };\n  getDepartmentRingList(params)\n    .then(res => {\n      if (res.code == \"200\") {\n        tableInfo.data = res.data;\n      }\n    })\n    .catch(e => {\n      Message.error(e.message || \"请求失败\");\n    })\n    .finally(() => {\n      tableInfo.loading = false;\n    });\n};\n// 查询\nconst handleSearch = () => {\n  getList();\n};\n// 重置\nconst handleReset = () => {};\n// 打开\nconst handleUp = () => {\n  isFold.value = false;\n};\n// 关闭\nconst handleDown = () => {\n  isFold.value = true;\n};\n</script>\n\n<style lang=\"scss\">\n.draw-enter-active,\n.draw-leave-active {\n  transition: all 0.2s;\n}\n.draw-enter-from,\n.draw-leave-to {\n  max-height: 0;\n}\n.border-r {\n  padding-right: 10px;\n  border-right: 1px solid #ebebeb;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}