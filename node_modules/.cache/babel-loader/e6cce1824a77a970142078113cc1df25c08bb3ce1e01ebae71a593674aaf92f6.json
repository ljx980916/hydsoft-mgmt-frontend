{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nvar WILDCARD = '*';\n/* event-emitter */\nvar EventEmitter = /** @class */function () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * 监听一个事件\n   * @param evt\n   * @param callback\n   * @param once\n   */\n  EventEmitter.prototype.on = function (evt, callback, once) {\n    if (!this._events[evt]) {\n      this._events[evt] = [];\n    }\n    this._events[evt].push({\n      callback: callback,\n      once: !!once\n    });\n    return this;\n  };\n  /**\n   * 监听一个事件一次\n   * @param evt\n   * @param callback\n   */\n  EventEmitter.prototype.once = function (evt, callback) {\n    return this.on(evt, callback, true);\n  };\n  /**\n   * 触发一个事件\n   * @param evt\n   * @param args\n   */\n  EventEmitter.prototype.emit = function (evt) {\n    var _this = this;\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n    var events = this._events[evt] || [];\n    var wildcardEvents = this._events[WILDCARD] || [];\n    // 实际的处理 emit 方法\n    var doEmit = function (es) {\n      var length = es.length;\n      for (var i = 0; i < length; i++) {\n        if (!es[i]) {\n          continue;\n        }\n        var _a = es[i],\n          callback = _a.callback,\n          once = _a.once;\n        if (once) {\n          es.splice(i, 1);\n          if (es.length === 0) {\n            delete _this._events[evt];\n          }\n          length--;\n          i--;\n        }\n        callback.apply(_this, args);\n      }\n    };\n    doEmit(events);\n    doEmit(wildcardEvents);\n  };\n  /**\n   * 取消监听一个事件，或者一个channel\n   * @param evt\n   * @param callback\n   */\n  EventEmitter.prototype.off = function (evt, callback) {\n    if (!evt) {\n      // evt 为空全部清除\n      this._events = {};\n    } else {\n      if (!callback) {\n        // evt 存在，callback 为空，清除事件所有方法\n        delete this._events[evt];\n      } else {\n        // evt 存在，callback 存在，清除匹配的\n        var events = this._events[evt] || [];\n        var length_1 = events.length;\n        for (var i = 0; i < length_1; i++) {\n          if (events[i].callback === callback) {\n            events.splice(i, 1);\n            length_1--;\n            i--;\n          }\n        }\n        if (events.length === 0) {\n          delete this._events[evt];\n        }\n      }\n    }\n    return this;\n  };\n  /* 当前所有的事件 */\n  EventEmitter.prototype.getEvents = function () {\n    return this._events;\n  };\n  return EventEmitter;\n}();\nexport default EventEmitter;","map":{"version":3,"mappings":"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","names":["WILDCARD","EventEmitter","evt","callback","once","_events","push","on","_i","args","events","wildcardEvents","doEmit","es","length","i","splice","_this","apply","length_1"],"sourceRoot":"","sources":["../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}