{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.unshift.js\";\nimport { __extends } from \"tslib\";\nimport { each, isEqual, isFunction, isNumber, isObject, isArray, noop, mix, upperFirst, uniqueId } from '@antv/util';\nimport { ext } from '@antv/matrix-util';\nimport { removeFromArray, isParent } from '../util/util';\nimport { multiplyMatrix, multiplyVec2, invert } from '../util/matrix';\nimport Base from './base';\nvar transform = ext.transform;\nvar MATRIX = 'matrix';\nvar CLONE_CFGS = ['zIndex', 'capture', 'visible', 'type'];\n// 可以在 toAttrs 中设置，但不属于绘图属性的字段\nvar RESERVED_PORPS = ['repeat'];\nvar DELEGATION_SPLIT = ':';\nvar WILDCARD = '*';\n// 需要考虑数组嵌套数组的场景\n// 数组嵌套对象的场景不考虑\nfunction _cloneArrayAttr(arr) {\n  var result = [];\n  for (var i = 0; i < arr.length; i++) {\n    if (isArray(arr[i])) {\n      result.push([].concat(arr[i]));\n    } else {\n      result.push(arr[i]);\n    }\n  }\n  return result;\n}\nfunction getFormatFromAttrs(toAttrs, shape) {\n  var fromAttrs = {};\n  var attrs = shape.attrs;\n  for (var k in toAttrs) {\n    fromAttrs[k] = attrs[k];\n  }\n  return fromAttrs;\n}\nfunction getFormatToAttrs(props, shape) {\n  var toAttrs = {};\n  var attrs = shape.attr();\n  each(props, function (v, k) {\n    if (RESERVED_PORPS.indexOf(k) === -1 && !isEqual(attrs[k], v)) {\n      toAttrs[k] = v;\n    }\n  });\n  return toAttrs;\n}\nfunction checkExistedAttrs(animations, animation) {\n  if (animation.onFrame) {\n    return animations;\n  }\n  var startTime = animation.startTime,\n    delay = animation.delay,\n    duration = animation.duration;\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  each(animations, function (item) {\n    // 后一个动画开始执行的时间 < 前一个动画的结束时间 && 后一个动画的执行时间 > 前一个动画的延迟\n    if (startTime + delay < item.startTime + item.delay + item.duration && duration > item.delay) {\n      each(animation.toAttrs, function (v, k) {\n        if (hasOwnProperty.call(item.toAttrs, k)) {\n          delete item.toAttrs[k];\n          delete item.fromAttrs[k];\n        }\n      });\n    }\n  });\n  return animations;\n}\nvar Element = /** @class */function (_super) {\n  __extends(Element, _super);\n  function Element(cfg) {\n    var _this = _super.call(this, cfg) || this;\n    /**\n     * @protected\n     * 图形属性\n     * @type {ShapeAttrs}\n     */\n    _this.attrs = {};\n    var attrs = _this.getDefaultAttrs();\n    mix(attrs, cfg.attrs);\n    _this.attrs = attrs;\n    _this.initAttrs(attrs);\n    _this.initAnimate(); // 初始化动画\n    return _this;\n  }\n  // override\n  Element.prototype.getDefaultCfg = function () {\n    return {\n      visible: true,\n      capture: true,\n      zIndex: 0\n    };\n  };\n  /**\n   * @protected\n   * 获取默认的属相\n   */\n  Element.prototype.getDefaultAttrs = function () {\n    return {\n      matrix: this.getDefaultMatrix(),\n      opacity: 1\n    };\n  };\n  /**\n   * @protected\n   * 一些方法调用会引起画布变化\n   * @param {ChangeType} changeType 改变的类型\n   */\n  Element.prototype.onCanvasChange = function (changeType) {};\n  /**\n   * @protected\n   * 初始化属性，有些属性需要加工\n   * @param {object} attrs 属性值\n   */\n  Element.prototype.initAttrs = function (attrs) {};\n  /**\n   * @protected\n   * 初始化动画\n   */\n  Element.prototype.initAnimate = function () {\n    this.set('animable', true);\n    this.set('animating', false);\n  };\n  Element.prototype.isGroup = function () {\n    return false;\n  };\n  Element.prototype.getParent = function () {\n    return this.get('parent');\n  };\n  Element.prototype.getCanvas = function () {\n    return this.get('canvas');\n  };\n  Element.prototype.attr = function () {\n    var _a;\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    var name = args[0],\n      value = args[1];\n    if (!name) return this.attrs;\n    if (isObject(name)) {\n      for (var k in name) {\n        this.setAttr(k, name[k]);\n      }\n      this.afterAttrsChange(name);\n      return this;\n    }\n    if (args.length === 2) {\n      this.setAttr(name, value);\n      this.afterAttrsChange((_a = {}, _a[name] = value, _a));\n      return this;\n    }\n    return this.attrs[name];\n  };\n  // 是否被裁剪，被裁剪则不显示，不参与拾取\n  Element.prototype.isClipped = function (refX, refY) {\n    var clip = this.getClip();\n    return clip && !clip.isHit(refX, refY);\n  };\n  /**\n   * 内部设置属性值的接口\n   * @param {string} name 属性名\n   * @param {any} value 属性值\n   */\n  Element.prototype.setAttr = function (name, value) {\n    var originValue = this.attrs[name];\n    if (originValue !== value) {\n      this.attrs[name] = value;\n      this.onAttrChange(name, value, originValue);\n    }\n  };\n  /**\n   * @protected\n   * 属性值发生改变\n   * @param {string} name 属性名\n   * @param {any} value 属性值\n   * @param {any} originValue 属性值\n   */\n  Element.prototype.onAttrChange = function (name, value, originValue) {\n    if (name === 'matrix') {\n      this.set('totalMatrix', null);\n    }\n  };\n  /**\n   * 属性更改后需要做的事情\n   * @protected\n   */\n  Element.prototype.afterAttrsChange = function (targetAttrs) {\n    if (this.cfg.isClipShape) {\n      var applyTo = this.cfg.applyTo;\n      if (applyTo) {\n        applyTo.onCanvasChange('clip');\n      }\n    } else {\n      this.onCanvasChange('attr');\n    }\n  };\n  Element.prototype.show = function () {\n    // 不是高频操作直接使用 set\n    this.set('visible', true);\n    this.onCanvasChange('show');\n    return this;\n  };\n  Element.prototype.hide = function () {\n    // 不是高频操作直接使用 set\n    this.set('visible', false);\n    this.onCanvasChange('hide');\n    return this;\n  };\n  Element.prototype.setZIndex = function (zIndex) {\n    this.set('zIndex', zIndex);\n    var parent = this.getParent();\n    if (parent) {\n      // 改变 zIndex 不应该立即触发渲染 (调用 onCanvasChange('zIndex'))，需要经过 sort 再触发\n      parent.sort();\n    }\n    return this;\n  };\n  Element.prototype.toFront = function () {\n    var parent = this.getParent();\n    if (!parent) {\n      return;\n    }\n    var children = parent.getChildren();\n    var el = this.get('el');\n    var index = children.indexOf(this);\n    children.splice(index, 1);\n    children.push(this);\n    this.onCanvasChange('zIndex');\n  };\n  Element.prototype.toBack = function () {\n    var parent = this.getParent();\n    if (!parent) {\n      return;\n    }\n    var children = parent.getChildren();\n    var el = this.get('el');\n    var index = children.indexOf(this);\n    children.splice(index, 1);\n    children.unshift(this);\n    this.onCanvasChange('zIndex');\n  };\n  Element.prototype.remove = function (destroy) {\n    if (destroy === void 0) {\n      destroy = true;\n    }\n    var parent = this.getParent();\n    if (parent) {\n      removeFromArray(parent.getChildren(), this);\n      if (!parent.get('clearing')) {\n        // 如果父元素正在清理，当前元素不触发 remove\n        this.onCanvasChange('remove');\n      }\n    } else {\n      this.onCanvasChange('remove');\n    }\n    if (destroy) {\n      this.destroy();\n    }\n  };\n  Element.prototype.resetMatrix = function () {\n    this.attr(MATRIX, this.getDefaultMatrix());\n    this.onCanvasChange('matrix');\n  };\n  Element.prototype.getMatrix = function () {\n    return this.attr(MATRIX);\n  };\n  Element.prototype.setMatrix = function (m) {\n    this.attr(MATRIX, m);\n    this.onCanvasChange('matrix');\n  };\n  // 获取总的 matrix\n  Element.prototype.getTotalMatrix = function () {\n    var totalMatrix = this.cfg.totalMatrix;\n    if (!totalMatrix) {\n      var currentMatrix = this.attr('matrix');\n      var parentMatrix = this.cfg.parentMatrix;\n      if (parentMatrix && currentMatrix) {\n        totalMatrix = multiplyMatrix(parentMatrix, currentMatrix);\n      } else {\n        totalMatrix = currentMatrix || parentMatrix;\n      }\n      this.set('totalMatrix', totalMatrix);\n    }\n    return totalMatrix;\n  };\n  // 上层分组设置 matrix\n  Element.prototype.applyMatrix = function (matrix) {\n    var currentMatrix = this.attr('matrix');\n    var totalMatrix = null;\n    if (matrix && currentMatrix) {\n      totalMatrix = multiplyMatrix(matrix, currentMatrix);\n    } else {\n      totalMatrix = currentMatrix || matrix;\n    }\n    this.set('totalMatrix', totalMatrix);\n    this.set('parentMatrix', matrix);\n  };\n  /**\n   * @protected\n   * 获取默认的矩阵\n   * @returns {number[]|null} 默认的矩阵\n   */\n  Element.prototype.getDefaultMatrix = function () {\n    return null;\n  };\n  // 将向量应用设置的矩阵\n  Element.prototype.applyToMatrix = function (v) {\n    var matrix = this.attr('matrix');\n    if (matrix) {\n      return multiplyVec2(matrix, v);\n    }\n    return v;\n  };\n  // 根据设置的矩阵，将向量转换相对于图形/分组的位置\n  Element.prototype.invertFromMatrix = function (v) {\n    var matrix = this.attr('matrix');\n    if (matrix) {\n      var invertMatrix = invert(matrix);\n      if (invertMatrix) {\n        return multiplyVec2(invertMatrix, v);\n      }\n    }\n    return v;\n  };\n  // 设置 clip\n  Element.prototype.setClip = function (clipCfg) {\n    var canvas = this.getCanvas();\n    // 应该只设置当前元素的 clip，不应该去修改 clip 本身，方便 clip 被复用\n    // TODO: setClip 的传参既 shape 配置，也支持 shape 对象\n    // const preShape = this.get('clipShape');\n    // if (preShape) {\n    //   // 将之前的 clipShape 销毁\n    //   preShape.destroy();\n    // }\n    var clipShape = null;\n    // 如果配置项为 null，则不移除 clipShape\n    if (clipCfg) {\n      var ShapeBase = this.getShapeBase();\n      var shapeType = upperFirst(clipCfg.type);\n      var Cons = ShapeBase[shapeType];\n      if (Cons) {\n        clipShape = new Cons({\n          type: clipCfg.type,\n          isClipShape: true,\n          applyTo: this,\n          attrs: clipCfg.attrs,\n          canvas: canvas\n        });\n      }\n    }\n    this.set('clipShape', clipShape);\n    this.onCanvasChange('clip');\n    return clipShape;\n  };\n  Element.prototype.getClip = function () {\n    // 高频率调用的地方直接使用 this.cfg.xxx\n    var clipShape = this.cfg.clipShape;\n    // 未设置时返回 Null，保证一致性\n    if (!clipShape) {\n      return null;\n    }\n    return clipShape;\n  };\n  Element.prototype.clone = function () {\n    var _this = this;\n    var originAttrs = this.attrs;\n    var attrs = {};\n    each(originAttrs, function (i, k) {\n      if (isArray(originAttrs[k])) {\n        attrs[k] = _cloneArrayAttr(originAttrs[k]);\n      } else {\n        attrs[k] = originAttrs[k];\n      }\n    });\n    var cons = this.constructor;\n    // @ts-ignore\n    var clone = new cons({\n      attrs: attrs\n    });\n    each(CLONE_CFGS, function (cfgName) {\n      clone.set(cfgName, _this.get(cfgName));\n    });\n    return clone;\n  };\n  Element.prototype.destroy = function () {\n    var destroyed = this.destroyed;\n    if (destroyed) {\n      return;\n    }\n    this.attrs = {};\n    _super.prototype.destroy.call(this);\n    // this.onCanvasChange('destroy');\n  };\n  /**\n   * 是否处于动画暂停状态\n   * @return {boolean} 是否处于动画暂停状态\n   */\n  Element.prototype.isAnimatePaused = function () {\n    return this.get('_pause').isPaused;\n  };\n  /**\n   * 执行动画，支持多种函数签名\n   * 1. animate(toAttrs: ElementAttrs, duration: number, easing?: string, callback?: () => void, delay?: number)\n   * 2. animate(onFrame: OnFrame, duration: number, easing?: string, callback?: () => void, delay?: number)\n   * 3. animate(toAttrs: ElementAttrs, cfg: AnimateCfg)\n   * 4. animate(onFrame: OnFrame, cfg: AnimateCfg)\n   * 各个参数的含义为:\n   *   toAttrs  动画最终状态\n   *   onFrame  自定义帧动画函数\n   *   duration 动画执行时间\n   *   easing   动画缓动效果\n   *   callback 动画执行后的回调\n   *   delay    动画延迟时间\n   */\n  Element.prototype.animate = function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    if (!this.get('timeline') && !this.get('canvas')) {\n      return;\n    }\n    this.set('animating', true);\n    var timeline = this.get('timeline');\n    if (!timeline) {\n      timeline = this.get('canvas').get('timeline');\n      this.set('timeline', timeline);\n    }\n    var animations = this.get('animations') || [];\n    // 初始化 tick\n    if (!timeline.timer) {\n      timeline.initTimer();\n    }\n    var toAttrs = args[0],\n      duration = args[1],\n      _a = args[2],\n      easing = _a === void 0 ? 'easeLinear' : _a,\n      _b = args[3],\n      callback = _b === void 0 ? noop : _b,\n      _c = args[4],\n      delay = _c === void 0 ? 0 : _c;\n    var onFrame;\n    var repeat;\n    var pauseCallback;\n    var resumeCallback;\n    var animateCfg;\n    // 第二个参数，既可以是动画最终状态 toAttrs，也可以是自定义帧动画函数 onFrame\n    if (isFunction(toAttrs)) {\n      onFrame = toAttrs;\n      toAttrs = {};\n    } else if (isObject(toAttrs) && toAttrs.onFrame) {\n      // 兼容 3.0 中的写法，onFrame 和 repeat 可在 toAttrs 中设置\n      onFrame = toAttrs.onFrame;\n      repeat = toAttrs.repeat;\n    }\n    // 第二个参数，既可以是执行时间 duration，也可以是动画参数 animateCfg\n    if (isObject(duration)) {\n      animateCfg = duration;\n      duration = animateCfg.duration;\n      easing = animateCfg.easing || 'easeLinear';\n      delay = animateCfg.delay || 0;\n      // animateCfg 中的设置优先级更高\n      repeat = animateCfg.repeat || repeat || false;\n      callback = animateCfg.callback || noop;\n      pauseCallback = animateCfg.pauseCallback || noop;\n      resumeCallback = animateCfg.resumeCallback || noop;\n    } else {\n      // 第四个参数，既可以是回调函数 callback，也可以是延迟时间 delay\n      if (isNumber(callback)) {\n        delay = callback;\n        callback = null;\n      }\n      // 第三个参数，既可以是缓动参数 easing，也可以是回调函数 callback\n      if (isFunction(easing)) {\n        callback = easing;\n        easing = 'easeLinear';\n      } else {\n        easing = easing || 'easeLinear';\n      }\n    }\n    var formatToAttrs = getFormatToAttrs(toAttrs, this);\n    var animation = {\n      fromAttrs: getFormatFromAttrs(formatToAttrs, this),\n      toAttrs: formatToAttrs,\n      duration: duration,\n      easing: easing,\n      repeat: repeat,\n      callback: callback,\n      pauseCallback: pauseCallback,\n      resumeCallback: resumeCallback,\n      delay: delay,\n      startTime: timeline.getTime(),\n      id: uniqueId(),\n      onFrame: onFrame,\n      pathFormatted: false\n    };\n    // 如果动画元素队列中已经有这个图形了\n    if (animations.length > 0) {\n      // 先检查是否需要合并属性。若有相同的动画，将该属性从前一个动画中删除,直接用后一个动画中\n      animations = checkExistedAttrs(animations, animation);\n    } else {\n      // 否则将图形添加到动画元素队列\n      timeline.addAnimator(this);\n    }\n    animations.push(animation);\n    this.set('animations', animations);\n    this.set('_pause', {\n      isPaused: false\n    });\n  };\n  /**\n   * 停止动画\n   * @param {boolean} toEnd 是否到动画的最终状态\n   */\n  Element.prototype.stopAnimate = function (toEnd) {\n    var _this = this;\n    if (toEnd === void 0) {\n      toEnd = true;\n    }\n    var animations = this.get('animations');\n    each(animations, function (animation) {\n      // 将动画执行到最后一帧\n      if (toEnd) {\n        if (animation.onFrame) {\n          _this.attr(animation.onFrame(1));\n        } else {\n          _this.attr(animation.toAttrs);\n        }\n      }\n      if (animation.callback) {\n        // 动画停止时的回调\n        animation.callback();\n      }\n    });\n    this.set('animating', false);\n    this.set('animations', []);\n  };\n  /**\n   * 暂停动画\n   */\n  Element.prototype.pauseAnimate = function () {\n    var timeline = this.get('timeline');\n    var animations = this.get('animations');\n    var pauseTime = timeline.getTime();\n    each(animations, function (animation) {\n      animation._paused = true;\n      animation._pauseTime = pauseTime;\n      if (animation.pauseCallback) {\n        // 动画暂停时的回调\n        animation.pauseCallback();\n      }\n    });\n    // 记录下是在什么时候暂停的\n    this.set('_pause', {\n      isPaused: true,\n      pauseTime: pauseTime\n    });\n    return this;\n  };\n  /**\n   * 恢复动画\n   */\n  Element.prototype.resumeAnimate = function () {\n    var timeline = this.get('timeline');\n    var current = timeline.getTime();\n    var animations = this.get('animations');\n    var pauseTime = this.get('_pause').pauseTime;\n    // 之后更新属性需要计算动画已经执行的时长，如果暂停了，就把初始时间调后\n    each(animations, function (animation) {\n      animation.startTime = animation.startTime + (current - pauseTime);\n      animation._paused = false;\n      animation._pauseTime = null;\n      if (animation.resumeCallback) {\n        animation.resumeCallback();\n      }\n    });\n    this.set('_pause', {\n      isPaused: false\n    });\n    this.set('animations', animations);\n    return this;\n  };\n  /**\n   * 触发委托事件\n   * @param  {string}     type 事件类型\n   * @param  {GraphEvent} eventObj 事件对象\n   */\n  Element.prototype.emitDelegation = function (type, eventObj) {\n    var _this = this;\n    var paths = eventObj.propagationPath;\n    var events = this.getEvents();\n    var relativeShape;\n    if (type === 'mouseenter') {\n      relativeShape = eventObj.fromShape;\n    } else if (type === 'mouseleave') {\n      relativeShape = eventObj.toShape;\n    }\n    var _loop_1 = function (i) {\n      var element = paths[i];\n      // 暂定跟 name 绑定\n      var name_1 = element.get('name');\n      if (name_1) {\n        // 第一个 mouseenter 和 mouseleave 的停止即可，因为后面的都是前面的 Parent\n        if (\n        // 只有 element 是 Group 或者 Canvas 的时候，才需要判断 isParent\n        (element.isGroup() || element.isCanvas && element.isCanvas()) && relativeShape && isParent(element, relativeShape)) {\n          return \"break\";\n        }\n        if (isArray(name_1)) {\n          each(name_1, function (subName) {\n            _this.emitDelegateEvent(element, subName, eventObj);\n          });\n        } else {\n          this_1.emitDelegateEvent(element, name_1, eventObj);\n        }\n      }\n    };\n    var this_1 = this;\n    // 至少有一个对象，且第一个对象为 shape\n    for (var i = 0; i < paths.length; i++) {\n      var state_1 = _loop_1(i);\n      if (state_1 === \"break\") break;\n    }\n  };\n  Element.prototype.emitDelegateEvent = function (element, name, eventObj) {\n    var events = this.getEvents();\n    // 事件委托的形式 name:type\n    var eventName = name + DELEGATION_SPLIT + eventObj.type;\n    if (events[eventName] || events[WILDCARD]) {\n      // 对于通配符 *，事件名称 = 委托事件名称\n      eventObj.name = eventName;\n      eventObj.currentTarget = element;\n      eventObj.delegateTarget = this;\n      // 将委托事件的监听对象 delegateObject 挂载到事件对象上\n      eventObj.delegateObject = element.get('delegateObject');\n      this.emit(eventName, eventObj);\n    }\n  };\n  /**\n   * 移动元素\n   * @param {number} translateX 水平移动距离\n   * @param {number} translateY 垂直移动距离\n   * @return {IElement} 元素\n   */\n  Element.prototype.translate = function (translateX, translateY) {\n    if (translateX === void 0) {\n      translateX = 0;\n    }\n    if (translateY === void 0) {\n      translateY = 0;\n    }\n    var matrix = this.getMatrix();\n    var newMatrix = transform(matrix, [['t', translateX, translateY]]);\n    this.setMatrix(newMatrix);\n    return this;\n  };\n  /**\n   * 移动元素到目标位置\n   * @param {number} targetX 目标位置的水平坐标\n   * @param {number} targetX 目标位置的垂直坐标\n   * @return {IElement} 元素\n   */\n  Element.prototype.move = function (targetX, targetY) {\n    var x = this.attr('x') || 0;\n    var y = this.attr('y') || 0;\n    this.translate(targetX - x, targetY - y);\n    return this;\n  };\n  /**\n   * 移动元素到目标位置，等价于 move 方法。由于 moveTo 的语义性更强，因此在文档中推荐使用 moveTo 方法\n   * @param {number} targetX 目标位置的 x 轴坐标\n   * @param {number} targetY 目标位置的 y 轴坐标\n   * @return {IElement} 元素\n   */\n  Element.prototype.moveTo = function (targetX, targetY) {\n    return this.move(targetX, targetY);\n  };\n  /**\n   * 缩放元素\n   * @param {number} ratioX 水平缩放比例\n   * @param {number} ratioY 垂直缩放比例\n   * @return {IElement} 元素\n   */\n  Element.prototype.scale = function (ratioX, ratioY) {\n    var matrix = this.getMatrix();\n    var newMatrix = transform(matrix, [['s', ratioX, ratioY || ratioX]]);\n    this.setMatrix(newMatrix);\n    return this;\n  };\n  /**\n   * 以画布左上角 (0, 0) 为中心旋转元素\n   * @param {number} radian 旋转角度(弧度值)\n   * @return {IElement} 元素\n   */\n  Element.prototype.rotate = function (radian) {\n    var matrix = this.getMatrix();\n    var newMatrix = transform(matrix, [['r', radian]]);\n    this.setMatrix(newMatrix);\n    return this;\n  };\n  /**\n   * 以起始点为中心旋转元素\n   * @param {number} radian 旋转角度(弧度值)\n   * @return {IElement} 元素\n   */\n  Element.prototype.rotateAtStart = function (rotate) {\n    var _a = this.attr(),\n      x = _a.x,\n      y = _a.y;\n    var matrix = this.getMatrix();\n    var newMatrix = transform(matrix, [['t', -x, -y], ['r', rotate], ['t', x, y]]);\n    this.setMatrix(newMatrix);\n    return this;\n  };\n  /**\n   * 以任意点 (x, y) 为中心旋转元素\n   * @param {number} radian 旋转角度(弧度值)\n   * @return {IElement} 元素\n   */\n  Element.prototype.rotateAtPoint = function (x, y, rotate) {\n    var matrix = this.getMatrix();\n    var newMatrix = transform(matrix, [['t', -x, -y], ['r', rotate], ['t', x, y]]);\n    this.setMatrix(newMatrix);\n    return this;\n  };\n  return Element;\n}(Base);\nexport default Element;","map":{"version":3,"mappings":";;;AAAA,SAASA,IAAI,EAAEC,OAAO,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,IAAI,EAAEC,GAAG,EAAEC,UAAU,EAAEC,QAAQ,QAAQ,YAAY;AACpH,SAASC,GAAG,QAAQ,mBAAmB;AAGvC,SAASC,eAAe,EAAEC,QAAQ,QAAQ,cAAc;AACxD,SAASC,cAAc,EAAEC,YAAY,EAAEC,MAAM,QAAQ,gBAAgB;AACrE,OAAOC,IAAI,MAAM,QAAQ;AAGjB,aAAS,GAAKN,GAAG,UAAR;AAEjB,IAAMO,MAAM,GAAG,QAAQ;AACvB,IAAMC,UAAU,GAAG,CAAC,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,CAAC;AAE3D;AACA,IAAMC,cAAc,GAAG,CAAC,QAAQ,CAAC;AAEjC,IAAMC,gBAAgB,GAAG,GAAG;AAC5B,IAAMC,QAAQ,GAAG,GAAG;AAEpB;AACA;AACA,SAASC,eAAe,CAACC,GAAG;EAC1B,IAAMC,MAAM,GAAG,EAAE;EACjB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,GAAG,CAACG,MAAM,EAAED,CAAC,EAAE,EAAE;IACnC,IAAIpB,OAAO,CAACkB,GAAG,CAACE,CAAC,CAAC,CAAC,EAAE;MACnBD,MAAM,CAACG,IAAI,CAAC,EAAE,CAACC,MAAM,CAACL,GAAG,CAACE,CAAC,CAAC,CAAC,CAAC;KAC/B,MAAM;MACLD,MAAM,CAACG,IAAI,CAACJ,GAAG,CAACE,CAAC,CAAC,CAAC;;;EAGvB,OAAOD,MAAM;AACf;AAEA,SAASK,kBAAkB,CAACC,OAAO,EAAEC,KAAK;EACxC,IAAMC,SAAS,GAAG,EAAE;EACpB,IAAMC,KAAK,GAAGF,KAAK,CAACE,KAAK;EACzB,KAAK,IAAMC,CAAC,IAAIJ,OAAO,EAAE;IACvBE,SAAS,CAACE,CAAC,CAAC,GAAGD,KAAK,CAACC,CAAC,CAAC;;EAEzB,OAAOF,SAAS;AAClB;AAEA,SAASG,gBAAgB,CAACC,KAAK,EAAEL,KAAK;EACpC,IAAMD,OAAO,GAAG,EAAE;EAClB,IAAMG,KAAK,GAAGF,KAAK,CAACM,IAAI,EAAE;EAC1BrC,IAAI,CAACoC,KAAK,EAAE,UAACE,CAAC,EAAEJ,CAAC;IACf,IAAIf,cAAc,CAACoB,OAAO,CAACL,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAACjC,OAAO,CAACgC,KAAK,CAACC,CAAC,CAAC,EAAEI,CAAC,CAAC,EAAE;MAC7DR,OAAO,CAACI,CAAC,CAAC,GAAGI,CAAC;;EAElB,CAAC,CAAC;EACF,OAAOR,OAAO;AAChB;AAEA,SAASU,iBAAiB,CAACC,UAAuB,EAAEC,SAAoB;EACtE,IAAIA,SAAS,CAACC,OAAO,EAAE;IACrB,OAAOF,UAAU;;EAEX,aAAS,GAAsBC,SAAS,UAA/B;IAAEE,KAAK,GAAeF,SAAS,MAAxB;IAAEG,QAAQ,GAAKH,SAAS,SAAd;EAClC,IAAMI,cAAc,GAAGC,MAAM,CAACC,SAAS,CAACF,cAAc;EACtD9C,IAAI,CAACyC,UAAU,EAAE,UAACQ,IAAI;IACpB;IACA,IAAIC,SAAS,GAAGN,KAAK,GAAGK,IAAI,CAACC,SAAS,GAAGD,IAAI,CAACL,KAAK,GAAGK,IAAI,CAACJ,QAAQ,IAAIA,QAAQ,GAAGI,IAAI,CAACL,KAAK,EAAE;MAC5F5C,IAAI,CAAC0C,SAAS,CAACZ,OAAO,EAAE,UAACQ,CAAC,EAAEJ,CAAC;QAC3B,IAAIY,cAAc,CAACK,IAAI,CAACF,IAAI,CAACnB,OAAO,EAAEI,CAAC,CAAC,EAAE;UACxC,OAAOe,IAAI,CAACnB,OAAO,CAACI,CAAC,CAAC;UACtB,OAAOe,IAAI,CAACjB,SAAS,CAACE,CAAC,CAAC;;MAE5B,CAAC,CAAC;;EAEN,CAAC,CAAC;EAEF,OAAOO,UAAU;AACnB;AAEA;EAA+BW;EAQ7B,iBAAYC,GAAG;IAAf,YACEC,kBAAMD,GAAG,CAAC;IARZ;;;;;IAKAE,WAAK,GAAe,EAAE;IAIpB,IAAMtB,KAAK,GAAGsB,KAAI,CAACC,eAAe,EAAE;IACpCjD,GAAG,CAAC0B,KAAK,EAAEoB,GAAG,CAACpB,KAAK,CAAC;IACrBsB,KAAI,CAACtB,KAAK,GAAGA,KAAK;IAClBsB,KAAI,CAACE,SAAS,CAACxB,KAAK,CAAC;IACrBsB,KAAI,CAACG,WAAW,EAAE,CAAC,CAAC;;EACtB;EAEA;EACAC,+BAAa,GAAb;IACE,OAAO;MACLC,OAAO,EAAE,IAAI;MACbC,OAAO,EAAE,IAAI;MACbC,MAAM,EAAE;KACT;EACH,CAAC;EAED;;;;EAIAH,iCAAe,GAAf;IACE,OAAO;MACLI,MAAM,EAAE,IAAI,CAACC,gBAAgB,EAAE;MAC/BC,OAAO,EAAE;KACV;EACH,CAAC;EAKD;;;;;EAKAN,gCAAc,GAAd,UAAeO,UAAsB,GAAG,CAAC;EAEzC;;;;;EAKAP,2BAAS,GAAT,UAAU1B,KAAiB,GAAG,CAAC;EAE/B;;;;EAIA0B,6BAAW,GAAX;IACE,IAAI,CAACQ,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC;IAC1B,IAAI,CAACA,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC;EAC9B,CAAC;EAEDR,yBAAO,GAAP;IACE,OAAO,KAAK;EACd,CAAC;EAEDA,2BAAS,GAAT;IACE,OAAO,IAAI,CAACS,GAAG,CAAC,QAAQ,CAAC;EAC3B,CAAC;EAEDT,2BAAS,GAAT;IACE,OAAO,IAAI,CAACS,GAAG,CAAC,QAAQ,CAAC;EAC3B,CAAC;EAEDT,sBAAI,GAAJ;;IAAK;SAAA,UAAO,EAAPU,qBAAO,EAAPA,IAAO;MAAPC;;IACI,QAAI,GAAWA,IAAI,GAAf;MAAEC,KAAK,GAAID,IAAI,GAAR;IAClB,IAAI,CAACE,IAAI,EAAE,OAAO,IAAI,CAACvC,KAAK;IAC5B,IAAI7B,QAAQ,CAACoE,IAAI,CAAC,EAAE;MAClB,KAAK,IAAMtC,CAAC,IAAIsC,IAAI,EAAE;QACpB,IAAI,CAACC,OAAO,CAACvC,CAAC,EAAEsC,IAAI,CAACtC,CAAC,CAAC,CAAC;;MAE1B,IAAI,CAACwC,gBAAgB,CAACF,IAAI,CAAC;MAC3B,OAAO,IAAI;;IAEb,IAAIF,IAAI,CAAC5C,MAAM,KAAK,CAAC,EAAE;MACrB,IAAI,CAAC+C,OAAO,CAACD,IAAI,EAAED,KAAK,CAAC;MACzB,IAAI,CAACG,gBAAgB,WACnBC,GAACH,IAAI,IAAGD,KAAK,MACb;MACF,OAAO,IAAI;;IAEb,OAAO,IAAI,CAACtC,KAAK,CAACuC,IAAI,CAAC;EACzB,CAAC;EAOD;EACAb,2BAAS,GAAT,UAAUiB,IAAI,EAAEC,IAAI;IAClB,IAAMC,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;IAC3B,OAAOD,IAAI,IAAI,CAACA,IAAI,CAACE,KAAK,CAACJ,IAAI,EAAEC,IAAI,CAAC;EACxC,CAAC;EAED;;;;;EAKAlB,yBAAO,GAAP,UAAQa,IAAY,EAAED,KAAU;IAC9B,IAAMU,WAAW,GAAG,IAAI,CAAChD,KAAK,CAACuC,IAAI,CAAC;IACpC,IAAIS,WAAW,KAAKV,KAAK,EAAE;MACzB,IAAI,CAACtC,KAAK,CAACuC,IAAI,CAAC,GAAGD,KAAK;MACxB,IAAI,CAACW,YAAY,CAACV,IAAI,EAAED,KAAK,EAAEU,WAAW,CAAC;;EAE/C,CAAC;EAED;;;;;;;EAOAtB,8BAAY,GAAZ,UAAaa,IAAY,EAAED,KAAU,EAAEU,WAAgB;IACrD,IAAIT,IAAI,KAAK,QAAQ,EAAE;MACrB,IAAI,CAACL,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC;;EAEjC,CAAC;EAED;;;;EAIAR,kCAAgB,GAAhB,UAAiBwB,WAAW;IAC1B,IAAI,IAAI,CAAC9B,GAAG,CAAC+B,WAAW,EAAE;MACxB,IAAMC,OAAO,GAAG,IAAI,CAAChC,GAAG,CAACgC,OAAO;MAChC,IAAIA,OAAO,EAAE;QACXA,OAAO,CAACC,cAAc,CAAC,MAAM,CAAC;;KAEjC,MAAM;MACL,IAAI,CAACA,cAAc,CAAC,MAAM,CAAC;;EAE/B,CAAC;EAED3B,sBAAI,GAAJ;IACE;IACA,IAAI,CAACQ,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC;IACzB,IAAI,CAACmB,cAAc,CAAC,MAAM,CAAC;IAC3B,OAAO,IAAI;EACb,CAAC;EAED3B,sBAAI,GAAJ;IACE;IACA,IAAI,CAACQ,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC;IAC1B,IAAI,CAACmB,cAAc,CAAC,MAAM,CAAC;IAC3B,OAAO,IAAI;EACb,CAAC;EAED3B,2BAAS,GAAT,UAAUG,MAAc;IACtB,IAAI,CAACK,GAAG,CAAC,QAAQ,EAAEL,MAAM,CAAC;IAC1B,IAAMyB,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B,IAAID,MAAM,EAAE;MACV;MACAA,MAAM,CAACE,IAAI,EAAE;;IAEf,OAAO,IAAI;EACb,CAAC;EAED9B,yBAAO,GAAP;IACE,IAAM4B,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B,IAAI,CAACD,MAAM,EAAE;MACX;;IAEF,IAAMG,QAAQ,GAAGH,MAAM,CAACI,WAAW,EAAE;IACrC,IAAMC,EAAE,GAAG,IAAI,CAACxB,GAAG,CAAC,IAAI,CAAC;IACzB,IAAMyB,KAAK,GAAGH,QAAQ,CAACnD,OAAO,CAAC,IAAI,CAAC;IACpCmD,QAAQ,CAACI,MAAM,CAACD,KAAK,EAAE,CAAC,CAAC;IACzBH,QAAQ,CAAC/D,IAAI,CAAC,IAAI,CAAC;IACnB,IAAI,CAAC2D,cAAc,CAAC,QAAQ,CAAC;EAC/B,CAAC;EAED3B,wBAAM,GAAN;IACE,IAAM4B,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B,IAAI,CAACD,MAAM,EAAE;MACX;;IAEF,IAAMG,QAAQ,GAAGH,MAAM,CAACI,WAAW,EAAE;IACrC,IAAMC,EAAE,GAAG,IAAI,CAACxB,GAAG,CAAC,IAAI,CAAC;IACzB,IAAMyB,KAAK,GAAGH,QAAQ,CAACnD,OAAO,CAAC,IAAI,CAAC;IACpCmD,QAAQ,CAACI,MAAM,CAACD,KAAK,EAAE,CAAC,CAAC;IACzBH,QAAQ,CAACK,OAAO,CAAC,IAAI,CAAC;IACtB,IAAI,CAACT,cAAc,CAAC,QAAQ,CAAC;EAC/B,CAAC;EAED3B,wBAAM,GAAN,UAAOqC,OAAc;IAAd;MAAAA,cAAc;IAAA;IACnB,IAAMT,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B,IAAID,MAAM,EAAE;MACV5E,eAAe,CAAC4E,MAAM,CAACI,WAAW,EAAE,EAAE,IAAI,CAAC;MAC3C,IAAI,CAACJ,MAAM,CAACnB,GAAG,CAAC,UAAU,CAAC,EAAE;QAC3B;QACA,IAAI,CAACkB,cAAc,CAAC,QAAQ,CAAC;;KAEhC,MAAM;MACL,IAAI,CAACA,cAAc,CAAC,QAAQ,CAAC;;IAE/B,IAAIU,OAAO,EAAE;MACX,IAAI,CAACA,OAAO,EAAE;;EAElB,CAAC;EAEDrC,6BAAW,GAAX;IACE,IAAI,CAACtB,IAAI,CAACpB,MAAM,EAAE,IAAI,CAAC+C,gBAAgB,EAAE,CAAC;IAC1C,IAAI,CAACsB,cAAc,CAAC,QAAQ,CAAC;EAC/B,CAAC;EAED3B,2BAAS,GAAT;IACE,OAAO,IAAI,CAACtB,IAAI,CAACpB,MAAM,CAAC;EAC1B,CAAC;EAED0C,2BAAS,GAAT,UAAUsC,CAAW;IACnB,IAAI,CAAC5D,IAAI,CAACpB,MAAM,EAAEgF,CAAC,CAAC;IACpB,IAAI,CAACX,cAAc,CAAC,QAAQ,CAAC;EAC/B,CAAC;EAED;EACA3B,gCAAc,GAAd;IACE,IAAIuC,WAAW,GAAG,IAAI,CAAC7C,GAAG,CAAC6C,WAAW;IACtC,IAAI,CAACA,WAAW,EAAE;MAChB,IAAMC,aAAa,GAAG,IAAI,CAAC9D,IAAI,CAAC,QAAQ,CAAC;MACzC,IAAM+D,YAAY,GAAG,IAAI,CAAC/C,GAAG,CAAC+C,YAAY;MAC1C,IAAIA,YAAY,IAAID,aAAa,EAAE;QACjCD,WAAW,GAAGrF,cAAc,CAACuF,YAAY,EAAED,aAAa,CAAC;OAC1D,MAAM;QACLD,WAAW,GAAGC,aAAa,IAAIC,YAAY;;MAE7C,IAAI,CAACjC,GAAG,CAAC,aAAa,EAAE+B,WAAW,CAAC;;IAEtC,OAAOA,WAAW;EACpB,CAAC;EAED;EACAvC,6BAAW,GAAX,UAAYI,MAAgB;IAC1B,IAAMoC,aAAa,GAAG,IAAI,CAAC9D,IAAI,CAAC,QAAQ,CAAC;IACzC,IAAI6D,WAAW,GAAG,IAAI;IACtB,IAAInC,MAAM,IAAIoC,aAAa,EAAE;MAC3BD,WAAW,GAAGrF,cAAc,CAACkD,MAAM,EAAEoC,aAAa,CAAC;KACpD,MAAM;MACLD,WAAW,GAAGC,aAAa,IAAIpC,MAAM;;IAEvC,IAAI,CAACI,GAAG,CAAC,aAAa,EAAE+B,WAAW,CAAC;IACpC,IAAI,CAAC/B,GAAG,CAAC,cAAc,EAAEJ,MAAM,CAAC;EAClC,CAAC;EAED;;;;;EAKAJ,kCAAgB,GAAhB;IACE,OAAO,IAAI;EACb,CAAC;EAED;EACAA,+BAAa,GAAb,UAAcrB,CAAW;IACvB,IAAMyB,MAAM,GAAG,IAAI,CAAC1B,IAAI,CAAC,QAAQ,CAAC;IAClC,IAAI0B,MAAM,EAAE;MACV,OAAOjD,YAAY,CAACiD,MAAM,EAAEzB,CAAC,CAAC;;IAEhC,OAAOA,CAAC;EACV,CAAC;EAED;EACAqB,kCAAgB,GAAhB,UAAiBrB,CAAW;IAC1B,IAAMyB,MAAM,GAAG,IAAI,CAAC1B,IAAI,CAAC,QAAQ,CAAC;IAClC,IAAI0B,MAAM,EAAE;MACV,IAAMsC,YAAY,GAAGtF,MAAM,CAACgD,MAAM,CAAC;MACnC,IAAIsC,YAAY,EAAE;QAChB,OAAOvF,YAAY,CAACuF,YAAY,EAAE/D,CAAC,CAAC;;;IAGxC,OAAOA,CAAC;EACV,CAAC;EAED;EACAqB,yBAAO,GAAP,UAAQ2C,OAAgB;IACtB,IAAMC,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAIC,SAAS,GAAG,IAAI;IACpB;IACA,IAAIH,OAAO,EAAE;MACX,IAAMI,SAAS,GAAG,IAAI,CAACC,YAAY,EAAE;MACrC,IAAMC,SAAS,GAAGpG,UAAU,CAAC8F,OAAO,CAACO,IAAI,CAAC;MAC1C,IAAMC,IAAI,GAAGJ,SAAS,CAACE,SAAS,CAAC;MACjC,IAAIE,IAAI,EAAE;QACRL,SAAS,GAAG,IAAIK,IAAI,CAAC;UACnBD,IAAI,EAAEP,OAAO,CAACO,IAAI;UAClBzB,WAAW,EAAE,IAAI;UACjBC,OAAO,EAAE,IAAI;UACbpD,KAAK,EAAEqE,OAAO,CAACrE,KAAK;UACpBsE,MAAM;SACP,CAAC;;;IAIN,IAAI,CAACpC,GAAG,CAAC,WAAW,EAAEsC,SAAS,CAAC;IAChC,IAAI,CAACnB,cAAc,CAAC,MAAM,CAAC;IAC3B,OAAOmB,SAAS;EAClB,CAAC;EAED9C,yBAAO,GAAP;IACE;IACA,IAAM8C,SAAS,GAAG,IAAI,CAACpD,GAAG,CAACoD,SAAS;IACpC;IACA,IAAI,CAACA,SAAS,EAAE;MACd,OAAO,IAAI;;IAEb,OAAOA,SAAS;EAClB,CAAC;EAED9C,uBAAK,GAAL;IAAA;IACE,IAAMoD,WAAW,GAAG,IAAI,CAAC9E,KAAK;IAC9B,IAAMA,KAAK,GAAG,EAAE;IAChBjC,IAAI,CAAC+G,WAAW,EAAE,UAACtF,CAAC,EAAES,CAAC;MACrB,IAAI7B,OAAO,CAAC0G,WAAW,CAAC7E,CAAC,CAAC,CAAC,EAAE;QAC3BD,KAAK,CAACC,CAAC,CAAC,GAAGZ,eAAe,CAACyF,WAAW,CAAC7E,CAAC,CAAC,CAAC;OAC3C,MAAM;QACLD,KAAK,CAACC,CAAC,CAAC,GAAG6E,WAAW,CAAC7E,CAAC,CAAC;;IAE7B,CAAC,CAAC;IACF,IAAM8E,IAAI,GAAG,IAAI,CAACC,WAAW;IAC7B;IACA,IAAMC,KAAK,GAAG,IAAIF,IAAI,CAAC;MAAE/E,KAAK;IAAA,CAAE,CAAC;IACjCjC,IAAI,CAACkB,UAAU,EAAE,UAACiG,OAAO;MACvBD,KAAK,CAAC/C,GAAG,CAACgD,OAAO,EAAE5D,KAAI,CAACa,GAAG,CAAC+C,OAAO,CAAC,CAAC;IACvC,CAAC,CAAC;IACF,OAAOD,KAAK;EACd,CAAC;EAEDvD,yBAAO,GAAP;IACE,IAAMyD,SAAS,GAAG,IAAI,CAACA,SAAS;IAChC,IAAIA,SAAS,EAAE;MACb;;IAEF,IAAI,CAACnF,KAAK,GAAG,EAAE;IACfqB,iBAAM0C,OAAO,WAAE;IACf;EACF,CAAC;EAED;;;;EAIArC,iCAAe,GAAf;IACE,OAAO,IAAI,CAACS,GAAG,CAAC,QAAQ,CAAC,CAACiD,QAAQ;EACpC,CAAC;EAED;;;;;;;;;;;;;;EAcA1D,yBAAO,GAAP;IAAQ;SAAA,UAAO,EAAPU,qBAAO,EAAPA,IAAO;MAAPC;;IACN,IAAI,CAAC,IAAI,CAACF,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAACA,GAAG,CAAC,QAAQ,CAAC,EAAE;MAChD;;IAEF,IAAI,CAACD,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC;IAC3B,IAAImD,QAAQ,GAAG,IAAI,CAAClD,GAAG,CAAC,UAAU,CAAC;IACnC,IAAI,CAACkD,QAAQ,EAAE;MACbA,QAAQ,GAAG,IAAI,CAAClD,GAAG,CAAC,QAAQ,CAAC,CAACA,GAAG,CAAC,UAAU,CAAC;MAC7C,IAAI,CAACD,GAAG,CAAC,UAAU,EAAEmD,QAAQ,CAAC;;IAEhC,IAAI7E,UAAU,GAAG,IAAI,CAAC2B,GAAG,CAAC,YAAY,CAAC,IAAI,EAAE;IAC7C;IACA,IAAI,CAACkD,QAAQ,CAACC,KAAK,EAAE;MACnBD,QAAQ,CAACE,SAAS,EAAE;;IAEjB,WAAO,GAAiElD,IAAI,GAArE;MAAEzB,QAAQ,GAAuDyB,IAAI,GAA3D;MAAEK,KAAqDL,IAAI,GAApC;MAArBmD,MAAM,mBAAG,YAAY;MAAEC,KAA8BpD,IAAI,GAAnB;MAAfqD,QAAQ,mBAAGrH,IAAI;MAAEsH,KAAatD,IAAI,GAAR;MAAT1B,KAAK,mBAAG,CAAC;IACzE,IAAID,OAAgB;IACpB,IAAIkF,MAAe;IACnB,IAAIC,aAAa;IACjB,IAAIC,cAAc;IAClB,IAAIC,UAAsB;IAC1B;IACA,IAAI9H,UAAU,CAAC4B,OAAO,CAAC,EAAE;MACvBa,OAAO,GAAGb,OAAkB;MAC5BA,OAAO,GAAG,EAAE;KACb,MAAM,IAAI1B,QAAQ,CAAC0B,OAAO,CAAC,IAAKA,OAAe,CAACa,OAAO,EAAE;MACxD;MACAA,OAAO,GAAIb,OAAe,CAACa,OAAkB;MAC7CkF,MAAM,GAAI/F,OAAe,CAAC+F,MAAM;;IAElC;IACA,IAAIzH,QAAQ,CAACyC,QAAQ,CAAC,EAAE;MACtBmF,UAAU,GAAGnF,QAAsB;MACnCA,QAAQ,GAAGmF,UAAU,CAACnF,QAAQ;MAC9B4E,MAAM,GAAGO,UAAU,CAACP,MAAM,IAAI,YAAY;MAC1C7E,KAAK,GAAGoF,UAAU,CAACpF,KAAK,IAAI,CAAC;MAC7B;MACAiF,MAAM,GAAGG,UAAU,CAACH,MAAM,IAAIA,MAAM,IAAI,KAAK;MAC7CF,QAAQ,GAAGK,UAAU,CAACL,QAAQ,IAAIrH,IAAI;MACtCwH,aAAa,GAAGE,UAAU,CAACF,aAAa,IAAIxH,IAAI;MAChDyH,cAAc,GAAGC,UAAU,CAACD,cAAc,IAAIzH,IAAI;KACnD,MAAM;MACL;MACA,IAAIH,QAAQ,CAACwH,QAAQ,CAAC,EAAE;QACtB/E,KAAK,GAAG+E,QAAQ;QAChBA,QAAQ,GAAG,IAAI;;MAEjB;MACA,IAAIzH,UAAU,CAACuH,MAAM,CAAC,EAAE;QACtBE,QAAQ,GAAGF,MAAM;QACjBA,MAAM,GAAG,YAAY;OACtB,MAAM;QACLA,MAAM,GAAGA,MAAM,IAAI,YAAY;;;IAGnC,IAAMQ,aAAa,GAAG9F,gBAAgB,CAACL,OAAO,EAAE,IAAI,CAAC;IACrD,IAAMY,SAAS,GAAc;MAC3BV,SAAS,EAAEH,kBAAkB,CAACoG,aAAa,EAAE,IAAI,CAAC;MAClDnG,OAAO,EAAEmG,aAAa;MACtBpF,QAAQ;MACR4E,MAAM;MACNI,MAAM;MACNF,QAAQ;MACRG,aAAa;MACbC,cAAc;MACdnF,KAAK;MACLM,SAAS,EAAEoE,QAAQ,CAACY,OAAO,EAAE;MAC7BC,EAAE,EAAE1H,QAAQ,EAAE;MACdkC,OAAO;MACPyF,aAAa,EAAE;KAChB;IACD;IACA,IAAI3F,UAAU,CAACf,MAAM,GAAG,CAAC,EAAE;MACzB;MACAe,UAAU,GAAGD,iBAAiB,CAACC,UAAU,EAAEC,SAAS,CAAC;KACtD,MAAM;MACL;MACA4E,QAAQ,CAACe,WAAW,CAAC,IAAI,CAAC;;IAE5B5F,UAAU,CAACd,IAAI,CAACe,SAAS,CAAC;IAC1B,IAAI,CAACyB,GAAG,CAAC,YAAY,EAAE1B,UAAU,CAAC;IAClC,IAAI,CAAC0B,GAAG,CAAC,QAAQ,EAAE;MAAEkD,QAAQ,EAAE;IAAK,CAAE,CAAC;EACzC,CAAC;EAED;;;;EAIA1D,6BAAW,GAAX,UAAY2E,KAAY;IAAxB;IAAY;MAAAA,YAAY;IAAA;IACtB,IAAM7F,UAAU,GAAG,IAAI,CAAC2B,GAAG,CAAC,YAAY,CAAC;IACzCpE,IAAI,CAACyC,UAAU,EAAE,UAACC,SAAoB;MACpC;MACA,IAAI4F,KAAK,EAAE;QACT,IAAI5F,SAAS,CAACC,OAAO,EAAE;UACrBY,KAAI,CAAClB,IAAI,CAACK,SAAS,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC;SAChC,MAAM;UACLY,KAAI,CAAClB,IAAI,CAACK,SAAS,CAACZ,OAAO,CAAC;;;MAGhC,IAAIY,SAAS,CAACiF,QAAQ,EAAE;QACtB;QACAjF,SAAS,CAACiF,QAAQ,EAAE;;IAExB,CAAC,CAAC;IACF,IAAI,CAACxD,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC;IAC5B,IAAI,CAACA,GAAG,CAAC,YAAY,EAAE,EAAE,CAAC;EAC5B,CAAC;EAED;;;EAGAR,8BAAY,GAAZ;IACE,IAAM2D,QAAQ,GAAG,IAAI,CAAClD,GAAG,CAAC,UAAU,CAAC;IACrC,IAAM3B,UAAU,GAAG,IAAI,CAAC2B,GAAG,CAAC,YAAY,CAAC;IACzC,IAAMmE,SAAS,GAAGjB,QAAQ,CAACY,OAAO,EAAE;IACpClI,IAAI,CAACyC,UAAU,EAAE,UAACC,SAAoB;MACpCA,SAAS,CAAC8F,OAAO,GAAG,IAAI;MACxB9F,SAAS,CAAC+F,UAAU,GAAGF,SAAS;MAChC,IAAI7F,SAAS,CAACoF,aAAa,EAAE;QAC3B;QACApF,SAAS,CAACoF,aAAa,EAAE;;IAE7B,CAAC,CAAC;IACF;IACA,IAAI,CAAC3D,GAAG,CAAC,QAAQ,EAAE;MACjBkD,QAAQ,EAAE,IAAI;MACdkB,SAAS;KACV,CAAC;IACF,OAAO,IAAI;EACb,CAAC;EAED;;;EAGA5E,+BAAa,GAAb;IACE,IAAM2D,QAAQ,GAAG,IAAI,CAAClD,GAAG,CAAC,UAAU,CAAC;IACrC,IAAMsE,OAAO,GAAGpB,QAAQ,CAACY,OAAO,EAAE;IAClC,IAAMzF,UAAU,GAAG,IAAI,CAAC2B,GAAG,CAAC,YAAY,CAAC;IACzC,IAAMmE,SAAS,GAAG,IAAI,CAACnE,GAAG,CAAC,QAAQ,CAAC,CAACmE,SAAS;IAC9C;IACAvI,IAAI,CAACyC,UAAU,EAAE,UAACC,SAAoB;MACpCA,SAAS,CAACQ,SAAS,GAAGR,SAAS,CAACQ,SAAS,IAAIwF,OAAO,GAAGH,SAAS,CAAC;MACjE7F,SAAS,CAAC8F,OAAO,GAAG,KAAK;MACzB9F,SAAS,CAAC+F,UAAU,GAAG,IAAI;MAC3B,IAAI/F,SAAS,CAACqF,cAAc,EAAE;QAC5BrF,SAAS,CAACqF,cAAc,EAAE;;IAE9B,CAAC,CAAC;IACF,IAAI,CAAC5D,GAAG,CAAC,QAAQ,EAAE;MACjBkD,QAAQ,EAAE;KACX,CAAC;IACF,IAAI,CAAClD,GAAG,CAAC,YAAY,EAAE1B,UAAU,CAAC;IAClC,OAAO,IAAI;EACb,CAAC;EAED;;;;;EAKAkB,gCAAc,GAAd,UAAekD,IAAY,EAAE8B,QAAoB;IAAjD;IACE,IAAMC,KAAK,GAAGD,QAAQ,CAACE,eAAe;IACtC,IAAMC,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B,IAAIC,aAAa;IACjB,IAAInC,IAAI,KAAK,YAAY,EAAE;MACzBmC,aAAa,GAAGL,QAAQ,CAACM,SAAS;KACnC,MAAM,IAAIpC,IAAI,KAAK,YAAY,EAAE;MAChCmC,aAAa,GAAGL,QAAQ,CAACO,OAAO;;4BAGzBzH,CAAC;MACR,IAAM0H,OAAO,GAAGP,KAAK,CAACnH,CAAC,CAAC;MACxB;MACA,IAAM2H,MAAI,GAAGD,OAAO,CAAC/E,GAAG,CAAC,MAAM,CAAC;MAChC,IAAIgF,MAAI,EAAE;QACR;QACA;QACE;QACA,CAACD,OAAO,CAACE,OAAO,EAAE,IAAKF,OAAO,CAACG,QAAQ,IAAIH,OAAO,CAACG,QAAQ,EAAG,KAC9DN,aAAa,IACbpI,QAAQ,CAACuI,OAAO,EAAEH,aAAa,CAAC,EAChC;;;QAGF,IAAI3I,OAAO,CAAC+I,MAAI,CAAC,EAAE;UACjBpJ,IAAI,CAACoJ,MAAI,EAAE,UAACG,OAAO;YACjBhG,KAAI,CAACiG,iBAAiB,CAACL,OAAO,EAAEI,OAAO,EAAEZ,QAAQ,CAAC;UACpD,CAAC,CAAC;SACH,MAAM;UACLc,OAAKD,iBAAiB,CAACL,OAAO,EAAEC,MAAI,EAAET,QAAQ,CAAC;;;;;IApBrD;IACA,KAAK,IAAIlH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmH,KAAK,CAAClH,MAAM,EAAED,CAAC,EAAE;4BAA5BA,CAAC;;;EAuBZ,CAAC;EAEOkC,mCAAiB,GAAzB,UAA0BwF,OAAO,EAAE3E,IAAY,EAAEmE,QAAoB;IACnE,IAAMG,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B;IACA,IAAMW,SAAS,GAAGlF,IAAI,GAAGpD,gBAAgB,GAAGuH,QAAQ,CAAC9B,IAAI;IACzD,IAAIiC,MAAM,CAACY,SAAS,CAAC,IAAIZ,MAAM,CAACzH,QAAQ,CAAC,EAAE;MACzC;MACAsH,QAAQ,CAACnE,IAAI,GAAGkF,SAAS;MACzBf,QAAQ,CAACgB,aAAa,GAAGR,OAAO;MAChCR,QAAQ,CAACiB,cAAc,GAAG,IAAI;MAC9B;MACAjB,QAAQ,CAACkB,cAAc,GAAGV,OAAO,CAAC/E,GAAG,CAAC,gBAAgB,CAAC;MACvD,IAAI,CAAC0F,IAAI,CAACJ,SAAS,EAAEf,QAAQ,CAAC;;EAElC,CAAC;EAED;;;;;;EAMAhF,2BAAS,GAAT,UAAUoG,UAAsB,EAAEC,UAAsB;IAA9C;MAAAD,cAAsB;IAAA;IAAE;MAAAC,cAAsB;IAAA;IACtD,IAAMjG,MAAM,GAAG,IAAI,CAACkG,SAAS,EAAE;IAC/B,IAAMC,SAAS,GAAGC,SAAS,CAACpG,MAAM,EAAE,CAAC,CAAC,GAAG,EAAEgG,UAAU,EAAEC,UAAU,CAAC,CAAC,CAAC;IACpE,IAAI,CAACI,SAAS,CAACF,SAAS,CAAC;IACzB,OAAO,IAAI;EACb,CAAC;EAED;;;;;;EAMAvG,sBAAI,GAAJ,UAAK0G,OAAe,EAAEC,OAAe;IACnC,IAAMC,CAAC,GAAG,IAAI,CAAClI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;IAC7B,IAAMmI,CAAC,GAAG,IAAI,CAACnI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;IAC7B,IAAI,CAACoI,SAAS,CAACJ,OAAO,GAAGE,CAAC,EAAED,OAAO,GAAGE,CAAC,CAAC;IACxC,OAAO,IAAI;EACb,CAAC;EAED;;;;;;EAMA7G,wBAAM,GAAN,UAAO0G,OAAe,EAAEC,OAAe;IACrC,OAAO,IAAI,CAACI,IAAI,CAACL,OAAO,EAAEC,OAAO,CAAC;EACpC,CAAC;EAED;;;;;;EAMA3G,uBAAK,GAAL,UAAMgH,MAAc,EAAEC,MAAe;IACnC,IAAM7G,MAAM,GAAG,IAAI,CAACkG,SAAS,EAAE;IAC/B,IAAMC,SAAS,GAAGC,SAAS,CAACpG,MAAM,EAAE,CAAC,CAAC,GAAG,EAAE4G,MAAM,EAAEC,MAAM,IAAID,MAAM,CAAC,CAAC,CAAC;IACtE,IAAI,CAACP,SAAS,CAACF,SAAS,CAAC;IACzB,OAAO,IAAI;EACb,CAAC;EAED;;;;;EAKAvG,wBAAM,GAAN,UAAOkH,MAAc;IACnB,IAAM9G,MAAM,GAAG,IAAI,CAACkG,SAAS,EAAE;IAC/B,IAAMC,SAAS,GAAGC,SAAS,CAACpG,MAAM,EAAE,CAAC,CAAC,GAAG,EAAE8G,MAAM,CAAC,CAAC,CAAC;IACpD,IAAI,CAACT,SAAS,CAACF,SAAS,CAAC;IACzB,OAAO,IAAI;EACb,CAAC;EAED;;;;;EAKAvG,+BAAa,GAAb,UAAcmH,MAAc;IACpB,SAAW,IAAI,CAACzI,IAAI,EAAE;MAApBkI,CAAC;MAAEC,CAAC,OAAgB;IAC5B,IAAMzG,MAAM,GAAG,IAAI,CAACkG,SAAS,EAAE;IAC/B,IAAMC,SAAS,GAAGC,SAAS,CAACpG,MAAM,EAAE,CAClC,CAAC,GAAG,EAAE,CAACwG,CAAC,EAAE,CAACC,CAAC,CAAC,EACb,CAAC,GAAG,EAAEM,MAAM,CAAC,EACb,CAAC,GAAG,EAAEP,CAAC,EAAEC,CAAC,CAAC,CACZ,CAAC;IACF,IAAI,CAACJ,SAAS,CAACF,SAAS,CAAC;IACzB,OAAO,IAAI;EACb,CAAC;EAED;;;;;EAKAvG,+BAAa,GAAb,UAAc4G,CAAS,EAAEC,CAAS,EAAEM,MAAc;IAChD,IAAM/G,MAAM,GAAG,IAAI,CAACkG,SAAS,EAAE;IAC/B,IAAMC,SAAS,GAAGC,SAAS,CAACpG,MAAM,EAAE,CAClC,CAAC,GAAG,EAAE,CAACwG,CAAC,EAAE,CAACC,CAAC,CAAC,EACb,CAAC,GAAG,EAAEM,MAAM,CAAC,EACb,CAAC,GAAG,EAAEP,CAAC,EAAEC,CAAC,CAAC,CACZ,CAAC;IACF,IAAI,CAACJ,SAAS,CAACF,SAAS,CAAC;IACzB,OAAO,IAAI;EACb,CAAC;EACH,cAAC;AAAD,CAAC,CA1qB8BlJ,IAAI;AA4qBnC,eAAe2C,OAAO","names":["each","isEqual","isFunction","isNumber","isObject","isArray","noop","mix","upperFirst","uniqueId","ext","removeFromArray","isParent","multiplyMatrix","multiplyVec2","invert","Base","MATRIX","CLONE_CFGS","RESERVED_PORPS","DELEGATION_SPLIT","WILDCARD","_cloneArrayAttr","arr","result","i","length","push","concat","getFormatFromAttrs","toAttrs","shape","fromAttrs","attrs","k","getFormatToAttrs","props","attr","v","indexOf","checkExistedAttrs","animations","animation","onFrame","delay","duration","hasOwnProperty","Object","prototype","item","startTime","call","__extends","cfg","_super","_this","getDefaultAttrs","initAttrs","initAnimate","Element","visible","capture","zIndex","matrix","getDefaultMatrix","opacity","changeType","set","get","_i","args","value","name","setAttr","afterAttrsChange","_a","refX","refY","clip","getClip","isHit","originValue","onAttrChange","targetAttrs","isClipShape","applyTo","onCanvasChange","parent","getParent","sort","children","getChildren","el","index","splice","unshift","destroy","m","totalMatrix","currentMatrix","parentMatrix","invertMatrix","clipCfg","canvas","getCanvas","clipShape","ShapeBase","getShapeBase","shapeType","type","Cons","originAttrs","cons","constructor","clone","cfgName","destroyed","isPaused","timeline","timer","initTimer","easing","_b","callback","_c","repeat","pauseCallback","resumeCallback","animateCfg","formatToAttrs","getTime","id","pathFormatted","addAnimator","toEnd","pauseTime","_paused","_pauseTime","current","eventObj","paths","propagationPath","events","getEvents","relativeShape","fromShape","toShape","element","name_1","isGroup","isCanvas","subName","emitDelegateEvent","this_1","eventName","currentTarget","delegateTarget","delegateObject","emit","translateX","translateY","getMatrix","newMatrix","transform","setMatrix","targetX","targetY","x","y","translate","move","ratioX","ratioY","radian","rotate"],"sourceRoot":"","sources":["../../src/abstract/element.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}