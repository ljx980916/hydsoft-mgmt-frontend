{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from \"vue\";\nimport { getCurrentTime } from \"@/utils/util.js\";\nimport { workingCalendar } from \"@/api/login.js\";\nexport default {\n  __name: 'calenderTable',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    let {\n      year,\n      month,\n      day\n    } = getCurrentTime();\n    let currentDate = `${year}-${month}`;\n    let selectedVal = `${year}/${month}/${day}`;\n    const dateNow = ref(currentDate);\n    const weeks = ref([\"周日\", \"周一\", \"周二\", \"周三\", \"周四\", \"周五\", \"周六\"]);\n    const dates = ref([]);\n    const selectedDate = ref(\"\");\n    const yearNow = ref(year);\n    const monthNow = ref(month);\n    const calenderEvents = ref([]);\n    const tipList = ref([{\n      borderColor: \"#C3E7FE\",\n      bgColor: \"#E8F3FF\",\n      // 蓝\n      name: \"FIN\"\n    }, {\n      borderColor: \"#FDCDC5\",\n      bgColor: \"#FFECE8\",\n      // 红\n      name: \"BMD\"\n    }, {\n      borderColor: \"#FFE4BA\",\n      bgColor: \"#FFF7E8\",\n      // 橘\n      name: \"HR\"\n    }]);\n    // 更改month\n    const changeMonth = value => {\n      yearNow.value = value.slice(0, 4);\n      monthNow.value = value.slice(5);\n      dates.value = [];\n      getList();\n      initCalendar();\n    };\n    // 初始化日历\n    const initCalendar = () => {\n      if (Number(selectedVal.split(\"/\")[2]) < 10) {\n        selectedDate.value = `${selectedVal.split(\"/\")[0]}/${selectedVal.split(\"/\")[1]}/0${selectedVal.split(\"/\")[2]}`;\n      } else {\n        selectedDate.value = `${selectedVal.split(\"/\")[0]}/${selectedVal.split(\"/\")[1]}/${selectedVal.split(\"/\")[2]}`;\n      }\n      // ⚠️注意：new Date中的month要减1才是真正的本月月数，即本月：month - 1，下个月：month\n      // ⚠️注意：下个月的第0天即为本月的最后一天\n      // 上个月总天数（本月第0天日期）\n      const prepMonthDays = new Date(yearNow.value, monthNow.value - 1, 0).getDate();\n      // 上个月最后一天星期几（本月第0天星期数）\n      const prepMonthEndDayWeek = new Date(yearNow.value, monthNow.value - 1, 0).getDay();\n      // 当前月总天数（下个月第0天日期）\n      const thisMonthDays = new Date(yearNow.value, monthNow.value, 0).getDate();\n      // 当前月第一天是星期几\n      const firstDayWeek = new Date(yearNow.value, monthNow.value - 1, 1).getDay();\n      // 当前月最后一天是星期几（下个月第0天星期数）\n      const thisEndDayWeek = new Date(yearNow.value, monthNow.value, 0).getDay();\n      // 需要计算的总天数\n      var totalDays = firstDayWeek + thisMonthDays;\n      if (thisEndDayWeek < 6) {\n        // 星期天开始且本月最后一天是星期天之前，需补满最后一行\n        totalDays += 6 - thisEndDayWeek;\n      }\n      var index = 0;\n      for (index; index < totalDays; index++) {\n        // 上个月月底\n        if (index < firstDayWeek) {\n          // 上个月天数 - 上个月最后一天星期数 + 下标 (如：31 - 5 + 0)\n          const day = prepMonthDays - prepMonthEndDayWeek + index;\n          const date = new Date(yearNow.value, monthNow.value - 2, day).toLocaleDateString();\n          if (Number(date.split(\"/\")[2]) < 10) {\n            var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/0${date.split(\"/\")[2]}`;\n          } else {\n            var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/${date.split(\"/\")[2]}`;\n          }\n          if (day < 10) {\n            var dayVal = 0 + `${day}`;\n          } else {\n            var dayVal = day;\n          }\n          dates.value.push({\n            isPrep: true,\n            dayVal,\n            dateNowVal\n          });\n        } else if (index >= firstDayWeek + thisMonthDays) {\n          // 下个月月初\n          // 下标 - 当前月总天数 - 当前月第一天星期数 + 1 (如：30 - 31 + 1 + 1)\n          const day = index - thisMonthDays - firstDayWeek + 1;\n          const date = new Date(yearNow.value, monthNow.value, day).toLocaleDateString();\n          if (Number(date.split(\"/\")[2]) < 10) {\n            var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/0${date.split(\"/\")[2]}`;\n          } else {\n            var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/${date.split(\"/\")[2]}`;\n          }\n          if (day < 10) {\n            var dayVal = 0 + `${day}`;\n          } else {\n            var dayVal = day;\n          }\n          dates.value.push({\n            isNext: true,\n            dayVal,\n            dateNowVal\n          });\n        } else {\n          // 本月\n          // 下标 - 当前月第一天星期数 + 1 (如：5 - 5 + 1)\n          const day = index - firstDayWeek + 1;\n          const date = new Date(yearNow.value, monthNow.value - 1, day).toLocaleDateString();\n          if (Number(date.split(\"/\")[2]) < 10) {\n            var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/0${date.split(\"/\")[2]}`;\n          } else {\n            var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/${date.split(\"/\")[2]}`;\n          }\n          if (day < 10) {\n            var dayVal = 0 + `${day}`;\n          } else {\n            var dayVal = day;\n          }\n          dates.value.push({\n            dayVal,\n            dateNowVal\n          });\n        }\n      }\n    };\n    initCalendar();\n    // 获取日历事件\n    const getList = () => {\n      workingCalendar({\n        month: dateNow.value\n      }).then(res => {\n        if (res.code == \"200\") {\n          calenderEvents.value = res.data;\n          calenderEvents.value.forEach(item => {\n            if (item.caleDate.split(\"-\")[1][0] == 0) {\n              let date = `${item.caleDate.split(\"-\")[0]}/${item.caleDate.split(\"-\")[1][1]}/${item.caleDate.split(\"-\")[2]}`;\n              item.caleDate = date;\n            } else {\n              let date = `${item.caleDate.split(\"-\")[0]}/${item.caleDate.split(\"-\")[1]}/${item.caleDate.split(\"-\")[2]}`;\n              item.caleDate = date;\n            }\n            dates.value.forEach(ele => {\n              if (item.caleDate === ele.dateNowVal) {\n                ele.eventList = item.item;\n                ele.caleType = item.caleType;\n                ele.eventList.forEach(jtem => {\n                  if (jtem.dept === \"FG4-HR\") {\n                    jtem.borderColor = \"#FFE4BA\"; // 橘\n                    jtem.bgColor = \"#FFF7E8\";\n                    jtem.color = \"#FF7D00\";\n                  }\n                  if (jtem.dept === \"FG4-BMD\") {\n                    jtem.bgColor = \"#FFECE8\"; // 红\n                    jtem.borderColor = \"#FDCDC5\";\n                    jtem.color = \"#F53F3F\";\n                  }\n                  if (jtem.dept === \"FG4-FIN\") {\n                    jtem.bgColor = \"#E8F3FF\"; // 蓝\n                    jtem.borderColor = \"#C3E7FE\";\n                    jtem.color = \"#4080FF\";\n                  }\n                });\n              }\n            });\n          });\n        }\n      });\n    };\n    getList();\n    const __returned__ = {\n      get year() {\n        return year;\n      },\n      set year(v) {\n        year = v;\n      },\n      get month() {\n        return month;\n      },\n      set month(v) {\n        month = v;\n      },\n      get day() {\n        return day;\n      },\n      set day(v) {\n        day = v;\n      },\n      get currentDate() {\n        return currentDate;\n      },\n      set currentDate(v) {\n        currentDate = v;\n      },\n      get selectedVal() {\n        return selectedVal;\n      },\n      set selectedVal(v) {\n        selectedVal = v;\n      },\n      dateNow,\n      weeks,\n      dates,\n      selectedDate,\n      yearNow,\n      monthNow,\n      calenderEvents,\n      tipList,\n      changeMonth,\n      initCalendar,\n      getList,\n      ref,\n      get getCurrentTime() {\n        return getCurrentTime;\n      },\n      get workingCalendar() {\n        return workingCalendar;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"mappings":"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","names":["ref","getCurrentTime","workingCalendar","year","month","day","currentDate","selectedVal","dateNow","weeks","dates","selectedDate","yearNow","monthNow","calenderEvents","tipList","borderColor","bgColor","name","changeMonth","value","slice","getList","initCalendar","Number","split","prepMonthDays","Date","getDate","prepMonthEndDayWeek","getDay","thisMonthDays","firstDayWeek","thisEndDayWeek","totalDays","index","date","toLocaleDateString","dateNowVal","dayVal","push","isPrep","isNext","then","res","code","data","forEach","item","caleDate","ele","eventList","caleType","jtem","dept","color"],"sources":["/Users/lijiaxin/Documents/workspace/hydsoft-oms-frontend/src/components/calenderTable.vue"],"sourcesContent":["<template>\n  <a-space>\n    <a-month-picker v-model=\"dateNow\" @change=\"changeMonth\" style=\"width: 140px\" />\n  </a-space>\n  <a-space class=\"tagTip\">\n    <div v-for=\"item in tipList\" :key=\"item.name\" class=\"flex-center m-l-40\">\n      <span\n        :style=\"{\n          borderRadius: '50%',\n          width: '14px',\n          height: '14px',\n          borderColor: item.borderColor,\n          borderStyle: 'solid',\n          borderWidth: '1px',\n          backgroundColor: item.bgColor,\n        }\"\n      ></span>\n      <span class=\"m-l-8\">\n        {{ item.name }}\n      </span>\n    </div>\n  </a-space>\n  <div class=\"date\">\n    <ul>\n      <li class=\"week\" v-for=\"item in weeks\" :key=\"item\">\n        {{ item }}\n      </li>\n      <li\n        class=\"day\"\n        v-for=\"item in dates\"\n        :key=\"item.dateNowVal\"\n        :class=\"{\n          isPrep: item.isPrep,\n          isNext: item.isNext,\n          isSelected: item.dateNowVal == selectedDate,\n          isDisabled: item.caleType == 5 || item.caleType == 6 || item.isPrep || item.isNext,\n        }\"\n      >\n      <!-- <span >{{ item.dateNowVal }}--{{selectedDate}}</span> -->\n        <span class=\"days\">{{ item.dayVal }}</span>\n        <div v-for=\"jtem in item.eventList\" :key=\"jtem.dept\" class=\"m-t-8 m-l-4\">\n          <span\n            :style=\"{\n              width: '120px',\n              height: '25px',\n              backgroundColor: jtem.bgColor,\n              borderStyle: 'solid',\n              borderWidth: '1px',\n              borderColor: jtem.borderColor,\n              color: jtem.color,\n              fontSize: '14px',\n              lineHeight: '25px',\n              display: 'inline-block',\n              textAlign: 'center',\n            }\"\n          >\n            {{ jtem.eventDescription }}\n          </span>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n<script setup>\nimport { ref } from \"vue\";\nimport { getCurrentTime } from \"@/utils/util.js\";\nimport { workingCalendar } from \"@/api/login.js\";\nlet { year, month, day } = getCurrentTime();\nlet currentDate = `${year}-${month}`;\nlet selectedVal = `${year}/${month}/${day}`;\nconst dateNow = ref(currentDate);\nconst weeks = ref([\"周日\", \"周一\", \"周二\", \"周三\", \"周四\", \"周五\", \"周六\"]);\nconst dates = ref([]);\nconst selectedDate = ref(\"\");\nconst yearNow = ref(year);\nconst monthNow = ref(month);\nconst calenderEvents = ref([]);\nconst tipList = ref([\n  {\n    borderColor: \"#C3E7FE\",\n    bgColor: \"#E8F3FF\", // 蓝\n    name: \"FIN\",\n  },\n  {\n    borderColor: \"#FDCDC5\",\n    bgColor: \"#FFECE8\", // 红\n    name: \"BMD\",\n  },\n  {\n    borderColor: \"#FFE4BA\",\n    bgColor: \"#FFF7E8\", // 橘\n    name: \"HR\",\n  },\n]);\n// 更改month\nconst changeMonth = value => {\n  yearNow.value = value.slice(0, 4);\n  monthNow.value = value.slice(5);\n  dates.value = [];\n  getList();\n  initCalendar();\n};\n// 初始化日历\nconst initCalendar = () => {\n  if (Number(selectedVal.split(\"/\")[2]) < 10) {\n    selectedDate.value = `${selectedVal.split(\"/\")[0]}/${selectedVal.split(\"/\")[1]}/0${selectedVal.split(\"/\")[2]}`;\n  } else {\n    selectedDate.value = `${selectedVal.split(\"/\")[0]}/${selectedVal.split(\"/\")[1]}/${selectedVal.split(\"/\")[2]}`;\n  }\n  // ⚠️注意：new Date中的month要减1才是真正的本月月数，即本月：month - 1，下个月：month\n  // ⚠️注意：下个月的第0天即为本月的最后一天\n  // 上个月总天数（本月第0天日期）\n  const prepMonthDays = new Date(yearNow.value, monthNow.value - 1, 0).getDate();\n  // 上个月最后一天星期几（本月第0天星期数）\n  const prepMonthEndDayWeek = new Date(yearNow.value, monthNow.value - 1, 0).getDay();\n  // 当前月总天数（下个月第0天日期）\n  const thisMonthDays = new Date(yearNow.value, monthNow.value, 0).getDate();\n  // 当前月第一天是星期几\n  const firstDayWeek = new Date(yearNow.value, monthNow.value - 1, 1).getDay();\n  // 当前月最后一天是星期几（下个月第0天星期数）\n  const thisEndDayWeek = new Date(yearNow.value, monthNow.value, 0).getDay();\n  // 需要计算的总天数\n  var totalDays = firstDayWeek + thisMonthDays;\n  if (thisEndDayWeek < 6) {\n    // 星期天开始且本月最后一天是星期天之前，需补满最后一行\n    totalDays += 6 - thisEndDayWeek;\n  }\n  var index = 0;\n  for (index; index < totalDays; index++) {\n    // 上个月月底\n    if (index < firstDayWeek) {\n      // 上个月天数 - 上个月最后一天星期数 + 下标 (如：31 - 5 + 0)\n      const day = prepMonthDays - prepMonthEndDayWeek + index;\n      const date = new Date(yearNow.value, monthNow.value - 2, day).toLocaleDateString();\n      if (Number(date.split(\"/\")[2]) < 10) {\n        var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/0${date.split(\"/\")[2]}`;\n      } else {\n        var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/${date.split(\"/\")[2]}`;\n      }\n      if (day < 10) {\n        var dayVal = 0 + `${day}`;\n      } else {\n        var dayVal = day;\n      }\n      dates.value.push({ isPrep: true, dayVal, dateNowVal });\n    } else if (index >= firstDayWeek + thisMonthDays) {\n      // 下个月月初\n      // 下标 - 当前月总天数 - 当前月第一天星期数 + 1 (如：30 - 31 + 1 + 1)\n      const day = index - thisMonthDays - firstDayWeek + 1;\n      const date = new Date(yearNow.value, monthNow.value, day).toLocaleDateString();\n      if (Number(date.split(\"/\")[2]) < 10) {\n        var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/0${date.split(\"/\")[2]}`;\n      } else {\n        var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/${date.split(\"/\")[2]}`;\n      }\n      if (day < 10) {\n        var dayVal = 0 + `${day}`;\n      } else {\n        var dayVal = day;\n      }\n      dates.value.push({ isNext: true, dayVal, dateNowVal });\n    } else {\n      // 本月\n      // 下标 - 当前月第一天星期数 + 1 (如：5 - 5 + 1)\n      const day = index - firstDayWeek + 1;\n      const date = new Date(yearNow.value, monthNow.value - 1, day).toLocaleDateString();\n      if (Number(date.split(\"/\")[2]) < 10) {\n        var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/0${date.split(\"/\")[2]}`;\n      } else {\n        var dateNowVal = `${date.split(\"/\")[0]}/${date.split(\"/\")[1]}/${date.split(\"/\")[2]}`;\n      }\n      if (day < 10) {\n        var dayVal = 0 + `${day}`;\n      } else {\n        var dayVal = day;\n      }\n      dates.value.push({ dayVal, dateNowVal });\n    }\n  }\n};\ninitCalendar();\n// 获取日历事件\nconst getList = () => {\n  workingCalendar({ month: dateNow.value }).then(res => {\n    if (res.code == \"200\") {\n      calenderEvents.value = res.data;\n      calenderEvents.value.forEach(item => {\n        if (item.caleDate.split(\"-\")[1][0] == 0) {\n          let date = `${item.caleDate.split(\"-\")[0]}/${item.caleDate.split(\"-\")[1][1]}/${item.caleDate.split(\"-\")[2]}`;\n          item.caleDate = date;\n        } else {\n          let date = `${item.caleDate.split(\"-\")[0]}/${item.caleDate.split(\"-\")[1]}/${item.caleDate.split(\"-\")[2]}`;\n          item.caleDate = date;\n        }\n        dates.value.forEach(ele => {\n          if (item.caleDate === ele.dateNowVal) {\n            ele.eventList = item.item;\n            ele.caleType = item.caleType;\n            ele.eventList.forEach(jtem => {\n              if (jtem.dept === \"FG4-HR\") {\n                jtem.borderColor = \"#FFE4BA\"; // 橘\n                jtem.bgColor = \"#FFF7E8\";\n                jtem.color = \"#FF7D00\";\n              }\n              if (jtem.dept === \"FG4-BMD\") {\n                jtem.bgColor = \"#FFECE8\"; // 红\n                jtem.borderColor = \"#FDCDC5\";\n                jtem.color = \"#F53F3F\";\n              }\n              if (jtem.dept === \"FG4-FIN\") {\n                jtem.bgColor = \"#E8F3FF\"; // 蓝\n                jtem.borderColor = \"#C3E7FE\";\n                jtem.color = \"#4080FF\";\n              }\n            });\n          }\n        });\n      });\n    }\n  });\n};\ngetList();\n</script>\n\n<style lang=\"scss\" scoped>\n.tagTip {\n  margin-left: 17%;\n}\n.date {\n  overflow: hidden;\n  ul {\n    display: flex;\n    flex-wrap: wrap;\n    list-style: none;\n    padding-left: 0px;\n    width: 1080px;\n    li {\n      width: 140px;\n      border-width: 1px 1px 0 0;\n      border-color: #e0e6f1;\n      border-style: solid;\n      padding-left: 8px;\n      &.week {\n        height: 32px;\n        z-index: 999;\n        font-size: 14px;\n        color: #86909c;\n        font-family: \"PingFangSC-Regular\", \"PingFang SC\";\n        background-color: #f4f5ff;\n        display: flex;\n        align-items: center;\n      }\n      &.day {\n        height: 110px;\n        cursor: pointer;\n        font-size: 16px;\n        color: #86909c;\n        // 上个月、下个月\n        &.isNext,\n        &.isPrep {\n          cursor: default;\n          color: #a9aeb8;\n        }\n        .days {\n          display: inline-block;\n          text-align: center;\n          line-height: 28px;\n          width: 28px;\n          height: 28px;\n          margin-top: 8px;\n          font-size: 16px;\n        }\n        // 选中、hover\n        // &:hover,\n        &.isSelected {\n          .days {\n            background: #5370ff;\n            border-radius: 50%;\n            color: #fff;\n          }\n        }\n        &.isDisabled {\n          background-color: #f7f8fa;\n          color: #a9aeb8;\n        }\n      }\n    }\n    li:first-child,\n    :nth-child(7n + 1) {\n      border-left-width: 1px;\n    }\n    li:nth-last-child(7),\n    :nth-last-child(6),\n    :nth-last-child(5),\n    :nth-last-child(4),\n    :nth-last-child(3),\n    :nth-last-child(2),\n    :nth-last-child(1) {\n      border-bottom-width: 1px;\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}