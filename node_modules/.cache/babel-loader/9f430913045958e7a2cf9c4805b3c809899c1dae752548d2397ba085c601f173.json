{"ast":null,"code":"\"use strict\";\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar util_1 = require(\"../util\");\nvar bk_1 = require(\"./bk\");\nvar positionY = function (g) {\n  var layering = (0, util_1.buildLayerMatrix)(g);\n  var rankSep = g.graph().ranksep;\n  var prevY = 0;\n  layering === null || layering === void 0 ? void 0 : layering.forEach(function (layer) {\n    var heights = layer.map(function (v) {\n      return g.node(v).height;\n    });\n    var maxHeight = Math.max.apply(Math, __spreadArray(__spreadArray([], heights, false), [0], false));\n    layer === null || layer === void 0 ? void 0 : layer.forEach(function (v) {\n      g.node(v).y = prevY + maxHeight / 2;\n    });\n    prevY += maxHeight + rankSep;\n  });\n};\nvar positionX = function (g) {\n  var layering = (0, util_1.buildLayerMatrix)(g);\n  var conflicts = Object.assign((0, bk_1.findType1Conflicts)(g, layering), (0, bk_1.findType2Conflicts)(g, layering));\n  var xss = {};\n  var adjustedLayering = [];\n  [\"u\", \"d\"].forEach(function (vert) {\n    adjustedLayering = vert === \"u\" ? layering : Object.values(layering).reverse();\n    [\"l\", \"r\"].forEach(function (horiz) {\n      if (horiz === \"r\") {\n        adjustedLayering = adjustedLayering.map(function (inner) {\n          return Object.values(inner).reverse();\n        });\n      }\n      var neighborFn = (vert === \"u\" ? g.predecessors : g.successors).bind(g);\n      var align = (0, bk_1.verticalAlignment)(g, adjustedLayering, conflicts, neighborFn);\n      var xs = (0, bk_1.horizontalCompaction)(g, adjustedLayering, align.root, align.align, horiz === \"r\");\n      if (horiz === \"r\") {\n        Object.keys(xs).forEach(function (xsKey) {\n          return xs[xsKey] = -xs[xsKey];\n        });\n      }\n      xss[vert + horiz] = xs;\n    });\n  });\n  var smallestWidth = (0, bk_1.findSmallestWidthAlignment)(g, xss);\n  smallestWidth && (0, bk_1.alignCoordinates)(xss, smallestWidth);\n  return (0, bk_1.balance)(xss, g.graph().align);\n};\nvar position = function (g) {\n  var _a;\n  var ng = (0, util_1.asNonCompoundGraph)(g);\n  positionY(ng);\n  var xs = positionX(ng);\n  (_a = Object.keys(xs)) === null || _a === void 0 ? void 0 : _a.forEach(function (key) {\n    ng.node(key).x = xs[key];\n  });\n};\nexports.default = position;","map":{"version":3,"mappings":"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","names":["positionY","g","layering","rankSep","graph","ranksep","prevY","forEach","layer","heights","map","v","node","height","maxHeight","Math","max","y","positionX","conflicts","Object","assign","xss","adjustedLayering","vert","values","reverse","horiz","inner","neighborFn","predecessors","successors","bind","align","xs","root","keys","xsKey","smallestWidth","position","ng","key","x","exports"],"sourceRoot":"","sources":["../../../../../src/layout/dagre/src/position/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}