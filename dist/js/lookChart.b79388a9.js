"use strict";(self["webpackChunkoms_frontend"]=self["webpackChunkoms_frontend"]||[]).push([[854],{2645:function(e,t,a){a.d(t,{$h:function(){return d},FB:function(){return s},Rh:function(){return o},Z2:function(){return c},e5:function(){return p},jG:function(){return r},jy:function(){return u},uh:function(){return n},yJ:function(){return i}});var l=a(4471);function o(e){return(0,l.Z)({url:"/yoyAnalysis/queryYoyAnalysisDept",method:"post",data:e})}function r(e){return(0,l.Z)({url:"/yoyAnalysis/queryYoyAnalysisChart",method:"post",data:e})}function i(e){return(0,l.Z)({url:"/LinkAnalysis/getDeptEcharts",method:"post",data:e})}function n(e){return(0,l.Z)({url:"/LinkAnalysis/getCustomerEcharts",method:"post",data:e})}function s(e){return(0,l.Z)({url:"/LinkAnalysis/getProjectEcharts",method:"post",data:e})}function c(e){return(0,l.Z)({url:"/yoyAnalysis/queryCustomerYoyAnalysisChart",method:"post",data:e})}function d(e){return(0,l.Z)({url:"/yoyAnalysis/getProjectEcharts",method:"post",data:e})}function u(e){return(0,l.Z)({url:"/LinkAnalysis/getCustomer",method:"post",data:e})}function p(e){return(0,l.Z)({url:"/LinkAnalysis/getProject",method:"post",data:e})}},3980:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var l=a(3396),o=a(4870),r=a(7139),i=a(6221),n=a(2645),s=a(4842),c=a(4722);const d={class:"defaultPadding"},u={class:"flex-center"},p={class:"flex"},m={class:"m-r-90"},y=["src"],g={class:"m-r-80"},h=["src"],f={class:"modal-title"},b={style:{"text-align":"center"}};var v={__name:"lookChart",setup(e){let{year:t,month:v}=(0,c.Xn)();const x=a(4036),k=a(7804);let w=(0,l.FN)().appContext.config.globalProperties.$bus,{barChartOptions:S,deptId:A,sourceType:_,deptName:I,customerName:j,projectName:C,title:U,taxRate:Z,projectId:N}=window.history.state;S=JSON.parse(S).filter((e=>"发薪人数"!==e.title));const $=(0,o.iH)(null),D=(0,o.iH)(!1);let F,L={dept:"部门",customer:"客户",project:"项目"};const B=(0,o.iH)("colNo2"),E=(0,o.iH)("colNo12"),W=()=>{K()},Y=(0,o.qj)({visible:!1,selectItem:"",options:[],loading:!1}),T=()=>{if(Y.visible=!0,0===Y.options.length)switch(_){case"dept":R();break;case"customer":O();break;case"project":P();break;default:break}},R=()=>{if(0===Y.options.length){Y.loading=!0;let e={interval:v-1};(0,n.Rh)(e).then((e=>{if("200"===e.code){function t(e){e.forEach((e=>{e.value=e.deptId,e?.children?.length?t(e.children):delete e.children}))}t(e.data),Y.options=e.data}else s.Z.error(e.message||"数据请求失败")})).catch((e=>{s.Z.error(e.message||"数据请求失败")})).finally((()=>{Y.loading=!1}))}},O=()=>{if(0===Y.options.length){Y.loading=!0;let e={deptId:A,interval:v-1};(0,n.jy)(e).then((e=>{if("200"===e.code){function t(e){e.forEach((e=>{e.value=e.title,e.label=e.title,e?.children?.length?t(e.children):delete e.children}))}t(e.data),Y.options=e.data}else s.Z.error(e.message||"数据请求失败")})).catch((e=>{s.Z.error(e.message||"数据请求失败")})).finally((()=>{Y.loading=!1}))}},P=()=>{if(0===Y.options.length){Y.loading=!0;let e={deptId:A,interval:v-1};(0,n.e5)(e).then((e=>{if("200"===e.code){function t(e){e.forEach((e=>{e.label=e.title,e.value=e.title,e?.children?.length?t(e.children):(e.label=e.projectName,e.value=e.projectName,delete e.children)}))}t(e.data),Y.options=e.data}else s.Z.error(e.message||"数据请求失败")})).catch((e=>{s.Z.error(e.message||"数据请求失败")})).finally((()=>{Y.loading=!1}))}},H=e=>{let a={deptId:e||A,barType:(0,o.SU)(B),lineType:(0,o.SU)(E),tagKey:"yoyAnalysis",interval:v-1};D.value=!0,(0,n.jG)(a).then((e=>{if("200"===e.code){let{lastYear:a,thisYear:l}=e.data;V.legend={data:[" "+(t-1),` ${t}`,t-1+" ",`${t} `],bottom:0},V.series=[{name:" "+(t-1),type:"bar",yAxisIndex:2,itemStyle:{color:"#6BD4B3"},data:a.bar},{name:` ${t}`,type:"bar",yAxisIndex:2,itemStyle:{color:"#3491FA"},data:l.bar},{name:t-1+" ",type:"line",itemStyle:{color:"#FA6E6C"},data:a.line},{name:`${t} `,type:"line",itemStyle:{color:"#0D8731"},data:l.line}],F&&F.setOption(V)}else s.Z.error(e.message||"数据请求失败")})).catch((e=>{s.Z.error(e.message||"数据请求失败")})).finally((()=>{D.value=!1}))},J=e=>{let a={deptId:A,barType:(0,o.SU)(B),lineType:(0,o.SU)(E),interval:v-1,tagKey:"yoyAnalysis2",title:e||U};D.value=!0,(0,n.Z2)(a).then((e=>{if("200"===e.code){let{lastYear:a,thisYear:l}=e.data;V.legend={data:[" "+(t-1),` ${t}`,t-1+" ",`${t} `],bottom:0},V.series=[{name:" "+(t-1),type:"bar",yAxisIndex:2,itemStyle:{color:"#6BD4B3"},data:a.bar},{name:` ${t}`,type:"bar",yAxisIndex:2,itemStyle:{color:"#3491FA"},data:l.bar},{name:t-1+" ",type:"line",itemStyle:{color:"#FA6E6C"},data:a.line},{name:`${t} `,type:"line",itemStyle:{color:"#0D8731"},data:l.line}],F&&F.setOption(V)}else s.Z.error(e.message||"数据请求失败")})).catch((e=>{s.Z.error(e.message||"数据请求失败")})).finally((()=>{D.value=!1}))},q=e=>{let a={deptId:A,barType:(0,o.SU)(B),lineType:(0,o.SU)(E),interval:v-1,title:e?.projectName||C,tagKey:"yoyAnalysis3",taxRate:e?.taxRate||Z,projectId:e?.projectId||N};D.value=!0,(0,n.$h)(a).then((e=>{if("200"===e.code){let{lastYear:a,thisYear:l}=e.data;V.legend={data:[" "+(t-1),` ${t}`,t-1+" ",`${t} `],bottom:0},V.series=[{name:" "+(t-1),type:"bar",yAxisIndex:2,itemStyle:{color:"#6BD4B3"},data:a.bar},{name:` ${t}`,type:"bar",yAxisIndex:2,itemStyle:{color:"#3491FA"},data:l.bar},{name:t-1+" ",type:"line",itemStyle:{color:"#FA6E6C"},data:a.line},{name:`${t} `,type:"line",itemStyle:{color:"#0D8731"},data:l.line}],F&&F.setOption(V)}else s.Z.error(e.message||"数据请求失败")})).catch((e=>{s.Z.error(e.message||"数据请求失败")})).finally((()=>{D.value=!1}))};function z(e,t){let a={};function l(e){e.forEach((e=>{Object.keys(t).forEach((l=>{e[l]===t[l]&&(a=e)})),e?.children?.length&&l(e.children)}))}return l(e),a}const G=()=>{if(Y.visible=!1,Y.selectItem){let e;switch(_){case"dept":e=z(Y.options,{deptId:Y.selectItem}),w.emit("updateStructure",[{type:"text",color:"#333",msg:"环比分析列表"},{type:"button",color:"#5370FD",msg:e.deptName,isBack:!0}]),H(e.deptId);break;case"customer":e=z(Y.options,{title:Y.selectItem}),w.emit("updateStructure",[{type:"text",color:"#333",msg:"环比分析列表"},{type:"text",color:"#333",msg:I},{type:"button",color:"#5370FD",msg:e.title,isBack:!0}]),J(e.title);break;case"project":e=z(Y.options,{projectName:Y.selectItem}),w.emit("updateStructure",[{type:"text",color:"#333",msg:"环比分析列表"},{type:"text",color:"#333",msg:I},{type:"text",color:"#333",msg:`${e.groupCustomerName}-${j}`},{type:"button",color:"#5370FD",msg:e.projectName,isBack:!0}]);let{finPcode:t,taxRate:a,projectName:l}=e;q({projectId:t,taxRate:a,projectName:l});break;default:break}}},K=()=>{let e;switch(_){case"dept":e=[{type:"text",color:"#333",msg:"同比分析列表"},{type:"button",color:"#5370FD",msg:I,isBack:!0}],H();break;case"customer":e=[{type:"text",color:"#333",msg:"同比分析列表"},{type:"text",color:"#333",msg:I},{type:"button",color:"#5370FD",msg:U,isBack:!0}],J();break;case"project":e=[{type:"text",color:"#333",msg:"同比分析列表"},{type:"text",color:"#333",msg:I},{type:"text",color:"#333",msg:`${U}-${j}`},{type:"button",color:"#5370FD",msg:C,isBack:!0}],q();break;default:break}w.emit("updateStructure",e)};(0,l.wF)((()=>{K()}));const V={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},grid:{left:"15%"},xAxis:[{type:"category",axisTick:{alignWithLabel:!0},data:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}],yAxis:[{type:"value",position:"right",alignTicks:!0,axisLine:{show:!0,lineStyle:{color:"#797979"}},axisLabel:{color:"#666",formatter:"{value}"},splitLine:{show:!1}},{min:10,max:100,type:"value",position:"left",offset:80,boundaryGap:[0,.01],axisLine:{show:!0,lineStyle:{color:"#797979"}},axisLabel:{color:"#666",formatter:"{value}%"},splitLine:{show:!1}},{type:"value",position:"left",alignTicks:!0,axisLine:{show:!0,lineStyle:{color:"#797979"}},axisLabel:{color:"#666",formatter:"{value}"},splitLine:{show:!1}}],series:[]};return(0,l.bv)((()=>{F=i.S1((0,o.SU)($)),V&&F.setOption(V)})),(e,t)=>{const a=(0,l.up)("a-option"),i=(0,l.up)("a-select"),n=(0,l.up)("a-radio"),s=(0,l.up)("a-radio-group"),c=(0,l.up)("a-button"),v=(0,l.up)("a-spin"),w=(0,l.up)("a-cascader-panel"),A=(0,l.up)("a-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[(0,l._)("header",u,[(0,l._)("div",p,[(0,l._)("div",m,[(0,l._)("span",null,[(0,l._)("img",{src:(0,o.SU)(x),width:"26",class:"img"},null,8,y)]),(0,l.Wm)(i,{style:{width:"192px"},"model-value":B.value,"onUpdate:model-value":t[0]||(t[0]=e=>B.value=e),onChange:W},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(S),(e=>((0,l.wg)(),(0,l.j4)(a,{key:e.dataIndex,value:e.dataIndex},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.title),1)])),_:2},1032,["value"])))),128))])),_:1},8,["model-value"])]),(0,l._)("div",g,[(0,l._)("img",{src:(0,o.SU)(k),width:"26",class:"img"},null,8,h),(0,l.Wm)(s,{type:"button",size:"large","model-value":E.value,"onUpdate:model-value":t[1]||(t[1]=e=>E.value=e),onChange:W},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{value:"colNo12"},{default:(0,l.w5)((()=>[(0,l.Uk)("C1发薪人数")])),_:1}),(0,l.Wm)(n,{value:"colNo13"},{default:(0,l.w5)((()=>[(0,l.Uk)("R/S/G/C2发薪人数")])),_:1})])),_:1},8,["model-value"])]),(0,l._)("div",null,[(0,l.Wm)(c,{type:"primary",onClick:T},{default:(0,l.w5)((()=>[(0,l.Uk)("切换"+(0,r.zw)((0,o.SU)(L)[(0,o.SU)(_)]),1)])),_:1})])])]),(0,l._)("main",null,[(0,l.Wm)(v,{loading:D.value,tip:"数据加载中...",style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l._)("div",{ref_key:"chartContainerRef",ref:$,class:"chartContainer"},null,512)])),_:1},8,["loading"])])]),(0,l.Wm)(A,{visible:Y.visible,"onUpdate:visible":t[4]||(t[4]=e=>Y.visible=e),width:"650px","title-align":"start"},{title:(0,l.w5)((()=>[(0,l._)("span",f,"切换"+(0,r.zw)((0,o.SU)(L)[(0,o.SU)(_)]),1)])),footer:(0,l.w5)((()=>[(0,l._)("div",b,[(0,l.Wm)(c,{type:"outline",class:"m-r-10",onClick:t[3]||(t[3]=e=>Y.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(c,{type:"primary",onClick:G},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(v,{loading:Y.loading,style:{width:"100%"},tip:"数据加载中..."},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{options:Y.options,modelValue:Y.selectItem,"onUpdate:modelValue":t[2]||(t[2]=e=>Y.selectItem=e),"expand-child":""},null,8,["options","modelValue"])])),_:1},8,["loading"])])),_:1},8,["visible"])],64)}}},x=a(89);const k=(0,x.Z)(v,[["__scopeId","data-v-579e3a39"]]);var w=k},4036:function(e,t,a){e.exports=a.p+"img/barChart.602b47b2.svg"},7804:function(e,t,a){e.exports=a.p+"img/lineChart.2802e5b8.svg"}}]);
//# sourceMappingURL=lookChart.b79388a9.js.map