"use strict";(self["webpackChunkoms_frontend"]=self["webpackChunkoms_frontend"]||[]).push([[250],{8541:function(e,l,a){a.d(l,{Z:function(){return c}});var t=a(3396),o=a(6221);const i=e=>((0,t.dD)("data-v-fa0df8b4"),e=e(),(0,t.Cn)(),e),d=i((()=>(0,t._)("div",{id:"conversion"},null,-1))),n=[d];var r={__name:"scatterPlot",props:{seriesData:Array,color:Array},setup(e){const l=e;var a;(0,t.YP)((()=>[l.seriesData,l.color]),(([e,l])=>{i(e,l)}));const i=(e,l)=>{null!=a&&""!=a&&void 0!=a&&a.dispose();var t,i=document.getElementById("conversion");a=o.S1(i),t={color:l,legend:{itemHeight:15,top:"center",right:"right",textStyle:{color:"black",fontSize:12}},grid:{left:"10%",right:"15%",top:"18%"},tooltip:{axisPointer:{type:"cross"},padding:10,borderColor:"rgb(233, 234, 235)",formatter:function(e){var l=e.value,a=`<div style="border-bottom: 1px solid rgba(255,255,255,.3);">\n          <span>${l[2]}</span>\n          </div>`;return a}},xAxis:{type:"value",name:"销售收入/元",nameGap:16,splitLine:{show:!1}},yAxis:{type:"value",name:"销售毛利/元",nameLocation:"end",nameGap:20,splitLine:{show:!1}},series:e},t&&a.setOption(t)};return(0,t.bv)((()=>{i(l.seriesData,l.color)})),(e,l)=>((0,t.wg)(),(0,t.iD)("div",null,n))}},s=a(89);const u=(0,s.Z)(r,[["__scopeId","data-v-fa0df8b4"]]);var c=u},6471:function(e,l,a){a.r(l),a.d(l,{default:function(){return me}});var t=a(3396),o=(a(7658),a(7139)),i=a(9242),d=a(4870),n=a(4842),r=a(8541),s=a(4239),u=a(7373),c=a(4722),v=a(6797),m=a.n(v);const p={class:"defaultPadding"},f={class:"m-b-26 flex-between"},g={class:"flex m-r-24"},b={class:"m-r-24"},y=["onClick"],h={key:1,class:"pointer"},w={href:"javaScript:void(0)",style:{color:"#333"}},_={class:"defaultPadding"},x={class:"m-b-26 flex-between"},k={class:"m-r-24"},H=["onClick"],C={key:1,class:"pointer"},U={class:"level3Header"},W={class:"w-perct-80"},B={class:"item"},D=(0,t._)("span",null,"项目营业收入：",-1),N={class:"item"},I=(0,t._)("span",null,"项目销售毛利：",-1),E={class:"item"},S=(0,t._)("span",null,"项目销售毛利率：",-1),z={class:"item"},j=(0,t._)("span",null,"项目C1总人数：",-1),R={class:"item"},Y=(0,t._)("span",null,"项目人员利用率：",-1),A={key:0,class:"defaultPadding"},L={class:"m-b-20"},Z={class:"m-b-20 flex-between"},F={class:"pointer"},O={key:1},$=(0,t._)("span",null,"颜色维度：",-1),K=(0,t._)("div",null,"选项说明:",-1),M=(0,t._)("div",null,"1、出勤=月实际工时天数+法定节假日-实际发薪天数",-1),V=(0,t._)("span",{class:"modal-title"},"设置项目行为角色",-1),q={class:"flex-center"},P={class:"modal-label"},T={class:"text-center"},G=(0,t._)("span",{class:"modal-title"},"详情-集团客户",-1),J=(0,t._)("div",{class:"blocInfoModal-content-title"},"集团客户名称：集团客户-三星",-1),Q={class:"text-center"},X=(0,t._)("span",{class:"modal-title"},"详情-客户",-1),ee={class:"m-b-30"},le=(0,t._)("div",{class:"customerModal-content-title"},"基本信息",-1),ae=(0,t._)("div",{class:"customerModal-content-title"},"人员信息",-1),te={class:"text-center"},oe=(0,t._)("span",{class:"modal-title"},"详情-项目",-1),ie={class:"m-b-30"},de=(0,t._)("div",{class:"customerModal-content-title"},"基本信息",-1),ne={class:"m-b-30"},re=(0,t._)("div",{class:"customerModal-content-title"},"人员信息",-1),se=(0,t._)("div",{class:"customerModal-content-title"},"经营信息",-1),ue={class:"text-center"};var ce={__name:"drillAnalyze",setup(e){let l=(0,t.FN)().appContext.config.globalProperties.$bus;const a=(0,d.iH)("list");let v=[],ce=(0,s.mA)(),ve="",me={},pe={},fe={};const ge=(0,d.iH)([{label:1,value:"出勤"},{label:2,value:"入职日期"}]),be=(0,d.iH)(1),ye=(0,d.iH)([]),he=(0,d.iH)([]),we=(0,d.iH)("list"),_e=e=>e.valueOf()<m()("2023-01-01 00:00:00").valueOf(),xe=(0,d.iH)({}),ke=()=>{let e=(0,d.IU)(ce.getTagColumnList)||[],l=e.filter((e=>"下钻分析"===e.report))||[];l.length&&l[0].tier.forEach(((e,l)=>{let a=[],o={};e.tags.forEach((e=>{a.push(e.tag);let l=[];e.columns.forEach((e=>{let{col:a,conf:o,title:i}=e;o=o||{};let d={title:i,dataIndex:a,align:o.align,cellStyle:{"text-align":o.cellAlign},width:o.width,ellipsis:!0,headerCellClass:"noEllipsis",slotName:a,titleSlotName:"columTitleSlot"};void 0!==o.fixed&&(d.fixed=o.fixed),void 0!==o.toFixed&&(o.showPercent?d.render=({record:e})=>(0,t.Wm)("span",{innerHTML:(0,c.RO)(e[a],o.toFixed,o.isRed)},null):d.render=({record:e})=>(0,t.Wm)("span",{innerHTML:(0,c.Z3)(e[a],o.toFixed,o.isRed)},null)),l.push(d)})),o[e.tag.key]=l})),fe["level"+(l+1)]={tabs:a,params:e.params||[],columns:o}}));let{level1:a,level2:o,level3:i}=fe;Ie.value=a.tabs[0].key,Se.value=o.tabs[1].key,je.value=i.tabs[1].key,Ye.level1.tabs=a.tabs,Ye.level1.columns=a.columns,Ye.level2.tabs=o.tabs,Ye.level2.columns=o.columns,Ye.level3.tabs=i.tabs,Ye.level3.columns=i.columns},He=(0,d.iH)("level1");let{year:Ce,month:Ue}=(0,c.Ux)(),We=`${Ce}-${Ue}`;const Be=(0,d.iH)(We),De=(0,d.iH)(0),Ne=()=>{const e={month:Be.value};(0,u.mQ)(e).then((e=>{"200"===e.code&&(De.value=e.data)})).catch((()=>{n.Z.error("请求失败")}))},Ie=(0,d.iH)("coreData"),Ee=(0,d.iH)(!0),Se=(0,d.iH)("coreData2"),ze=(0,d.iH)(!0),je=(0,d.iH)("empInfo"),Re=(0,d.iH)(!0),Ye=(0,d.qj)({loading:!1,level1:{tabs:[],columns:{},data:[],defaultExpandedKeys:[],maxHeight:"200px"},level2:{tabs:[],columns:{},data:[],defaultExpandedKeys:[],maxHeight:"200px"},level3:{tabs:[],columns:{},data:[],defaultExpandedKeys:[],maxHeight:"200px"}}),Ae=(0,d.iH)(null),Le=(0,d.iH)(null),Ze=(0,d.iH)(null),Fe=e=>{Be.value=e,Ne(),Ke(Ie.value)};(0,t.wF)((()=>{"00"==Ue&&(We=Ce-1+"-12",Be.value=We),ke(),Ke(Ie.value),Ne()}));const Oe=e=>{if(e.raw.deptLevel%2===0)return"row-gray"},$e=e=>{Pe(e)},Ke=e=>{let l=Be.value+"",a=l.replaceAll("-",""),o={month:a,tagKey:e};Ye.loading=!0,Ee.value=!0,(0,u.Rn)(o).then((e=>{if("200"===e.code){let l=(0,c.th)(e.data,"key","id"),a=[];if(e.data.forEach((e=>a.push(e.id))),Ye.level1.defaultExpandedKeys=a,Ye.level1.data=l,Ae.value){let e=Ae.value.$el,l=e.getBoundingClientRect().top,a=window.innerHeight;Ye.level1.maxHeight=a-l+"px",(0,t.Y3)((()=>{let e=document.getElementById("a-layout-main");if(e){let l=e.scrollHeight-e.offsetHeight;Ye.level1.maxHeight=parseInt(Ye.level1.maxHeight)-l+"px"}}))}}else Ye.level1.data=[],n.Z.error(e.desc||"请求数据失败")})).catch((e=>{n.Z.error(e.message||"请求数据失败")})).finally((()=>{Ye.loading=!1,Ee.value=!1}))};let Me=[];function Ve(e){e.forEach((e=>{Me.push(e.title),e.children&&e.children.length&&Ve(e.children)}))}const qe=e=>{Ye.loading=!0,ze.value=!0,l.emit("goBackDisabled",!0);let a=Be.value+"",o=a.replaceAll("-",""),i={deptId:me.id,month:o,tagKey:e};Array.isArray(fe.level1.params)&&fe.level1.params.forEach((e=>{i[e]=(0,c.HI)(me[e]),void 0!==me[e]&&null!==me[e]||(i[e]=(0,c.HI)(0))})),(0,u.qP)(i).then((e=>{if("200"===e.code){let l=(0,c.th)(e.data,"key","title");if(Ve(e.data),Ye.level2.defaultExpandedKeys=Me,Ye.level2.data=l,"financeManage2"!==Se.value&&(v=l),Le.value){let e=Le.value.$el,l=window.innerHeight,a=e.getBoundingClientRect().top;Ye.level2.maxHeight=l-a+"px"}(0,t.Y3)((()=>{let e=document.getElementById("a-layout-main");if(e){let l=e.scrollHeight-e.offsetHeight;Ye.level2.maxHeight=parseInt(Ye.level2.maxHeight)-l+"px"}}))}else Ye.level2.data=[],n.Z.error(e.desc||"操作失败")})).catch((e=>{n.Z.error(e.message||"请求数据失败")})).finally((()=>{Ye.loading=!1,ze.value=!1,l.emit("goBackDisabled",!1)}))},Pe=e=>{let a=Be.value+"",o=a.replaceAll("-",""),i={projectCode:ve,deptId:me.id,month:o,tagKey:e};Array.isArray(fe.level2.params)&&fe.level2.params.forEach((e=>{i[e]=(0,c.HI)(pe[e]),void 0!==pe[e]&&null!==pe[e]||(i[e]=(0,c.HI)(0))})),Ye.loading=!0,Re.value=!0,l.emit("goBackDisabled",!0),(0,u.Qg)(i).then((e=>{if("200"===e.code){let l=(0,c.th)(e.data,"key","id"),a=[];if(e.data.forEach((e=>a.push(e.id))),Ye.level3.defaultExpandedKeys=a,Ye.level3.data=l,Ze.value){let e=Ze.value.$el,l=window.innerHeight,a=e.getBoundingClientRect().top;Ye.level3.maxHeight=l-a+"px"}(0,t.Y3)((()=>{let e=document.getElementById("a-layout-main");if(e){let l=e.scrollHeight-e.offsetHeight;Ye.level3.maxHeight=parseInt(Ye.level3.maxHeight)-l+"px"}}))}else Ye.level3.data=[],n.Z.error(e.desc||"请求数据失败")})).catch((e=>{n.Z.error(e.message||"请求数据失败")})).finally((()=>{Ye.loading=!1,Re.value=!1,l.emit("goBackDisabled",!1)})),el(be.value)},Te=e=>{Ke(e)},Ge=e=>{qe(e)};(0,t.m0)((()=>{l.emit("updateStructure",[{type:"text",color:"#333",msg:`${m()(Be.value).format("YYYY年MM月")} (${De.value}天)`}])})),l.on("goBack",(e=>{switch(He.value=e,e){case"level1":let e=[{type:"text",color:"#333",msg:`${m()(Be.value).format("YYYY年MM月")} (${De.value}天)`}];l.emit("updateStructure",e);break;case"level2":let a=[{type:"button",color:"#5370FD",msg:`${m()(Be.value).format("YYYY年MM月")} (${De.value}天)`,params:"level1"},{type:"text",color:"#333",msg:me.deptName}];l.emit("updateStructure",a);break;default:break}})),(0,t.Ah)((()=>{l.off("goBack")}));const Je=(e,a)=>{if(He.value=e,"level2"===e){me=a,qe(Se.value);let e=[{type:"button",color:"#5370FD",msg:`${m()(Be.value).format("YYYY年MM月")} (${De.value}天)`,params:"level1"},{type:"text",color:"#333",msg:me.deptName}];l.emit("updateStructure",e),tl.value=[]}if("level3"===e){ve=a.projectNo,pe=a;let{groupCustomerName:e,customerName:t,title:o}=a,i=v.filter((l=>l.title===e)),d=i&&i[0]?.children.filter((e=>e.title===t)),n=d&&d[0]?.children.filter((e=>e.title===o));xe.value=n&&n[0]||{},Pe(je.value);let r=[{type:"button",color:"#5370FD",msg:`${m()(Be.value).format("YYYY年MM月")} (${De.value}天)`,params:"level1"},{type:"button",color:"#5370FD",msg:me.deptName,params:"level2"},{type:"text",color:"#333",msg:`项目： ${a.title}`}];l.emit("updateStructure",r)}},Qe=e=>{Ye[He.value].defaultExpandedKeys=e},Xe=(0,d.iH)(!1),el=e=>{Xe.value=!0;let l=Be.value+"",a=l.replaceAll("-",""),t={projectCode:ve,deptId:me.id,month:a,tagKey:je.value,type:e};Array.isArray(fe.level2.params)&&fe.level2.params.forEach((e=>{t[e]=(0,c.HI)(pe[e]),void 0!==pe[e]&&null!==pe[e]||(t[e]=(0,c.HI)(0))})),(0,u.pb)(t).then((l=>{if("200"===l.code){ye.value=l.data;var a={shadowBlur:10,shadowColor:"rgba(120, 36, 50, 0.5)",shadowOffsetY:5};ye.value.forEach((e=>{e.type="scatter",e.itemStyle=a,e.symbolSize=15}))}he.value=1===e?["#503e6a","#fec42c","#f96f0d","#dd4444"]:["#f6d91d","#fec42c","#fb954d","#f6682c","#f81313","#7d1d07"]})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{Xe.value=!1}))},ll=e=>{be.value=e,el(e)},al=e=>{we.value=e},tl=(0,d.iH)([]),ol=(e,l)=>{let a=tl.value.findIndex((e=>e.id===l.id));e?tl.value.length>0?-1===a&&tl.value.push((0,d.IU)(l)):tl.value.push((0,d.IU)(l)):tl.value.length>0&&-1!==a&&tl.value.splice(a,1)},il=(0,d.qj)({visible:!1,selectOptions:[],loading:!1,roles:[{label:"项目经理角色",value:void 0},{label:"收入上报角色",value:void 0},{label:"薪资异动上报角色",value:void 0},{label:"考勤上报角色",value:void 0}],confirmBtnLoading:!1}),dl=async()=>{il.visible=!0;let e=[],l=[];il.roles.forEach((e=>{e.value=void 0}));try{let l={projectNo:tl.value.map((e=>e.projectNo)).toString()},a=await(0,u.MI)(l);"200"===a.code&&(e=a.data)}catch(a){n.Z.error("请求数据失败")}try{il.loading=!0;let a={deptName:me.deptName},t=await(0,u.p9)(a);"200"===t.code&&(il.selectOptions=Array.isArray(t.data)&&(0,d.Xl)(t.data.map((a=>(e.forEach((e=>{a.id===e.empId&&l.push({...a,roleId:e.roleId})})),{value:JSON.stringify(a),label:`${a.empName} ( ${a.empCode},  ${a.deptName} )`}))))||[])}catch(a){n.Z.error("请求数据失败")}tl.value.length>1||(l.length?il.roles.forEach((e=>{let a=l.findIndex((l=>l.roleId===e.label));-1!==a&&(delete l[a].roleId,e.value=JSON.stringify(l[a]))})):il.roles.forEach((e=>{e.value=void 0}))),il.loading=!1},nl=()=>{il.roles.forEach((e=>{e.value=void 0})),il.visible=!1},rl=()=>{let e=[];if(il.roles.forEach((l=>{void 0!==l.value&&""!==l.value||e.push(" ")})),e.length===il.roles.length)return n.Z.error("至少选择一条");il.confirmBtnLoading=!0;let l=[];il.roles.forEach((e=>{if(void 0!==e.value)try{let a=JSON.parse(e.value);l.push({dept:a.deptName||"",empId:a.id||"",empNo:a.empCode||"",empName:a.empName||"",roleId:e.label})}catch(a){throw Error(a)}}));let a={projectNos:tl.value.map((e=>e.projectNo)),info:l};(0,u.a1)(a).then((e=>{"200"===e.code?(n.Z.success(e.desc||"新建角色成功"),tl.value=[]):n.Z.error(e.message||"请求失败")})).catch((()=>{n.Z.error("请求失败")})).finally((()=>{il.confirmBtnLoading=!1,il.visible=!1}))},sl=(0,d.iH)(!1),ul=()=>{sl.value=!0;let e=Be.value+"",l=e.replaceAll("-",""),a={month:l};(0,u.I6)(a).then((e=>{const a=new Blob([e]),t=new FileReader;t.readAsText(e,"utf-8"),t.onerror=function(){n.Z.error("导出文件失败")};const o=`下钻分析_部门级别_${l}.xlsx`,i=document.createElement("a");i.download=o,i.style.display="none",i.href=URL.createObjectURL(a),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)})).catch((()=>{n.Z.error("导出失败")})).finally((()=>{sl.value=!1}))},cl=(0,d.iH)(!1),vl=()=>{cl.value=!0,n.Z.loading("下载时间较长，请耐心等待");let e=Be.value+"",l=e.replaceAll("-",""),a={month:l};(0,u.yk)(a).then((e=>{const a=new Blob([e]),t=`下钻分析_全部_${l}.xlsx`,o=document.createElement("a");o.download=t,o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)})).catch((()=>{n.Z.error("导出失败")})).finally((()=>{cl.value=!1}))},ml=(0,d.iH)(!1),pl=()=>{ml.value=!0;let e=Be.value+"",l=e.replaceAll("-",""),a={deptId:me.id,month:l,deptName:me.deptName,tagKey:Se.value};Array.isArray(fe.level1.params)&&fe.level1.params.forEach((e=>{a[e]=(0,c.HI)(me[e]),void 0!==me[e]&&null!==me[e]||(a[e]=(0,c.HI)(0))})),(0,u.x7)(a).then((e=>{const a=new Blob([e]),t=`下钻分析_客户项目级别_${l}.xlsx`,o=document.createElement("a");o.download=t,o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)})).catch((()=>{n.Z.error("导出失败")})).finally((()=>{ml.value=!1}))},fl=(0,d.iH)(!1),gl=()=>{fl.value=!0;let e=Be.value+"",l=e.replaceAll("-",""),a={projectCode:ve,deptId:me.id,month:l,tagKey:je.value,deptName:me.deptName,groupCustomer:xe.value.groupCustomerName+"",customer:xe.value.customerName+"",projectName:xe.value.title+""};Array.isArray(fe.level2.params)&&fe.level2.params.forEach((e=>{a[e]=(0,c.HI)(pe[e]),void 0!==pe[e]&&null!==pe[e]||(a[e]=(0,c.HI)(0))})),(0,u.nu)(a).then((e=>{const a=new Blob([e]),t=`下钻分析_人员级别_${l}.xlsx`,o=document.createElement("a");o.download=t,o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)})).catch((()=>{n.Z.error("导出失败")})).finally((()=>{fl.value=!1}))},bl=(0,d.qj)({visible:!1,tableColumns:[{title:"客户名称",dataIndex:"customerName",width:294,headerCellStyle:{background:"#F7F8FF",color:"#78797B"},cellStyle:{color:"#7B7B7B"}},{title:"行业",dataIndex:"industry",width:82,headerCellStyle:{background:"#F7F8FF",color:"#78797B"},cellStyle:{color:"#7B7B7B"}},{title:"地址",dataIndex:"adress",width:330,headerCellStyle:{background:"#F7F8FF",color:"#78797B"},cellStyle:{color:"#7B7B7B"}}],tableData:[{customerName:"三星半导体(中国)研究开发有限公司北京分公司",industry:"通信",adress:"北京市朝阳区北京市朝阳区太阳宫中路冠捷大厦8层",key:1}]}),yl=()=>{bl.visible=!1},hl=(0,d.qj)({visible:!1,basicColumn:2,basicData:[{label:"客户名称",value:"广州三星通信技术研究有限公司"},{label:"集团客户名称",value:"集团客户-三星"},{label:"行业",value:"信息技术"},{label:"开始合作时间",value:"2022-22-01"},{label:"区域",value:"大中华区"},{label:"地址",value:"广东省广州市黄埔区黄埔区科学城科学大道185号"}],staffColumn:2,staffData:[{label:"销售人员",value:"鲍雪欣"},{label:"销售人员部门",value:"BG2-STA-ERIREG_S"}]}),wl=(0,d.qj)({visible:!1,basicColumn:2,basicData:[{label:"客户名称",value:"广州三星通信技术研究有限公司"},{label:"集团客户名称",value:"集团客户-三星"},{label:"行业",value:"信息技术"},{label:"开始合作时间",value:"2022-22-01"},{label:"区域",value:"大中华区"},{label:"地址",value:"广东省广州市黄埔区黄埔区科学城科学大道185号"}],staffColumn:2,staffData:[{label:"所属部门",value:"BG1-MSD"},{label:"部门负责人",value:"金迪"}],manageColumn:2,manageData:[{label:"税率",value:" 6%"},{label:"预估毛利率",value:"50"},{label:"结算周期(天)",value:" 90"},{label:"回款周期(天)",value:"90"}]});return(e,l)=>{const n=(0,t.up)("a-month-picker"),s=(0,t.up)("a-radio"),u=(0,t.up)("a-radio-group"),v=(0,t.up)("icon-download"),m=(0,t.up)("a-button"),ce=(0,t.up)("a-popconfirm"),ve=(0,t.up)("a-space"),me=(0,t.up)("a-popover"),pe=(0,t.up)("a-tooltip"),fe=(0,t.up)("a-empty"),ke=(0,t.up)("a-table"),Ce=(0,t.up)("icon-user"),Ue=(0,t.up)("a-checkbox"),We=(0,t.up)("icon-export"),De=(0,t.up)("a-option"),Ne=(0,t.up)("a-select"),Ke=(0,t.up)("icon-info-circle-fill"),Me=(0,t.up)("a-spin"),Ve=(0,t.up)("icon-down"),qe=(0,t.up)("a-modal"),Pe=(0,t.up)("a-descriptions");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.wy)((0,t._)("div",p,[(0,t._)("div",f,[(0,t._)("div",g,[(0,t._)("div",b,[(0,t.Uk)(" 月份： "),(0,t.Wm)(n,{modelValue:Be.value,"onUpdate:modelValue":l[0]||(l[0]=e=>Be.value=e),style:{width:"120px","border-radius":"4px"},"allow-clear":!1,disabledDate:_e,onChange:Fe},null,8,["modelValue"])]),(0,t.Wm)(u,{type:"button",size:"large",modelValue:Ie.value,"onUpdate:modelValue":l[1]||(l[1]=e=>Ie.value=e),onChange:Te,disabled:Ee.value},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Ye.level1.tabs,(e=>((0,t.wg)(),(0,t.j4)(s,{value:e.key},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])]),(0,t.Wm)(ve,null,{default:(0,t.w5)((()=>[(0,t.Wm)(ce,{content:"确定导出全部吗?",onOk:vl},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{type:"outline",loading:cl.value,style:{"border-radius":"4px"}},{icon:(0,t.w5)((()=>[(0,t.Wm)(v)])),default:(0,t.w5)((()=>[(0,t.Uk)("导出全部")])),_:1},8,["loading"])])),_:1}),(0,t.Wm)(ce,{content:"确定导出本页吗?",onOk:ul},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{type:"primary",loading:sl.value,style:{"border-radius":"4px"}},{icon:(0,t.w5)((()=>[(0,t.Wm)(v)])),default:(0,t.w5)((()=>[(0,t.Uk)("导出本页")])),_:1},8,["loading"])])),_:1})])),_:1})]),(0,t.Wm)(ke,{"row-class":Oe,columns:Ye.level1.columns[Ie.value]||[],data:Ye.level1.data,bordered:!1,"column-resizable":"","expanded-keys":Ye.level1.defaultExpandedKeys,scroll:{maxHeight:Ye.level1.maxHeight},scrollbar:!1,pagination:!1,loading:Ye.loading,ref_key:"level1tableRef",ref:Ae,onExpandedChange:Qe},{lastDeptName:(0,t.w5)((({record:e})=>["level1"===He.value?((0,t.wg)(),(0,t.j4)(me,{key:0,"content-style":{background:"rgba(0,0,0,.8)",color:"#fff"},"arrow-style":{background:"rgba(0,0,0,.8)"}},{content:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.deptName),1)])),default:(0,t.w5)((()=>["1"===e.leafNode?((0,t.wg)(),(0,t.iD)("a",{key:0,href:"javaScript:void(0)",style:{color:"#165dff"},onClick:l=>Je("level2",e)},(0,o.zw)(e.lastDeptName),9,y)):((0,t.wg)(),(0,t.iD)("span",h,(0,o.zw)(e.lastDeptName),1))])),_:2},1032,["content-style","arrow-style"])):(0,t.kq)("",!0)])),columTitleSlot:(0,t.w5)((({column:e})=>[(0,t.Wm)(pe,{style:{width:"max-content"},content:e.title},{default:(0,t.w5)((()=>[(0,t._)("a",w,(0,o.zw)(e.title),1)])),_:2},1032,["content"])])),empty:(0,t.w5)((()=>[(0,t.Wm)(fe)])),_:1},8,["columns","data","expanded-keys","scroll","loading"])],512),[[i.F8,"level1"===He.value]]),(0,t.wy)((0,t._)("div",_,[(0,t._)("div",x,[(0,t._)("div",k,[(0,t.Wm)(u,{type:"button",size:"large",modelValue:Se.value,"onUpdate:modelValue":l[2]||(l[2]=e=>Se.value=e),onChange:Ge,disabled:ze.value},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Ye.level2.tabs,(e=>((0,t.wg)(),(0,t.j4)(s,{value:e.key},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])]),(0,t._)("div",null,[(0,t.Wm)(m,{type:"outline",disabled:0===tl.value.length,style:{"border-radius":"4px"},class:"m-r-24",onClick:dl},{icon:(0,t.w5)((()=>[(0,t.Wm)(Ce)])),default:(0,t.w5)((()=>[(0,t.Uk)("设置角色")])),_:1},8,["disabled"]),(0,t.Wm)(ce,{content:"确定导出本页吗?",onOk:pl},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{type:"primary",loading:ml.value,style:{"border-radius":"4px"}},{icon:(0,t.w5)((()=>[(0,t.Wm)(v)])),default:(0,t.w5)((()=>[(0,t.Uk)("导出本页")])),_:1},8,["loading"])])),_:1})])]),(0,t.Wm)(ke,{"row-class":Oe,columns:Ye.level2.columns[Se.value]||[],data:Ye.level2.data,bordered:!1,"column-resizable":"","expanded-keys":Ye.level2.defaultExpandedKeys,scroll:{maxHeight:Ye.level2.maxHeight},scrollbar:!1,pagination:!1,loading:Ye.loading,ref_key:"level2tableRef",ref:Le,onExpandedChange:Qe},{title:(0,t.w5)((({record:e})=>["1"===e.leafNode?((0,t.wg)(),(0,t.j4)(Ue,{key:0,class:"m-r-8",style:{"vertical-align":"middle"},"model-value":tl.value.length>0&&-1!==tl.value.findIndex((l=>l.id===e.id)),onChange:l=>ol(l,e)},null,8,["model-value","onChange"])):(0,t.kq)("",!0),"level2"===He.value?((0,t.wg)(),(0,t.j4)(me,{key:1,"content-style":{background:"rgba(0,0,0,.8)",color:"#fff"},"arrow-style":{background:"rgba(0,0,0,.8)"}},{content:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.title),1)])),default:(0,t.w5)((()=>["1"===e.leafNode?((0,t.wg)(),(0,t.iD)("a",{key:0,href:"javaScript:void(0)",style:{color:"#165dff"},onClick:l=>Je("level3",e)},(0,o.zw)(e.title),9,H)):((0,t.wg)(),(0,t.iD)("span",C,(0,o.zw)(e.title),1))])),_:2},1032,["content-style","arrow-style"])):(0,t.kq)("",!0)])),empty:(0,t.w5)((()=>[(0,t.Wm)(fe)])),_:1},8,["columns","data","expanded-keys","scroll","loading"])],512),[[i.F8,"level2"===He.value]]),(0,t.wy)((0,t._)("div",null,[(0,t._)("div",U,[(0,t._)("div",W,[(0,t.Wm)(ve,{wrap:"",size:[20,0]},{default:(0,t.w5)((()=>[(0,t._)("div",B,[D,(0,t.Uk)(" "+(0,o.zw)((0,d.SU)(c.Z3)(xe.value.colNo5,0)),1)]),(0,t._)("div",N,[I,(0,t.Uk)(" "+(0,o.zw)((0,d.SU)(c.Z3)(xe.value.colNo8,0)),1)]),(0,t._)("div",E,[S,(0,t.Uk)(" "+(0,o.zw)((0,d.SU)(c.RO)(xe.value.colNo9,2)),1)]),(0,t._)("div",z,[j,(0,t.Uk)(" "+(0,o.zw)((0,d.SU)(c.Z3)(xe.value.colNo1,0)),1)]),(0,t._)("div",R,[Y,(0,t.Uk)(" "+(0,o.zw)((0,d.SU)(c.RO)(xe.value.colNo3,2)),1)])])),_:1})]),(0,t._)("div",null,[(0,t.Wm)(u,{type:"button",size:"large","model-value":a.value,"onUpdate:model-value":l[3]||(l[3]=e=>a.value=e),onChange:al},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{value:"list"},{default:(0,t.w5)((()=>[(0,t.Uk)("列表")])),_:1}),(0,t.Wm)(s,{value:"chart"},{default:(0,t.w5)((()=>[(0,t.Uk)("看图")])),_:1})])),_:1},8,["model-value"])])]),"list"==we.value?((0,t.wg)(),(0,t.iD)("div",A,[(0,t._)("div",L," 集团/客户/项目 : "+(0,o.zw)(xe.value.groupCustomerName+" / "+xe.value.customerName+" / "+xe.value.title)+" ",1),(0,t._)("div",Z,[(0,t._)("div",null,[(0,t.Wm)(u,{type:"button",size:"large",modelValue:je.value,"onUpdate:modelValue":l[4]||(l[4]=e=>je.value=e),disabled:Re.value,onChange:$e},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Ye.level3.tabs,(e=>((0,t.wg)(),(0,t.j4)(s,{value:e.key},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])]),(0,t._)("div",null,[(0,t.Wm)(ve,null,{default:(0,t.w5)((()=>[(0,t.Wm)(ce,{content:"确定导出本页吗?",onOk:gl},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{type:"primary",class:"m-l-14",loading:fl.value},{icon:(0,t.w5)((()=>[(0,t.Wm)(We)])),default:(0,t.w5)((()=>[(0,t.Uk)("导出本页")])),_:1},8,["loading"])])),_:1})])),_:1})])]),(0,t.Wm)(ke,{"row-class":Oe,columns:Ye.level3.columns[je.value]||[],data:Ye.level3.data,bordered:!1,"column-resizable":"","expanded-keys":Ye.level3.defaultExpandedKeys,scroll:{maxHeight:Ye.level3.maxHeight},scrollbar:!1,pagination:!1,loading:Ye.loading,ref_key:"level3tableRef",ref:Ze,onExpandedChange:Qe},{position:(0,t.w5)((({record:e})=>["level3"===He.value?((0,t.wg)(),(0,t.j4)(me,{key:0,"content-style":{background:"rgba(0,0,0,.8)",color:"#fff"},"arrow-style":{background:"rgba(0,0,0,.8)"}},{content:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.position),1)])),default:(0,t.w5)((()=>[(0,t._)("span",F,(0,o.zw)(e.position),1)])),_:2},1032,["content-style","arrow-style"])):(0,t.kq)("",!0)])),empty:(0,t.w5)((()=>[(0,t.Wm)(fe)])),_:1},8,["columns","data","expanded-keys","scroll","loading"])])):(0,t.kq)("",!0),"chart"==we.value?((0,t.wg)(),(0,t.iD)("div",O,[(0,t.Wm)(ve,{class:"chartSelect"},{default:(0,t.w5)((()=>[$,(0,t.Wm)(Ne,{modelValue:be.value,"onUpdate:modelValue":l[5]||(l[5]=e=>be.value=e),placeholder:"请选择",onChange:ll,style:{width:"120px"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(ge.value,(e=>((0,t.wg)(),(0,t.j4)(De,{value:e.label,key:e.label},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.value),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"]),(0,t.Wm)(pe,{style:{width:"max-content"}},{content:(0,t.w5)((()=>[K,M])),default:(0,t.w5)((()=>[(0,t.Wm)(Ke,{size:"20",style:{color:"#a9aeb8"}})])),_:1})])),_:1}),(0,t.Wm)(Me,{loading:Xe.value,tip:"正在加载...",style:{display:"block"}},{default:(0,t.w5)((()=>[(0,t.Wm)(r.Z,{seriesData:ye.value,color:he.value},null,8,["seriesData","color"])])),_:1},8,["loading"])])):(0,t.kq)("",!0)],512),[[i.F8,"level3"===He.value]]),(0,t.Wm)(qe,{visible:il.visible,"onUpdate:visible":l[6]||(l[6]=e=>il.visible=e),width:"680px","title-align":"start"},{title:(0,t.w5)((()=>[V])),footer:(0,t.w5)((()=>[(0,t._)("div",T,[(0,t.Wm)(m,{type:"outline",class:"m-r-24",disabled:il.loading,onClick:nl},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["disabled"]),(0,t.Wm)(m,{type:"primary",disabled:il.loading,loading:il.confirmBtnLoading,onClick:rl},{default:(0,t.w5)((()=>[(0,t.Uk)(" 确定 ")])),_:1},8,["disabled","loading"])])])),default:(0,t.w5)((()=>[(0,t._)("div",q,[(0,t.Wm)(Me,{loading:il.loading,tip:"数据加载中。。。"},{default:(0,t.w5)((()=>[(0,t.Wm)(ve,{direction:"vertical",size:24},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(il.roles,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{key:l},[(0,t._)("span",P,(0,o.zw)(e.label)+"：",1),(0,t.Wm)(Ne,{options:il.selectOptions,style:{width:"378px"},placeholder:"输入并选择项目经理角色","model-value":e.value,"onUpdate:model-value":l=>e.value=l,"allow-search":"","virtual-list-props":{height:200}},{"arrow-icon":(0,t.w5)((()=>[(0,t.Wm)(Ve)])),_:2},1032,["options","model-value","onUpdate:model-value"])])))),128))])),_:1})])),_:1},8,["loading"])])])),_:1},8,["visible"]),(0,t.Wm)(qe,{visible:bl.visible,"onUpdate:visible":l[7]||(l[7]=e=>bl.visible=e),width:"760px","title-align":"start"},{title:(0,t.w5)((()=>[G])),footer:(0,t.w5)((()=>[(0,t._)("div",Q,[(0,t.Wm)(m,{type:"primary",onClick:yl},{default:(0,t.w5)((()=>[(0,t.Uk)("知道了")])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",null,[J,(0,t.Wm)(ke,{columns:bl.tableColumns,data:bl.tableData,bordered:{cell:!0},pagination:!1},null,8,["columns","data"])])])),_:1},8,["visible"]),(0,t.Wm)(qe,{visible:hl.visible,"onUpdate:visible":l[8]||(l[8]=e=>hl.visible=e),width:"784px","title-align":"start"},{title:(0,t.w5)((()=>[X])),footer:(0,t.w5)((()=>[(0,t._)("div",te,[(0,t.Wm)(m,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("知道了")])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",ee,[le,(0,t.Wm)(Pe,{column:hl.basicColumn,data:hl.basicData,"value-style":{color:"#7B7B7B",fonSize:"14px"},bordered:""},null,8,["column","data"])]),(0,t._)("div",null,[ae,(0,t.Wm)(Pe,{column:hl.staffColumn,data:hl.staffData,"value-style":{color:"#7B7B7B",fonSize:"14px"},bordered:""},null,8,["column","data"])])])),_:1},8,["visible"]),(0,t.Wm)(qe,{visible:wl.visible,"onUpdate:visible":l[9]||(l[9]=e=>wl.visible=e),width:"784px","title-align":"start"},{title:(0,t.w5)((()=>[oe])),footer:(0,t.w5)((()=>[(0,t._)("div",ue,[(0,t.Wm)(m,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("知道了")])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",ie,[de,(0,t.Wm)(Pe,{column:wl.basicColumn,data:wl.basicData,"value-style":{color:"#7B7B7B",fonSize:"14px"},bordered:""},null,8,["column","data"])]),(0,t._)("div",ne,[re,(0,t.Wm)(Pe,{column:wl.staffColumn,data:wl.staffData,"value-style":{color:"#7B7B7B",fonSize:"14px"},bordered:""},null,8,["column","data"])]),(0,t._)("div",null,[se,(0,t.Wm)(Pe,{column:wl.manageColumn,data:wl.manageData,"value-style":{color:"#7B7B7B",fonSize:"14px"},bordered:""},null,8,["column","data"])])])),_:1},8,["visible"])],64)}}};const ve=ce;var me=ve}}]);
//# sourceMappingURL=drill.38010447.js.map