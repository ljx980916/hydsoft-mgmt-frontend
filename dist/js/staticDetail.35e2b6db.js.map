{"version":3,"file":"js/staticDetail.35e2b6db.js","mappings":"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","sources":["webpack://oms-frontend/./src/api/staffStatics.js","webpack://oms-frontend/./src/views/staffStatistics/constColumns.js","webpack://oms-frontend/./src/views/staffStatistics/staffStatics/staticDetail.vue","webpack://oms-frontend/./src/views/staffStatistics/staffStatics/staticDetail.vue?1ad0"],"sourcesContent":["import request from '@/utils/request'\n// 环状图 \nexport function getPieChartData (parameter) {\n    return request({\n        url: '/mdm/listPieChartStatistics',\n        method: 'post',\n        data: parameter\n    })\n}\n// 事业部\nexport function getCauseGroup (parameter) {\n  return request({\n      url: '/mdm/listCauseGroupStatistics',\n      method: 'post',\n      data: parameter\n  })\n}\n// 柱状折线图 \nexport function getPostChartData (parameter) {\n  return request({\n      url: '/mdm/listHistogramStatistics',\n      method: 'post',\n      data: parameter\n  })\n}\n// 明细\nexport function getDetailData (parameter) {\n  return request({\n      url: '/mdm/listStatisticsDetail',\n      method: 'post',\n      data: parameter\n  })\n}","export const staffDetailList = [\n  {\n   \n    title: '部门名称',\n    dataIndex: 'deptName',\n    width: 158,\n    slotName:'deptName'\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>部门<br/>负责人</p>\n        </div>\n      )\n    },\n    dataIndex: 'deptLeaderName',\n    align: 'center',\n    width:74\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职人员<br/>总数</p>\n        </div>\n      )\n    },\n    dataIndex: 'total',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:90\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职<br/>C1人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'c1',\n    width: 78,\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职<br/>G人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'g',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width: 72,\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职<br/>C2人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'c2',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width: 78,\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职<br/>S人数</p>\n        </div>\n      )\n    },\n    dataIndex: 's',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:72\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职<br/>R人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'r',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:72\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职人员<br/>正式人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'official',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:90\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职人员<br/>兼职人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'pluralistic',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:90\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>在职人员<br/>实习人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'practice',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:90\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>入职<br/>人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'entry',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:60\n  },\n  {\n    title: () => {\n      return (\n        <div>\n          <p>离职<br/>人数</p>\n        </div>\n      )\n    },\n    dataIndex: 'dimission',\n    headerCellStyle:{'text-align' : 'center'},\n    bodyCellStyle : {'text-align' : 'right'},\n    width:60\n  }\n]","<template>\n  <div class=\"defaultPadding\">\n    <a-row :gutter=\"[14, 20]\" align=\"center\">\n      <a-col flex=\"230px\">\n        <a-space>\n          <span>部门名称：</span>\n          <a-select v-model=\"deptName\" placeholder=\"请选择部门\" style=\"width: 130px\" @change=\"changeDeptName\">\n            <a-option v-for=\"(item, index) of deptList\" :value=\"item\" :key=\"index\">{{ item }}</a-option>\n          </a-select>\n        </a-space>\n      </a-col>\n      <a-col flex=\"200px\">\n        <a-space>\n          <span>日期：</span>\n          <a-date-picker\n            format=\"YYYY-MM-DD\"\n            :allow-clear=\"false\"\n            :disabledDate=\"getDisabledTime\"\n            v-bind:model-value=\"dateVal\"\n            @change=\"handleDatePicker\"\n            style=\"width: 130px\"\n          />\n        </a-space>\n      </a-col>\n      <a-col flex=\"85px\"></a-col>\n      <a-col flex=\"auto\"></a-col>\n    </a-row>\n    <a-row>\n      <a-col :span=\"24\">\n        <a-table\n          ref=\"level1tableRef\"\n          class=\"m-t-20\"\n          column-resizable\n          :columns=\"dataContent.columns\"\n          :data=\"dataContent.dataSource\"\n          :loading=\"dataContent.loading\"\n          :expanded-keys=\"dataContent.defaultExpandedKeys\"\n          :scrollbar=\"false\"\n          :scroll=\"{ maxHeight: maxHeight }\"\n          @expanded-change=\"expandedChange\"\n          :pagination=\"false\"\n        >\n          <template #deptName=\"{ record }\">\n            <a-popover\n              :content-style=\"{ background: 'rgba(0,0,0,.8)', color: '#fff' }\"\n              :arrow-style=\"{ background: 'rgba(0,0,0,.8)' }\"\n            >\n              <span class=\"pointer\">{{ constructDeptName(record.deptName) }}</span>\n              <template #content>\n                {{ record.deptName }}\n              </template>\n            </a-popover>\n          </template>\n        </a-table>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n\n<script setup>\nimport { getDetailData } from \"@/api/staffStatics.js\";\nimport { onBeforeMount, onMounted, reactive, ref, nextTick, watchEffect, onUnmounted } from \"vue\";\nimport { Message } from \"@arco-design/web-vue\";\nimport { useRouter, useRoute } from \"vue-router\";\nimport { staffDetailList } from \"../constColumns\";\nimport { dataAddKey, getSplitNum } from \"@/utils/util.js\";\nimport moment from \"moment\";\nimport { getCurrentInstance } from \"@vue/runtime-core\";\nlet $bus = getCurrentInstance().appContext.config.globalProperties.$bus;\nconst router = useRouter();\nconst route = useRoute();\nconst level1tableRef = ref(null);\nconst maxHeight = ref(\"\");\nconst dateVal = ref(new Date());\nconst deptName = ref(history.state.deptName);\nconst deptList = ref([\"全部\", \"BG1\", \"BG2\", \"BG3\", \"BG4\"]);\nconst dataContent = reactive({\n  loading: false,\n  columns: staffDetailList,\n  defaultExpandedKeys: [],\n  dataSource: [],\n});\nwatchEffect(() => {\n  $bus.emit(\"updateStructure\", [\n    {\n      type: \"text\",\n      color: \"#333\",\n      msg: `人员分析`,\n    },\n    {\n      type: \"button\",\n      color: \"#5370FD\",\n      msg: `人员统计`,\n      params: \"level1\",\n    },\n    {\n      type: \"text\",\n      color: \"#333\",\n      msg: \"人员明细\",\n    },\n  ]);\n});\n$bus.on(\"goBack\", val => {\n  if (val == \"level1\") {\n    let breadList1 = [\n      { type: \"text\", color: \"#333\", msg: `人员分析` },\n      { type: \"text\", color: \"#333\", msg: `人员统计` },\n    ];\n    $bus.emit(\"updateStructure\", breadList1);\n    router.push({\n      path: \"/staticPicture\",\n      state: {\n        deptName: deptName.value,\n      },\n    });\n  }\n});\nonUnmounted(() => {\n  $bus.off(\"goBack\");\n});\nconst expandedChange = rowKeys => {\n  dataContent.defaultExpandedKeys = rowKeys;\n};\n//禁选日期\nconst getDisabledTime = current => {\n  return current.valueOf() < moment(\"2023-01-01 00:00:00\").valueOf() || current.valueOf() > moment().valueOf();\n};\n// 处理部门名称\nconst constructDeptName = deptName => {\n  const lastDashIndex = deptName.lastIndexOf(\"-\");\n  return deptName.substring(lastDashIndex + 1);\n};\n// 更改日期\nconst handleDatePicker = value => {\n  dateVal.value = new Date(value);\n  getData();\n};\n// 更改部门\nconst changeDeptName = val => {\n  deptName.value = val;\n  getData();\n};\nonMounted(() => {\n  if (level1tableRef.value) {\n    let head = level1tableRef.value.$el;\n    nextTick(() => {\n      let innerHeight = window.innerHeight;\n      let elHeight = head.getBoundingClientRect().top;\n      maxHeight.value = innerHeight - elHeight - 30 + \"px\";\n    });\n  }\n});\nonBeforeMount(() => {\n  getData();\n});\nconst getTableNum = arr => {\n  Array.isArray(arr) &&\n    arr.forEach(item => {\n      item.c1 = getSplitNum(item.c1);\n      item.c2 = getSplitNum(item.c2);\n      item.g = getSplitNum(item.g);\n      item.r = getSplitNum(item.r);\n      item.s = getSplitNum(item.s);\n      item.entry = getSplitNum(item.entry);\n      item.official = getSplitNum(item.official);\n      item.practice = getSplitNum(item.practice);\n      item.total = getSplitNum(item.total);\n      item.dimission = getSplitNum(item.dimission);\n      item.pluralistic = getSplitNum(item.pluralistic);\n      if (item.children) {\n        getTableNum(item.children);\n      }\n    });\n  return arr;\n};\nconst getData = () => {\n  var y = dateVal.value.getFullYear();\n  var m = dateVal.value.getMonth() + 1;\n  m = m < 10 ? \"0\" + m : m;\n  var d = dateVal.value.getDate();\n  d = d < 10 ? \"0\" + d : d;\n  const formData = new FormData();\n  if (deptName.value !== \"全部\") {\n    formData.append(\"deptName\", deptName.value);\n  }\n  formData.append(\"time\", `${y}-${m}-${d}`);\n  dataContent.loading = true;\n  getDetailData(formData)\n    .then(res => {\n      if (res.code === \"000000000000\") {\n        if (res.data && res.data.length > 0) {\n          let data = dataAddKey(res.data, \"key\", \"deptName\");\n          dataContent.dataSource = getTableNum(data);\n          let keys = [];\n          res.data.forEach(item => keys.push(item.deptName));\n          dataContent.defaultExpandedKeys = keys;\n        }\n      }\n    })\n    .catch(e => {\n      Message.error(e.message || \"请求失败\");\n    })\n    .finally(() => {\n      dataContent.loading = false;\n    });\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n","import script from \"./staticDetail.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./staticDetail.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["getPieChartData","parameter","request","url","method","data","getCauseGroup","getPostChartData","getDetailData","staffDetailList","title","dataIndex","width","slotName","align","headerCellStyle","bodyCellStyle","$bus","getCurrentInstance","appContext","config","globalProperties","router","useRouter","level1tableRef","useRoute","ref","maxHeight","dateVal","Date","deptName","history","state","deptList","dataContent","reactive","loading","columns","defaultExpandedKeys","dataSource","watchEffect","emit","type","color","msg","params","on","val","breadList1","push","path","value","onUnmounted","off","expandedChange","rowKeys","getDisabledTime","current","valueOf","moment","constructDeptName","lastDashIndex","lastIndexOf","substring","handleDatePicker","getData","changeDeptName","onMounted","head","$el","nextTick","innerHeight","window","elHeight","getBoundingClientRect","top","onBeforeMount","getTableNum","arr","Array","isArray","forEach","item","c1","getSplitNum","c2","g","r","s","entry","official","practice","total","dimission","pluralistic","children","y","getFullYear","m","getMonth","d","getDate","formData","FormData","append","then","res","code","length","dataAddKey","keys","catch","e","Message","error","message","finally","__exports__"],"sourceRoot":""}