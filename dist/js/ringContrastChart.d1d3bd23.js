"use strict";(self["webpackChunkoms_frontend"]=self["webpackChunkoms_frontend"]||[]).push([[687],{2645:function(e,t,a){a.d(t,{$h:function(){return u},FB:function(){return n},Rh:function(){return o},Z2:function(){return c},e5:function(){return p},jG:function(){return s},jy:function(){return d},uh:function(){return r},yJ:function(){return i}});var l=a(4471);function o(e){return(0,l.Z)({url:"/yoyAnalysis/queryYoyAnalysisDept",method:"post",data:e})}function s(e){return(0,l.Z)({url:"/yoyAnalysis/queryYoyAnalysisChart",method:"post",data:e})}function i(e){return(0,l.Z)({url:"/LinkAnalysis/getDeptEcharts",method:"post",data:e})}function r(e){return(0,l.Z)({url:"/LinkAnalysis/getCustomerEcharts",method:"post",data:e})}function n(e){return(0,l.Z)({url:"/LinkAnalysis/getProjectEcharts",method:"post",data:e})}function c(e){return(0,l.Z)({url:"/yoyAnalysis/queryCustomerYoyAnalysisChart",method:"post",data:e})}function u(e){return(0,l.Z)({url:"/yoyAnalysis/getProjectEcharts",method:"post",data:e})}function d(e){return(0,l.Z)({url:"/LinkAnalysis/getCustomer",method:"post",data:e})}function p(e){return(0,l.Z)({url:"/LinkAnalysis/getProject",method:"post",data:e})}},3625:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});a(7658);var l=a(3396),o=a(7139),s=a(4870),i=a(6221),r=a(2645),n=a(4842);const c={class:"flex-center"},u={class:"flex"},d={class:"m-r-40"},p=["src"],m={class:"m-r-40"},h=["src"],g={class:"m-r-170"},y=["src"],f={class:"modal-title"},v={style:{"text-align":"center"}};var k={__name:"ringContrastChart",setup(e){const t=a(4036),k=a(7804),b=a(6080);let{deptName:x,interval:w,deptId:_,title:U,sourceType:A,customerName:I,projectName:S,projectId:C,taxRate:j,customerId:Z}=window.history.state,W=(0,l.FN)().appContext.config.globalProperties.$bus;const F=window.innerHeight,L=(0,s.iH)(null),B=(0,s.iH)(!1);let D,E={dept:"部门",customer:"客户",project:"项目"};const N=(0,s.iH)("营业收入(总) 直接成本(总)"),R=(0,s.XI)(["发薪人数"]),P=(0,s.iH)(w),H=()=>{V()},$=()=>{switch(A){case"dept":J();break;case"customer":X();break;case"project":M();break;default:break}},q=(0,s.qj)({visible:!1,selectItem:"",options:[],loading:!1}),z=()=>{if(q.visible=!0,0===q.options.length)switch(A){case"dept":T();break;case"customer":Y();break;case"project":G();break;default:break}},T=()=>{if(0===q.options.length){q.loading=!0;let e={interval:(0,s.SU)(P)};(0,r.Rh)(e).then((e=>{if("200"===e.code){function t(e){e.forEach((e=>{e.value=e.deptId,e?.children?.length?t(e.children):delete e.children}))}t(e.data),q.options=e.data}else n.Z.error(e.message||"数据请求失败")})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{q.loading=!1}))}},Y=()=>{if(0===q.options.length){q.loading=!0;let e={deptId:_,interval:(0,s.SU)(P)};(0,r.jy)(e).then((e=>{if("200"===e.code){function t(e){e.forEach((e=>{e.value=e.title,e.label=e.title,e?.children?.length?t(e.children):delete e.children}))}t(e.data),q.options=e.data}else n.Z.error(e.message||"数据请求失败")})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{q.loading=!1}))}},G=()=>{if(0===q.options.length){q.loading=!0;let e={deptId:_,interval:(0,s.SU)(P)};(0,r.e5)(e).then((e=>{if("200"===e.code){function t(e){e.forEach((e=>{e.label=e.title,e.value=e.title,e?.children?.length?t(e.children):(e.label=e.projectName,e.value=e.projectName,delete e.children)}))}t(e.data),q.options=e.data}else n.Z.error(e.message||"数据请求失败")})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{q.loading=!1}))}};let K=[],O={"营业收入(总)":"#6BD4B3","人均营业收入":"#6BD4B3","直接成本(总)":"#3491FA","人均直接成本":"#3491FA","发薪人数":"#FB6D6C","项目销售毛利率":"#008026"};const V=()=>{let e=N.value.split(" "),t=R.value,a=P.value,l=[...e,...t,a],o=[],s=[];K.forEach((e=>{if(l.includes(e.name)){let t=0;"bar"===e.type&&(t=0),"line"===e.type&&(t=1),"line"===e.type&&"项目销售毛利率"===e.name&&(t=2),s.push({...e,barWidth:20,yAxisIndex:t,itemStyle:{color:O[e.name]}}),o.push(e.name)}})),te.legend={data:o,bottom:0,itemGap:100},te.series=s,D&&D.setOption(te,!0)},J=e=>{let t={deptId:e||_||"",tagKey:"linkAnalysis",interval:(0,s.SU)(P)};B.value=!0,(0,r.yJ)(t).then((e=>{if("200"===e.code){let{xAxis:t,series:a}=e.data;te.xAxis[0].data=t,K=a,V()}else n.Z.error(e.message||"数据请求失败")})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{B.value=!1}))},X=e=>{let t={tagKey:"linkAnalysis2",interval:(0,s.SU)(P),deptId:_||"",title:e||U,customerId:Z||""};B.value=!0,(0,r.uh)(t).then((e=>{if("200"===e.code){let{xAxis:t,series:a}=e.data;te.xAxis[0].data=t,K=a,V()}else n.Z.error(e.message||"数据请求失败")})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{B.value=!1}))},M=e=>{let t={interval:(0,s.SU)(P),deptId:_||"",tagKey:"linkAnalysis3",projectId:e?.projectId||C,taxRate:e?.taxRate||j};B.value=!0,(0,r.FB)(t).then((e=>{if("200"===e.code){let{xAxis:t,series:a}=e.data;te.xAxis[0].data=t,K=a,V()}else n.Z.error(e.message||"数据请求失败")})).catch((e=>{n.Z.error(e.message||"数据请求失败")})).finally((()=>{B.value=!1}))};function Q(e,t){let a={};function l(e){e.forEach((e=>{Object.keys(t).forEach((l=>{e[l]===t[l]&&(a=e)})),e?.children?.length&&l(e.children)}))}return l(e),a}const ee=()=>{if(q.visible=!1,q.selectItem){let e;switch(A){case"dept":e=Q(q.options,{deptId:q.selectItem}),W.emit("updateStructure",[{type:"text",color:"#333",msg:"环比分析列表"},{type:"button",color:"#5370FD",msg:e.deptName,isBack:!0}]),J(e.deptId);break;case"customer":e=Q(q.options,{title:q.selectItem}),W.emit("updateStructure",[{type:"text",color:"#333",msg:"环比分析列表"},{type:"text",color:"#333",msg:x},{type:"button",color:"#5370FD",msg:e.title,isBack:!0}]),X(e.title);break;case"project":e=Q(q.options,{projectName:q.selectItem}),W.emit("updateStructure",[{type:"text",color:"#333",msg:"环比分析列表"},{type:"text",color:"#333",msg:x},{type:"text",color:"#333",msg:`${e.groupCustomerName}-${I}`},{type:"button",color:"#5370FD",msg:e.projectName,isBack:!0}]);let{finPcode:t,taxRate:a}=e;M({projectId:t,taxRate:a});break;default:break}}},te={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},grid:{left:"10%"},xAxis:[{type:"category",axisTick:{alignWithLabel:!0,inside:!0},axisLabel:{rotate:45},data:[]}],yAxis:[{name:"柱状",type:"value",position:"left",alignTicks:!0,axisLine:{show:!0,lineStyle:{color:"#797979"}},axisLabel:{color:"#666",formatter:"{value}"},splitLine:{show:!1}},{name:"折线",type:"value",position:"right",alignTicks:!0,axisLine:{show:!0,lineStyle:{color:"#797979"}},axisLabel:{color:"#666",formatter:"{value}"},splitLine:{show:!1}},{name:"折线",type:"value",position:"right",offset:60,boundaryGap:[.01,1],axisLine:{show:!0,lineStyle:{color:"#797979"}},axisLabel:{color:"#666",formatter:"{value}%"},splitLine:{show:!1}}],series:[]};return(0,l.bv)((()=>{D=i.S1((0,s.SU)(L)),te&&D.setOption(te)})),(0,l.wF)((()=>{let e;switch(A){case"dept":e=[{type:"button",color:"#5370FD",msg:"环比分析列表",isBack:!0},{type:"text",color:"#333",msg:x}],q.selectItem=_,J();break;case"customer":e=[{type:"text",color:"#333",msg:"环比分析列表"},{type:"button",color:"#5370FD",msg:x,isBack:!0},{type:"text",color:"#333",msg:U}],q.selectItem=Z,X();break;case"project":e=[{type:"text",color:"#333",msg:"环比分析列表"},{type:"text",color:"#333",msg:x},{type:"button",color:"#5370FD",msg:`${U}-${I}`,isBack:!0},{type:"text",color:"#333",msg:S}],q.selectItem=C,M();break;default:break}W.emit("updateStructure",e)})),(e,a)=>{const i=(0,l.up)("a-radio"),r=(0,l.up)("a-radio-group"),n=(0,l.up)("a-tag"),x=(0,l.up)("a-checkbox"),w=(0,l.up)("a-checkbox-group"),_=(0,l.up)("a-button"),U=(0,l.up)("a-spin"),I=(0,l.up)("a-cascader-panel"),S=(0,l.up)("a-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",{class:(0,o.C_)(["defaultPadding",(0,s.SU)(F)>1e3&&"yCenter"]),style:(0,o.j5)({height:(0,s.SU)(F)>1e3?(0,s.SU)(F)+"px":"auto"})},[(0,l._)("header",c,[(0,l._)("div",u,[(0,l._)("div",d,[(0,l._)("span",null,[(0,l._)("img",{src:(0,s.SU)(t),width:"20",class:"img"},null,8,p)]),(0,l.Wm)(r,{type:"button",size:"medium","model-value":N.value,"onUpdate:model-value":a[0]||(a[0]=e=>N.value=e),onChange:H},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{value:"营业收入(总) 直接成本(总)"},{default:(0,l.w5)((()=>[(0,l.Uk)("收入&成本(总)")])),_:1}),(0,l.Wm)(i,{value:"人均营业收入 人均直接成本"},{default:(0,l.w5)((()=>[(0,l.Uk)("收入&成本(人均)")])),_:1})])),_:1},8,["model-value"])]),(0,l._)("div",m,[(0,l._)("img",{src:(0,s.SU)(k),width:"20",class:"img"},null,8,h),(0,l.Wm)(w,{"model-value":(0,s.SU)(R),"onUpdate:model-value":a[1]||(a[1]=e=>(0,s.dq)(R)?R.value=e:null),onChange:H,class:"checkbox-group"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{value:"发薪人数"},{checkbox:(0,l.w5)((({checked:e})=>[(0,l.Wm)(n,{checked:e,class:(0,o.C_)(["checkbox-tag","checkbox-tag1",e&&"checkbox-tag-active"]),checkable:"",style:(0,o.j5)({color:e?"#3A64FF":"#666666"})},{default:(0,l.w5)((()=>[(0,l.Uk)("发薪人数")])),_:2},1032,["checked","class","style"])])),_:1}),(0,l.Wm)(x,{value:"项目销售毛利率"},{checkbox:(0,l.w5)((({checked:e})=>[(0,l.Wm)(n,{checked:e,class:(0,o.C_)(["checkbox-tag","checkbox-tag2",e&&"checkbox-tag-active"]),style:(0,o.j5)({color:e?"#3A64FF":"#666666"})},{default:(0,l.w5)((()=>[(0,l.Uk)("项目销售毛利率")])),_:2},1032,["checked","class","style"])])),_:1})])),_:1},8,["model-value"])]),(0,l._)("div",g,[(0,l._)("img",{src:(0,s.SU)(b),width:"20",class:"img"},null,8,y),(0,l.Wm)(r,{type:"button",size:"medium","model-value":P.value,"onUpdate:model-value":a[2]||(a[2]=e=>P.value=e),onChange:$},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{value:"3"},{default:(0,l.w5)((()=>[(0,l.Uk)("近3个月")])),_:1}),(0,l.Wm)(i,{value:"6"},{default:(0,l.w5)((()=>[(0,l.Uk)("近6个月")])),_:1}),(0,l.Wm)(i,{value:"12"},{default:(0,l.w5)((()=>[(0,l.Uk)("近12个月")])),_:1})])),_:1},8,["model-value"])]),(0,l._)("div",null,[(0,l.Wm)(_,{type:"primary",onClick:z},{default:(0,l.w5)((()=>[(0,l.Uk)("切换"+(0,o.zw)((0,s.SU)(E)[(0,s.SU)(A)]),1)])),_:1})])])]),(0,l._)("main",null,[(0,l.Wm)(U,{loading:B.value,tip:"数据加载中...",style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l._)("div",{ref_key:"chartContainerRef",ref:L,class:"chartContainer"},null,512)])),_:1},8,["loading"])])],6),(0,l.Wm)(S,{visible:q.visible,"onUpdate:visible":a[5]||(a[5]=e=>q.visible=e),width:"800px","body-style":{height:"200px"},"title-align":"start"},{title:(0,l.w5)((()=>[(0,l._)("span",f,"切换"+(0,o.zw)((0,s.SU)(E)[(0,s.SU)(A)]),1)])),footer:(0,l.w5)((()=>[(0,l._)("div",v,[(0,l.Wm)(_,{type:"outline",class:"m-r-10",onClick:a[4]||(a[4]=e=>q.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(_,{type:"primary",onClick:ee},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(U,{loading:q.loading,style:{width:"100%"},tip:"数据加载中..."},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{options:q.options,modelValue:q.selectItem,"onUpdate:modelValue":a[3]||(a[3]=e=>q.selectItem=e),"check-strictly":"","expand-child":""},null,8,["options","modelValue"])])),_:1},8,["loading"])])),_:1},8,["visible"])],64)}}},b=a(89);const x=(0,b.Z)(k,[["__scopeId","data-v-59da4dac"]]);var w=x},4036:function(e,t,a){e.exports=a.p+"img/barChart.602b47b2.svg"},7804:function(e,t,a){e.exports=a.p+"img/lineChart.2802e5b8.svg"},6080:function(e,t,a){e.exports=a.p+"img/timeChart.4dd60ff8.svg"}}]);
//# sourceMappingURL=ringContrastChart.d1d3bd23.js.map