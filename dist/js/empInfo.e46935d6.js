"use strict";(self["webpackChunkoms_frontend"]=self["webpackChunkoms_frontend"]||[]).push([[474],{5343:function(e,t,a){a.d(t,{I6:function(){return l},g1:function(){return n},vl:function(){return i}});const n=[{title:"工号",dataIndex:"workNo"},{title:"姓名",dataIndex:"name",slotName:"name"},{title:"所属部门",dataIndex:"deptName"},{title:"邮箱",dataIndex:"email"},{title:"账户状态",dataIndex:"flag",slotName:"flag_view"},{title:"操作",dataIndex:"action",slotName:"action"}],l=[{title:"菜单名称",dataIndex:"name",key:"name",width:"20%"},{title:"图标",dataIndex:"icon",key:"icon"},{title:"类型",dataIndex:"type",key:"type",slotName:"type_view"},{title:"排序号",dataIndex:"sort",key:"sort"},{title:"URL",dataIndex:"url",key:"url"},{title:"授权标识",dataIndex:"perms",key:"perms"},{title:"操作",dataIndex:"action",key:"action",slotName:"action"}],i=[{title:"角色名称",dataIndex:"name"},{title:"备注",dataIndex:"remarks"},{title:"角色编码",dataIndex:"code"},{title:"创建时间",dataIndex:"createTime",width:200},{title:"操作",dataIndex:"action",slotName:"action"}]},729:function(e,t,a){a.d(t,{Z:function(){return x}});a(7658);var n=a(3396),l=a(7139),i=a(4870),o=a(5343),d=a(4842),u=a(4239);const r=e=>((0,n.dD)("data-v-53477c82"),e=e(),(0,n.Cn)(),e),m={class:"m-b-20"},c={class:"flex-between",style:{height:"40px"}},p={class:"tool-grid"},s={key:0},g=r((()=>(0,n._)("span",null,"只看我的",-1))),w={key:0,class:"red"},y={key:1,class:"green"};var k={__name:"tableContainer",props:{tabs:{type:Array,default:()=>[]},chekedValue:{type:String,default:""},tableColumns:{type:Array,default:()=>[]},tableData:{type:Array,default:()=>[]},menuName:{type:String,default:""},loading:{type:Boolean,default:!1},scrollY:{type:String,default:"600px"},setColumns:{type:Array,default:()=>[]},switchStatus:{type:Boolean,default:!1},exportExcel:{type:String,default:""},paginationTotal:{type:Number,default:10},paginationCurrent:{type:Number,default:1},paginationPageSize:{type:Number,default:10}},emits:["switchClick","paginationCurrentChange","paginationPageSizeChange","handleEdit","handleDeleteMenu","handleUpdateFlag","columnOK","radioChange"],setup(e,{emit:t}){const a=e,r=(0,u.Ls)().getPermission,k=(0,i.qj)({tableColumns:[{title:"自定义列1",dataIndex:"customColumn1",width:200},{title:"自定义列2",dataIndex:"customColumn2",width:200},{title:"自定义列3",dataIndex:"customColumn3",width:200},{title:"自定义列4",dataIndex:"customColumn4",width:200},{title:"自定义列5",dataIndex:"customColumn5",width:200},{title:"自定义列6",dataIndex:"customColumn6",width:200}],tableData:[]}),f=(0,i.iH)(!1),h=(0,i.iH)([]),x=(0,i.iH)([]),v=(0,i.iH)(o.g1);let C=o.g1.filter((e=>"action"!==e.dataIndex))||[];const I=()=>{f.value=!0},N=e=>{x.value=e},_=()=>{let e=JSON.parse(localStorage.getItem("userListColumns"));if(e)v.value=e,h.value=e.map((e=>e.dataIndex));else{var t=[];C.forEach((e=>{t.push(e.dataIndex),h.value=t}))}};_();const b=()=>{if(1===h.value.length&&"action"===h.value[0])return d.Z.error("至少选择一项");t("columnOK",h.value),f.value=!1},S=e=>{t("switchClick",!e)},U=e=>{t("paginationCurrentChange",e)},W=e=>{t("paginationPageSizeChange",e)},D=(e,a)=>{t("handleEdit",e,a)},z=e=>{t("handleDeleteMenu",e)},j=e=>{t("handleDetail",e)},q=e=>{t("handleUpdateFlag",e)},P=e=>{t("radioChange",e)};return(t,o)=>{const d=(0,n.up)("a-radio"),u=(0,n.up)("a-radio-group"),x=(0,n.up)("a-switch"),v=(0,n.up)("icon-download"),C=(0,n.up)("a-button"),_=(0,n.up)("icon-home"),O=(0,n.up)("a-popconfirm"),E=(0,n.up)("a-divider"),M=(0,n.up)("a-table"),H=(0,n.up)("a-checkbox"),R=(0,n.up)("a-checkbox-group"),A=(0,n.up)("a-modal");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",null,[(0,n._)("div",m,[(0,n._)("div",c,[(0,n.Wm)(u,{type:"button",size:"large","model-value":a.chekedValue,onChange:P},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.tabs,(e=>((0,n.wg)(),(0,n.j4)(d,{value:e.key},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["model-value"]),(0,n.WI)(t.$slots,"default")]),(0,n._)("div",null,[(0,n._)("div",p,["USER"===a.menuName?((0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(x,{value:e.switchStatus,onChange:S},{checked:(0,n.w5)((()=>[(0,n.Uk)("ON")])),unchecked:(0,n.w5)((()=>[(0,n.Uk)("OFF")])),_:1},8,["value"]),g])):(0,n.kq)("",!0),"USER"===a.menuName?((0,n.wg)(),(0,n.j4)(C,{key:1,type:"primary"},{icon:(0,n.w5)((()=>[(0,n.Wm)(v)])),default:(0,n.w5)((()=>[(0,n.Uk)("导出excel")])),_:1})):(0,n.kq)("",!0),"USER"===a.menuName?((0,n.wg)(),(0,n.j4)(C,{key:2,class:"config",type:"primary",onClick:I},{icon:(0,n.w5)((()=>[(0,n.Wm)(_)])),default:(0,n.w5)((()=>[(0,n.Uk)("配置列")])),_:1})):(0,n.kq)("",!0)])])])]),(0,n._)("div",null,[(0,n.Wm)(M,{columns:a.tableColumns.length&&a.tableColumns||k.tableColumns,data:a.tableData.length&&a.tableData||k.tableData,"column-resizable":"",bordered:!1,scroll:{x:"100%",y:a.scrollY},scrollbar:!1,loading:a.loading,pagination:{total:e.paginationTotal,current:e.paginationCurrent,pageSize:e.paginationPageSize,showTotal:!0,showPageSize:!0,showJumper:!0,onChange:U,onPageSizeChange:W}},{type_view:(0,n.w5)((({record:e})=>[(0,n._)("div",null,(0,l.zw)(0===e.type?"目录":1===e.type?"菜单":"按钮"),1)])),role_view:(0,n.w5)((({record:e})=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.roles,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t},(0,l.zw)(e.name),1)))),128))])),flag_view:(0,n.w5)((({record:e})=>[0===e.flag?((0,n.wg)(),(0,n.iD)("span",w,"禁用")):(0,n.kq)("",!0),1===e.flag?((0,n.wg)(),(0,n.iD)("span",y,"启用")):(0,n.kq)("",!0)])),action:(0,n.w5)((({record:e})=>[(0,n.Wm)(O,{content:"你确定要启用这个用户吗?",type:"error",onOk:t=>q(e)},{default:(0,n.w5)((()=>["user"==a.menuName&&0===e.flag?((0,n.wg)(),(0,n.j4)(C,{key:0,type:"text"},{default:(0,n.w5)((()=>[(0,n.Uk)("启用")])),_:1})):(0,n.kq)("",!0)])),_:2},1032,["onOk"]),"user"==a.menuName&&0===e.flag?((0,n.wg)(),(0,n.j4)(E,{key:0,direction:"vertical"})):(0,n.kq)("",!0),"user"==a.menuName&&0===e.flag?((0,n.wg)(),(0,n.j4)(C,{key:1,type:"text",style:{color:"#999999"}},{default:(0,n.w5)((()=>[(0,n.Uk)("禁用")])),_:1})):(0,n.kq)("",!0),"user"==a.menuName&&1===e.flag?((0,n.wg)(),(0,n.j4)(C,{key:2,type:"text",style:{color:"#999999"}},{default:(0,n.w5)((()=>[(0,n.Uk)("启用")])),_:1})):(0,n.kq)("",!0),"user"==a.menuName&&1===e.flag?((0,n.wg)(),(0,n.j4)(E,{key:3,direction:"vertical"})):(0,n.kq)("",!0),(0,n.Wm)(O,{content:"你确定要禁用这个用户吗?",type:"error",onOk:t=>q(e)},{default:(0,n.w5)((()=>["user"==a.menuName&&1===e.flag?((0,n.wg)(),(0,n.j4)(C,{key:0,type:"text"},{default:(0,n.w5)((()=>[(0,n.Uk)("禁用")])),_:1})):(0,n.kq)("",!0)])),_:2},1032,["onOk"]),"USER"==a.menuName?((0,n.wg)(),(0,n.j4)(C,{key:4,type:"text",onClick:t=>j(e,"view")},{default:(0,n.w5)((()=>[(0,n.Uk)("查看")])),_:2},1032,["onClick"])):(0,n.kq)("",!0),"user"==a.menuName?((0,n.wg)(),(0,n.j4)(E,{key:5,direction:"vertical"})):(0,n.kq)("",!0),(0,i.SU)(r).includes("menu:edit")&&"admin"!==e.code?((0,n.wg)(),(0,n.j4)(C,{key:6,type:"text",onClick:t=>D(e,"edit")},{default:(0,n.w5)((()=>[(0,n.Uk)(" 编辑 ")])),_:2},1032,["onClick"])):(0,n.kq)("",!0),"menu"==a.menuName||"role"==a.menuName&&"admin"!==e.code?((0,n.wg)(),(0,n.j4)(E,{key:7,direction:"vertical"})):(0,n.kq)("",!0),(0,n.Wm)(O,{content:"确定要删除吗?",type:"error",onOk:t=>z(e)},{default:(0,n.w5)((()=>[(0,i.SU)(r).includes("menu:delete")&&("menu"==a.menuName||"role"==a.menuName&&"admin"!==e.code)?((0,n.wg)(),(0,n.j4)(C,{key:0,type:"text"},{default:(0,n.w5)((()=>[(0,n.Uk)(" 删除 ")])),_:1})):(0,n.kq)("",!0)])),_:2},1032,["onOk"])])),_:1},8,["columns","data","scroll","loading","pagination"])]),(0,n.Wm)(A,{visible:f.value,"onUpdate:visible":o[1]||(o[1]=e=>f.value=e),title:"选择表格项"},{footer:(0,n.w5)((()=>[(0,n.Wm)(C,{type:"primary",onClick:b},{default:(0,n.w5)((()=>[(0,n.Uk)("确定")])),_:1})])),default:(0,n.w5)((()=>[(0,n.Wm)(R,{onChange:N,modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=e=>h.value=e)},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.setColumns,(e=>((0,n.wg)(),(0,n.j4)(H,{key:e.dataIndex,value:e.dataIndex},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.title),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["visible"])])}}},f=a(89);const h=(0,f.Z)(k,[["__scopeId","data-v-53477c82"]]);var x=h},8891:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var n=a(3396),l=a(729),i=a(4471);function o(e){return(0,i.Z)({url:"/empInfo",method:"get",params:e})}function d(e){return(0,i.Z)({url:"/empInfo/exportExcel",method:"get",params:e,responseType:"blob"})}var u=a(4870),r=a(4842),m=a(6797),c=a.n(m);const p={class:"defaultPadding"};var s={__name:"empInfo",setup(e){const t=(0,u.iH)(new Date),a=(e,a)=>{t.value=a,g()},i=(0,u.qj)({loading:!1,columns:[{title:"员工编号",dataIndex:"empCode",key:"empCode",width:110},{title:"员工姓名",dataIndex:"empName",key:"empName",width:110},{title:"成本中心",dataIndex:"costCenterName",key:"costCenterName",width:110},{title:"所属实体",dataIndex:"entityName",key:"entityName",width:250},{title:"在职状态",dataIndex:"status",key:"status",width:110},{title:"所属部门",dataIndex:"deptName",key:"deptName",width:200},{title:"部门经理",dataIndex:"deptManager",key:"deptManager",width:110},{title:"客户名称",dataIndex:"customerName",key:"customerName",width:250},{title:"项目名称",dataIndex:"projectName",key:"projectName",width:220},{title:"入职时间",dataIndex:"hireDate",key:"hireDate",width:110},{title:"离职时间",dataIndex:"dismissDate",key:"dismissDate",width:150},{title:"职位",dataIndex:"position",key:"position",width:150},{title:"工作地",dataIndex:"workPlace",key:"workPlace",width:110},{title:"员工属性",dataIndex:"empAttr",key:"empAttr",width:110}],dataSource:[],pagination:{pageSize:20,pageNum:1,total:10}}),m=(0,u.iH)(!1),s=()=>{m.value=!0;let e={month:c()(t.value).format("yyyy-MM")};d(e).then((e=>{const a=new Blob([e]),n=`C1人员信息_${c()(t.value).format("yyyyMM")}.xlsx`,l=document.createElement("a");l.download=n,l.style.display="none",l.href=URL.createObjectURL(a),document.body.appendChild(l),l.click(),URL.revokeObjectURL(l.href),document.body.removeChild(l)})).catch((()=>{r.Z.error("导出失败")})).finally((()=>{m.value=!1}))};(0,n.wF)((()=>{g()}));const g=()=>{let e={month:c()(t.value).format("yyyy-MM"),pageNum:i.pagination.pageNum,pageSize:i.pagination.pageSize};i.loading=!0,o(e).then((e=>{if("000000000000"===e.code){let{list:t,total:a}=e.data;i.pagination.total=!isNaN(+a)&&+a,Array.isArray(t)&&t.forEach(((e,t)=>{e.key=e.empCode})),i.dataSource=t}})).catch((e=>{r.Z.error(e.message||"请求失败")})).finally((()=>{i.loading=!1}))},w=e=>{i.pagination.pageNum=e,g()},y=e=>{i.pagination.pageSize=e,g()};return(e,o)=>{const d=(0,n.up)("a-month-picker"),u=(0,n.up)("a-col"),r=(0,n.up)("icon-export"),c=(0,n.up)("a-button"),g=(0,n.up)("a-row");return(0,n.wg)(),(0,n.iD)("div",p,[(0,n.Wm)(g,{gutter:[14,20],align:"center"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{flex:"120px"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{"model-value":t.value,onChange:a},null,8,["model-value"])])),_:1}),(0,n.Wm)(u,{flex:"85px"}),(0,n.Wm)(u,{flex:"85px"}),(0,n.Wm)(u,{flex:"auto"}),(0,n.Wm)(u,{flex:"100px"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{type:"primary",loading:m.value,onClick:s},{icon:(0,n.w5)((()=>[(0,n.Wm)(r)])),default:(0,n.w5)((()=>[(0,n.Uk)("导出本页")])),_:1},8,["loading"])])),_:1})])),_:1}),(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,{span:24},{default:(0,n.w5)((()=>[(0,n.Wm)(l.Z,{"column-resizable":"",scrollY:"600px",scrollbar:!1,loading:i.loading,paginationTotal:i.pagination.total,paginationPageSize:i.pagination.pageSize,paginationCurrent:i.pagination.pageNum,tableColumns:i.columns,"table-data":i.dataSource,onPaginationCurrentChange:w,onPaginationPageSizeChange:y},null,8,["loading","paginationTotal","paginationPageSize","paginationCurrent","tableColumns","table-data"])])),_:1})])),_:1})])}}};const g=s;var w=g}}]);
//# sourceMappingURL=empInfo.e46935d6.js.map